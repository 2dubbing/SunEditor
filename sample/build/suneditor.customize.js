/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./sample/customize_ex.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./sample/customize_ex.js":
/*!********************************!*\
  !*** ./sample/customize_ex.js ***!
  \********************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _src_suneditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../src/suneditor */ \"./src/suneditor.js\");\n/* harmony import */ var _test_dev_custom_plugin_submenu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../test/dev/custom_plugin_submenu */ \"./test/dev/custom_plugin_submenu.js\");\n// import '../src/assets/css/suneditor.css'\n// import '../src/assets/css/suneditor-contents.css'\n\n\n\n\n_src_suneditor__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(document.getElementById('ex_submenu'), {\n  plugins: [_test_dev_custom_plugin_submenu__WEBPACK_IMPORTED_MODULE_1__[\"default\"]],\n  buttonList: [['undo', 'redo'], [{\n    // plugin's name attribute\n    name: 'custom_plugin_submenu',\n    // name of the plugin to be recognized by the toolbar.\n    // It must be the same as the name attribute of the plugin \n    dataCommand: 'custom_plugin_submenu',\n    // button's class (\"btn_editor\" class is registered, basic button click css is applied.)\n    buttonClass: 'btn_editor',\n    // HTML title attribute\n    title: 'Custom plugin of the submenu',\n    // 'submenu' or 'dialog' or '' (command button)\n    dataDisplay: 'submenu',\n    // 'full' or '' (Only applies to dialog plugin.)\n    displayOption: '',\n    // HTML to be append to button\n    innerHTML: '<div class=\"icon-map-pin\"></div>'\n  }]]\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zYW1wbGUvY3VzdG9taXplX2V4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc2FtcGxlL2N1c3RvbWl6ZV9leC5qcz9jZTNkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCAnLi4vc3JjL2Fzc2V0cy9jc3Mvc3VuZWRpdG9yLmNzcydcclxuLy8gaW1wb3J0ICcuLi9zcmMvYXNzZXRzL2Nzcy9zdW5lZGl0b3ItY29udGVudHMuY3NzJ1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5pbXBvcnQgc3VuZWRpdG9yIGZyb20gJy4uL3NyYy9zdW5lZGl0b3InO1xyXG5pbXBvcnQgY3VzdG9tX3BsdWdpbl9zdWJtZW51IGZyb20gJy4uL3Rlc3QvZGV2L2N1c3RvbV9wbHVnaW5fc3VibWVudSc7XHJcblxyXG5zdW5lZGl0b3IuY3JlYXRlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleF9zdWJtZW51JyksIHtcclxuICAgIHBsdWdpbnM6IFtcclxuICAgICAgICBjdXN0b21fcGx1Z2luX3N1Ym1lbnVcclxuICAgIF0sXHJcbiAgICBidXR0b25MaXN0OiBbXHJcbiAgICAgICAgWyd1bmRvJywgJ3JlZG8nXSxcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIC8vIHBsdWdpbidzIG5hbWUgYXR0cmlidXRlXHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnY3VzdG9tX3BsdWdpbl9zdWJtZW51JywgXHJcbiAgICAgICAgICAgICAgICAvLyBuYW1lIG9mIHRoZSBwbHVnaW4gdG8gYmUgcmVjb2duaXplZCBieSB0aGUgdG9vbGJhci5cclxuICAgICAgICAgICAgICAgIC8vIEl0IG11c3QgYmUgdGhlIHNhbWUgYXMgdGhlIG5hbWUgYXR0cmlidXRlIG9mIHRoZSBwbHVnaW4gXHJcbiAgICAgICAgICAgICAgICBkYXRhQ29tbWFuZDogJ2N1c3RvbV9wbHVnaW5fc3VibWVudScsXHJcbiAgICAgICAgICAgICAgICAvLyBidXR0b24ncyBjbGFzcyAoXCJidG5fZWRpdG9yXCIgY2xhc3MgaXMgcmVnaXN0ZXJlZCwgYmFzaWMgYnV0dG9uIGNsaWNrIGNzcyBpcyBhcHBsaWVkLilcclxuICAgICAgICAgICAgICAgIGJ1dHRvbkNsYXNzOididG5fZWRpdG9yJywgXHJcbiAgICAgICAgICAgICAgICAvLyBIVE1MIHRpdGxlIGF0dHJpYnV0ZVxyXG4gICAgICAgICAgICAgICAgdGl0bGU6J0N1c3RvbSBwbHVnaW4gb2YgdGhlIHN1Ym1lbnUnLCBcclxuICAgICAgICAgICAgICAgIC8vICdzdWJtZW51JyBvciAnZGlhbG9nJyBvciAnJyAoY29tbWFuZCBidXR0b24pXHJcbiAgICAgICAgICAgICAgICBkYXRhRGlzcGxheTonc3VibWVudScsXHJcbiAgICAgICAgICAgICAgICAvLyAnZnVsbCcgb3IgJycgKE9ubHkgYXBwbGllcyB0byBkaWFsb2cgcGx1Z2luLilcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlPcHRpb246JycsXHJcbiAgICAgICAgICAgICAgICAvLyBIVE1MIHRvIGJlIGFwcGVuZCB0byBidXR0b25cclxuICAgICAgICAgICAgICAgIGlubmVySFRNTDonPGRpdiBjbGFzcz1cImljb24tbWFwLXBpblwiPjwvZGl2PidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF1cclxuICAgIF1cclxufSk7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQVBBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./sample/customize_ex.js\n");

/***/ }),

/***/ "./src/lang/en.js":
/*!************************!*\
  !*** ./src/lang/en.js ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/*\r\n * wysiwyg web editor\r\n *\r\n * suneditor.js\r\n * Copyright 2017 JiHong Lee.\r\n * MIT license.\r\n */\n\n\n(function (global, factory) {\n  if ( true && typeof module.exports === 'object') {\n    module.exports = global.document ? factory(global, true) : function (w) {\n      if (!w.document) {\n        throw new Error('SUNEDITOR_LANG a window with a document');\n      }\n\n      return factory(w);\n    };\n  } else {\n    factory(global);\n  }\n})(typeof window !== 'undefined' ? window : this, function (window, noGlobal) {\n  const lang = {\n    toolbar: {\n      save: 'Save',\n      font: 'Font',\n      formats: 'Formats',\n      fontSize: 'Size',\n      bold: 'Bold',\n      underline: 'Underline',\n      italic: 'Italic',\n      strike: 'Strike',\n      subscript: 'Subscript',\n      superscript: 'Superscript',\n      removeFormat: 'Remove Format',\n      fontColor: 'Font Color',\n      hiliteColor: 'Hilite Color',\n      indent: 'Indent',\n      outdent: 'Outdent',\n      align: 'Align',\n      alignLeft: 'Align left',\n      alignRight: 'Align right',\n      alignCenter: 'Align center',\n      justifyFull: 'Justify full',\n      list: 'list',\n      orderList: 'Ordered list',\n      unorderList: 'Unordered list',\n      horizontalRule: 'horizontal line',\n      hr_solid: 'solid',\n      hr_dotted: 'dotted',\n      hr_dashed: 'dashed',\n      table: 'Table',\n      link: 'Link',\n      image: 'Image',\n      video: 'Video',\n      fullScreen: 'Full screen',\n      showBlocks: 'Show blocks',\n      codeView: 'Code view',\n      undo: 'Undo',\n      redo: 'Redo',\n      preview: 'Preview',\n      print: 'print',\n      tag_p: 'Paragraph',\n      tag_div: 'Normal (DIV)',\n      tag_h: 'Header',\n      tag_quote: 'Quote',\n      pre: 'Code'\n    },\n    dialogBox: {\n      linkBox: {\n        title: 'Insert Link',\n        url: 'URL to link',\n        text: 'Text to display',\n        newWindowCheck: 'Open in new window'\n      },\n      imageBox: {\n        title: 'Insert image',\n        file: 'Select from files',\n        url: 'Image URL',\n        altText: 'Alternative text'\n      },\n      videoBox: {\n        title: 'Insert Video',\n        url: 'Media embed URL, YouTube'\n      },\n      caption: 'Insert description',\n      close: 'Close',\n      submitButton: 'Submit',\n      revertButton: 'Revert',\n      proportion: 'constrain proportions',\n      width: 'Width',\n      height: 'Height',\n      basic: 'Basic',\n      left: 'Left',\n      right: 'Right',\n      center: 'Center'\n    },\n    controller: {\n      edit: 'Edit',\n      remove: 'Remove',\n      insertRowAbove: 'Insert row above',\n      insertRowBelow: 'Insert row below',\n      deleteRow: 'Delete row',\n      insertColumnBefore: 'Insert column before',\n      insertColumnAfter: 'Insert column after',\n      deleteColumn: 'Delete column',\n      resize100: 'Resize 100%',\n      resize75: 'Resize 75%',\n      resize50: 'Resize 50%',\n      resize25: 'Resize 25%',\n      mirrorHorizontal: 'Mirror, Horizontal',\n      mirrorVertical: 'Mirror, Vertical',\n      rotateLeft: 'Rotate left',\n      rotateRight: 'Rotate right'\n    }\n  };\n\n  if (typeof noGlobal === typeof undefined) {\n    if (!window.SUNEDITOR_LANG) {\n      window.SUNEDITOR_LANG = {};\n    }\n\n    window.SUNEDITOR_LANG.en = lang;\n  }\n\n  return lang;\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbGFuZy9lbi5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9sYW5nL2VuLmpzPzNmYWIiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogd3lzaXd5ZyB3ZWIgZWRpdG9yXHJcbiAqXHJcbiAqIHN1bmVkaXRvci5qc1xyXG4gKiBDb3B5cmlnaHQgMjAxNyBKaUhvbmcgTGVlLlxyXG4gKiBNSVQgbGljZW5zZS5cclxuICovXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XHJcbiAgICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsLmRvY3VtZW50ID9cclxuICAgICAgICAgICAgZmFjdG9yeShnbG9iYWwsIHRydWUpIDpcclxuICAgICAgICAgICAgZnVuY3Rpb24odykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF3LmRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTVU5FRElUT1JfTEFORyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5KHcpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmYWN0b3J5KGdsb2JhbCk7XHJcbiAgICB9XHJcbn0odHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbiAod2luZG93LCBub0dsb2JhbCkge1xyXG4gICAgY29uc3QgbGFuZyA9IHtcclxuICAgICAgICB0b29sYmFyOiB7XHJcbiAgICAgICAgICAgIHNhdmU6ICdTYXZlJyxcclxuICAgICAgICAgICAgZm9udDogJ0ZvbnQnLFxyXG4gICAgICAgICAgICBmb3JtYXRzOiAnRm9ybWF0cycsXHJcbiAgICAgICAgICAgIGZvbnRTaXplOiAnU2l6ZScsXHJcbiAgICAgICAgICAgIGJvbGQ6ICdCb2xkJyxcclxuICAgICAgICAgICAgdW5kZXJsaW5lOiAnVW5kZXJsaW5lJyxcclxuICAgICAgICAgICAgaXRhbGljOiAnSXRhbGljJyxcclxuICAgICAgICAgICAgc3RyaWtlOiAnU3RyaWtlJyxcclxuICAgICAgICAgICAgc3Vic2NyaXB0OiAnU3Vic2NyaXB0JyxcclxuICAgICAgICAgICAgc3VwZXJzY3JpcHQ6ICdTdXBlcnNjcmlwdCcsXHJcbiAgICAgICAgICAgIHJlbW92ZUZvcm1hdDogJ1JlbW92ZSBGb3JtYXQnLFxyXG4gICAgICAgICAgICBmb250Q29sb3I6ICdGb250IENvbG9yJyxcclxuICAgICAgICAgICAgaGlsaXRlQ29sb3I6ICdIaWxpdGUgQ29sb3InLFxyXG4gICAgICAgICAgICBpbmRlbnQ6ICdJbmRlbnQnLFxyXG4gICAgICAgICAgICBvdXRkZW50OiAnT3V0ZGVudCcsXHJcbiAgICAgICAgICAgIGFsaWduOiAnQWxpZ24nLFxyXG4gICAgICAgICAgICBhbGlnbkxlZnQ6ICdBbGlnbiBsZWZ0JyxcclxuICAgICAgICAgICAgYWxpZ25SaWdodDogJ0FsaWduIHJpZ2h0JyxcclxuICAgICAgICAgICAgYWxpZ25DZW50ZXI6ICdBbGlnbiBjZW50ZXInLFxyXG4gICAgICAgICAgICBqdXN0aWZ5RnVsbDogJ0p1c3RpZnkgZnVsbCcsXHJcbiAgICAgICAgICAgIGxpc3Q6ICdsaXN0JyxcclxuICAgICAgICAgICAgb3JkZXJMaXN0OiAnT3JkZXJlZCBsaXN0JyxcclxuICAgICAgICAgICAgdW5vcmRlckxpc3Q6ICdVbm9yZGVyZWQgbGlzdCcsXHJcbiAgICAgICAgICAgIGhvcml6b250YWxSdWxlOiAnaG9yaXpvbnRhbCBsaW5lJyxcclxuICAgICAgICAgICAgaHJfc29saWQ6ICdzb2xpZCcsXHJcbiAgICAgICAgICAgIGhyX2RvdHRlZDogJ2RvdHRlZCcsXHJcbiAgICAgICAgICAgIGhyX2Rhc2hlZDogJ2Rhc2hlZCcsXHJcbiAgICAgICAgICAgIHRhYmxlOiAnVGFibGUnLFxyXG4gICAgICAgICAgICBsaW5rOiAnTGluaycsXHJcbiAgICAgICAgICAgIGltYWdlOiAnSW1hZ2UnLFxyXG4gICAgICAgICAgICB2aWRlbzogJ1ZpZGVvJyxcclxuICAgICAgICAgICAgZnVsbFNjcmVlbjogJ0Z1bGwgc2NyZWVuJyxcclxuICAgICAgICAgICAgc2hvd0Jsb2NrczogJ1Nob3cgYmxvY2tzJyxcclxuICAgICAgICAgICAgY29kZVZpZXc6ICdDb2RlIHZpZXcnLFxyXG4gICAgICAgICAgICB1bmRvOiAnVW5kbycsXHJcbiAgICAgICAgICAgIHJlZG86ICdSZWRvJyxcclxuICAgICAgICAgICAgcHJldmlldzogJ1ByZXZpZXcnLFxyXG4gICAgICAgICAgICBwcmludDogJ3ByaW50JyxcclxuICAgICAgICAgICAgdGFnX3A6ICdQYXJhZ3JhcGgnLFxyXG4gICAgICAgICAgICB0YWdfZGl2OiAnTm9ybWFsIChESVYpJyxcclxuICAgICAgICAgICAgdGFnX2g6ICdIZWFkZXInLFxyXG4gICAgICAgICAgICB0YWdfcXVvdGU6ICdRdW90ZScsXHJcbiAgICAgICAgICAgIHByZTogJ0NvZGUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkaWFsb2dCb3g6IHtcclxuICAgICAgICAgICAgbGlua0JveDoge1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdJbnNlcnQgTGluaycsXHJcbiAgICAgICAgICAgICAgICB1cmw6ICdVUkwgdG8gbGluaycsXHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnVGV4dCB0byBkaXNwbGF5JyxcclxuICAgICAgICAgICAgICAgIG5ld1dpbmRvd0NoZWNrOiAnT3BlbiBpbiBuZXcgd2luZG93J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBpbWFnZUJveDoge1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdJbnNlcnQgaW1hZ2UnLFxyXG4gICAgICAgICAgICAgICAgZmlsZTogJ1NlbGVjdCBmcm9tIGZpbGVzJyxcclxuICAgICAgICAgICAgICAgIHVybDogJ0ltYWdlIFVSTCcsXHJcbiAgICAgICAgICAgICAgICBhbHRUZXh0OiAnQWx0ZXJuYXRpdmUgdGV4dCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdmlkZW9Cb3g6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnSW5zZXJ0IFZpZGVvJyxcclxuICAgICAgICAgICAgICAgIHVybDogJ01lZGlhIGVtYmVkIFVSTCwgWW91VHViZSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2FwdGlvbjogJ0luc2VydCBkZXNjcmlwdGlvbicsXHJcbiAgICAgICAgICAgIGNsb3NlOiAnQ2xvc2UnLFxyXG4gICAgICAgICAgICBzdWJtaXRCdXR0b246ICdTdWJtaXQnLFxyXG4gICAgICAgICAgICByZXZlcnRCdXR0b246ICdSZXZlcnQnLFxyXG4gICAgICAgICAgICBwcm9wb3J0aW9uOiAnY29uc3RyYWluIHByb3BvcnRpb25zJyxcclxuICAgICAgICAgICAgd2lkdGg6ICdXaWR0aCcsXHJcbiAgICAgICAgICAgIGhlaWdodDogJ0hlaWdodCcsXHJcbiAgICAgICAgICAgIGJhc2ljOiAnQmFzaWMnLFxyXG4gICAgICAgICAgICBsZWZ0OiAnTGVmdCcsXHJcbiAgICAgICAgICAgIHJpZ2h0OiAnUmlnaHQnLFxyXG4gICAgICAgICAgICBjZW50ZXI6ICdDZW50ZXInXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb250cm9sbGVyOiB7XHJcbiAgICAgICAgICAgIGVkaXQ6ICdFZGl0JyxcclxuICAgICAgICAgICAgcmVtb3ZlOiAnUmVtb3ZlJyxcclxuICAgICAgICAgICAgaW5zZXJ0Um93QWJvdmU6ICdJbnNlcnQgcm93IGFib3ZlJyxcclxuICAgICAgICAgICAgaW5zZXJ0Um93QmVsb3c6ICdJbnNlcnQgcm93IGJlbG93JyxcclxuICAgICAgICAgICAgZGVsZXRlUm93OiAnRGVsZXRlIHJvdycsXHJcbiAgICAgICAgICAgIGluc2VydENvbHVtbkJlZm9yZTogJ0luc2VydCBjb2x1bW4gYmVmb3JlJyxcclxuICAgICAgICAgICAgaW5zZXJ0Q29sdW1uQWZ0ZXI6ICdJbnNlcnQgY29sdW1uIGFmdGVyJyxcclxuICAgICAgICAgICAgZGVsZXRlQ29sdW1uOiAnRGVsZXRlIGNvbHVtbicsXHJcbiAgICAgICAgICAgIHJlc2l6ZTEwMDogJ1Jlc2l6ZSAxMDAlJyxcclxuICAgICAgICAgICAgcmVzaXplNzU6ICdSZXNpemUgNzUlJyxcclxuICAgICAgICAgICAgcmVzaXplNTA6ICdSZXNpemUgNTAlJyxcclxuICAgICAgICAgICAgcmVzaXplMjU6ICdSZXNpemUgMjUlJyxcclxuICAgICAgICAgICAgbWlycm9ySG9yaXpvbnRhbDogJ01pcnJvciwgSG9yaXpvbnRhbCcsXHJcbiAgICAgICAgICAgIG1pcnJvclZlcnRpY2FsOiAnTWlycm9yLCBWZXJ0aWNhbCcsXHJcbiAgICAgICAgICAgIHJvdGF0ZUxlZnQ6ICdSb3RhdGUgbGVmdCcsXHJcbiAgICAgICAgICAgIHJvdGF0ZVJpZ2h0OiAnUm90YXRlIHJpZ2h0J1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKHR5cGVvZiBub0dsb2JhbCA9PT0gdHlwZW9mIHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGlmICghd2luZG93LlNVTkVESVRPUl9MQU5HKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5TVU5FRElUT1JfTEFORyA9IHt9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgd2luZG93LlNVTkVESVRPUl9MQU5HLmVuID0gbGFuZztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbGFuZztcclxufSkpOyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQ0E7QUE2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQkE7QUE2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhCQTtBQTNFQTtBQUNBO0FBOEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/lang/en.js\n");

/***/ }),

/***/ "./src/lib/constructor.js":
/*!********************************!*\
  !*** ./src/lib/constructor.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./util */ \"./src/lib/util.js\");\n/*\r\n * wysiwyg web editor\r\n *\r\n * suneditor.js\r\n * Copyright 2017 JiHong Lee.\r\n * MIT license.\r\n */\n\n\n\n/**\r\n * @description document create - call _createToolBar()\r\n * @param {element} element - textarea\r\n * @param {JSON} options - user options\r\n * @param {JSON} lang - user language\r\n * @param {JSON} _plugins - plugins object\r\n * @returns {JSON}\r\n * @private\r\n */\n\nconst _Constructor = {\n  init: function (element, options, lang, _plugins) {\n    if (typeof options !== 'object') options = {};\n    /** user options */\n\n    options.lang = lang; // toolbar\n\n    options.mode = options.mode || 'classic'; // classic, inline, balloon\n\n    options.toolbarWidth = options.toolbarWidth ? /^\\d+$/.test(options.toolbarWidth) ? options.toolbarWidth + 'px' : options.toolbarWidth : 'max-content';\n    options.stickyToolbar = /balloon/i.test(options.mode) ? -1 : options.stickyToolbar === undefined ? 0 : /\\d+/.test(options.stickyToolbar) ? options.stickyToolbar.toString().match(/\\d+/)[0] * 1 : -1; // bottom resizing bar\n\n    options.resizingBar = /inline|balloon/i.test(options.mode) ? false : options.resizingBar === undefined ? true : options.resizingBar;\n    options.showPathLabel = typeof options.showPathLabel === 'boolean' ? options.showPathLabel : true; // popup, editor display\n\n    options.popupDisplay = options.popupDisplay || 'full';\n    options.display = options.display || (element.style.display === 'none' || !element.style.display ? 'block' : element.style.display); // size\n\n    options.width = options.width ? /^\\d+$/.test(options.width) ? options.width + 'px' : options.width : element.clientWidth ? element.clientWidth + 'px' : '100%';\n    options.height = options.height ? /^\\d+$/.test(options.height) ? options.height + 'px' : options.height : element.clientHeight ? element.clientHeight + 'px' : 'auto';\n    options.minHeight = (/^\\d+$/.test(options.minHeight) ? options.height + 'px' : options.minHeight) || '';\n    options.maxHeight = (/^\\d+$/.test(options.maxHeight) ? options.maxHeight + 'px' : options.maxHeight) || ''; // font, size, color list\n\n    options.font = options.font || null;\n    options.fontSize = options.fontSize || null;\n    options.colorList = options.colorList || null; // images\n\n    options.imageResizing = options.imageResizing === undefined ? true : options.imageResizing;\n    options.imageWidth = options.imageWidth || 'auto';\n    options.imageFileInput = options.imageFileInput === undefined ? true : options.imageFileInput;\n    options.imageUrlInput = options.imageUrlInput === undefined || !options.imageFileInput ? true : options.imageUrlInput;\n    options.imageUploadUrl = options.imageUploadUrl || null; // video\n\n    options.videoResizing = options.videoResizing === undefined ? true : options.videoResizing;\n    options.videoWidth = options.videoWidth || 560;\n    options.videoHeight = options.videoHeight || 315;\n    options.youtubeQuery = options.youtubeQuery || ''; // callBack function\n    // options.callBackSave = options.callBackSave;\n    // buttons\n\n    options.buttonList = options.buttonList || [['undo', 'redo'], ['bold', 'underline', 'italic', 'strike', 'subscript', 'superscript'], ['removeFormat'], ['indent', 'outdent'], ['fullScreen', 'showBlocks', 'codeView'], ['preview', 'print']];\n    const doc = document;\n    /** suneditor div */\n\n    const top_div = doc.createElement('DIV');\n    top_div.className = 'sun-editor';\n    if (element.id) top_div.id = 'suneditor_' + element.id;\n    top_div.style.width = options.width;\n    top_div.style.display = options.display;\n    /** relative div */\n\n    const relative = doc.createElement('DIV');\n    relative.className = 'sun-editor-container';\n    /** toolbar */\n\n    const tool_bar = this._createToolBar(doc, options.buttonList, _plugins, lang);\n\n    let arrow = null;\n\n    if (/inline|balloon/i.test(options.mode)) {\n      tool_bar.element.className += ' sun-inline-toolbar';\n      tool_bar.element.style.width = options.toolbarWidth;\n\n      if (/balloon/i.test(options.mode)) {\n        arrow = doc.createElement('DIV');\n        arrow.className = 'arrow';\n        tool_bar.element.appendChild(arrow);\n      }\n    }\n    /** sticky toolbar dummy */\n\n\n    const sticky_dummy = doc.createElement('DIV');\n    sticky_dummy.className = 'sun-editor-sticky-dummy';\n    /** inner editor div */\n\n    const editor_div = doc.createElement('DIV');\n    editor_div.className = 'sun-editor-id-editorArea';\n    /** wysiwyg div */\n\n    const wysiwyg_div = doc.createElement('DIV');\n    wysiwyg_div.setAttribute('contenteditable', true);\n    wysiwyg_div.setAttribute('scrolling', 'auto');\n    wysiwyg_div.className = 'input_editor sun-editor-id-wysiwyg sun-editor-editable';\n    wysiwyg_div.style.display = 'block';\n    wysiwyg_div.innerHTML = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].convertContentsForEditor(element.value);\n    wysiwyg_div.style.height = options.height;\n    wysiwyg_div.style.minHeight = options.minHeight;\n    wysiwyg_div.style.maxHeight = options.maxHeight;\n    /** textarea for code view */\n\n    const textarea = doc.createElement('TEXTAREA');\n    textarea.className = 'input_editor sun-editor-id-code';\n    textarea.style.display = 'none';\n    textarea.style.height = options.height;\n    textarea.style.minHeight = options.minHeight;\n    textarea.style.maxHeight = options.maxHeight;\n    /** resize bar */\n\n    let resizing_bar = null;\n\n    if (options.resizingBar) {\n      resizing_bar = doc.createElement('DIV');\n      resizing_bar.className = 'sun-editor-id-resizingBar sun-editor-common';\n    }\n    /** navigation */\n\n\n    const navigation = doc.createElement('SPAN');\n    navigation.className = 'sun-editor-id-navigation sun-editor-common';\n    /** loading box */\n\n    const loading_box = doc.createElement('DIV');\n    loading_box.className = 'sun-editor-id-loading sun-editor-common';\n    loading_box.innerHTML = '<div class=\"loading-effect\"></div>';\n    /** resize operation background */\n\n    const resize_back = doc.createElement('DIV');\n    resize_back.className = 'sun-editor-id-resize-background';\n    /** append html */\n\n    editor_div.appendChild(wysiwyg_div);\n    editor_div.appendChild(textarea);\n    relative.appendChild(tool_bar.element);\n    relative.appendChild(sticky_dummy);\n    relative.appendChild(editor_div);\n    relative.appendChild(resize_back);\n    relative.appendChild(loading_box);\n\n    if (resizing_bar) {\n      resizing_bar.appendChild(navigation);\n      relative.appendChild(resizing_bar);\n    }\n\n    top_div.appendChild(relative);\n    return {\n      constructed: {\n        _top: top_div,\n        _relative: relative,\n        _toolBar: tool_bar.element,\n        _editorArea: editor_div,\n        _wysiwygArea: wysiwyg_div,\n        _codeArea: textarea,\n        _resizingBar: resizing_bar,\n        _navigation: navigation,\n        _loading: loading_box,\n        _resizeBack: resize_back,\n        _stickyDummy: sticky_dummy,\n        _arrow: arrow\n      },\n      options: options,\n      plugins: tool_bar.plugins\n    };\n  },\n\n  /**\r\n   * @description Suneditor's Default button list\r\n   * @private\r\n   */\n  _defaultButtons: function (lang) {\n    return {\n      /** command */\n      bold: ['sun-editor-id-bold', lang.toolbar.bold + '(Ctrl+B)', 'bold', '', '<div class=\"icon-bold\"></div>'],\n      underline: ['sun-editor-id-underline', lang.toolbar.underline + '(Ctrl+U)', 'underline', '', '<div class=\"icon-underline\"></div>'],\n      italic: ['sun-editor-id-italic', lang.toolbar.italic + '(Ctrl+I)', 'italic', '', '<div class=\"icon-italic\"></div>'],\n      strike: ['sun-editor-id-strike', lang.toolbar.strike + '(Ctrl+SHIFT+S)', 'strikethrough', '', '<div class=\"icon-strokethrough\"></div>'],\n      subscript: ['sun-editor-id-subscript', lang.toolbar.subscript, 'subscript', '', '<div class=\"icon-subscript\"></div>'],\n      superscript: ['sun-editor-id-superscript', lang.toolbar.superscript, 'superscript', '', '<div class=\"icon-superscript\"></div>'],\n      removeFormat: ['', lang.toolbar.removeFormat, 'removeFormat', '', '<div class=\"icon-erase\"></div>'],\n      indent: ['', lang.toolbar.indent + '(Ctrl + ])', 'indent', '', '<div class=\"icon-indent-right\"></div>'],\n      outdent: ['', lang.toolbar.outdent + '(Ctrl + [)', 'outdent', '', '<div class=\"icon-indent-left\"></div>'],\n      fullScreen: ['code-view-enabled', lang.toolbar.fullScreen, 'fullScreen', '', '<div class=\"icon-expansion\"></div>'],\n      showBlocks: ['', lang.toolbar.showBlocks, 'showBlocks', '', '<div class=\"icon-showBlocks\"></div>'],\n      codeView: ['code-view-enabled', lang.toolbar.codeView, 'codeView', '', '<div class=\"icon-code-view\"></div>'],\n      undo: ['code-view-enabled', lang.toolbar.undo + ' (Ctrl+Z)', 'undo', '', '<div class=\"icon-undo\"></div>'],\n      redo: ['code-view-enabled', lang.toolbar.redo + ' (Ctrl+Y)', 'redo', '', '<div class=\"icon-redo\"></div>'],\n      preview: ['', lang.toolbar.preview, 'preview', '', '<div class=\"icon-preview\"></div>'],\n      print: ['', lang.toolbar.print, 'print', '', '<div class=\"icon-print\"></div>'],\n      save: ['', lang.toolbar.save, 'save', '', '<div class=\"icon-save\"></div>'],\n\n      /** plugins - submenu */\n      font: ['btn_font', lang.toolbar.font, 'font', 'submenu', '<span class=\"txt sun-editor-font-family\">' + lang.toolbar.font + '</span><span class=\"icon-arrow-down\"></span>'],\n      formatBlock: ['btn_format', lang.toolbar.formats, 'formatBlock', 'submenu', '<span class=\"txt sun-editor-font-format\">' + lang.toolbar.formats + '</span><span class=\"icon-arrow-down\"></span>'],\n      fontSize: ['btn_size', lang.toolbar.fontSize, 'fontSize', 'submenu', '<span class=\"txt sun-editor-font-size\">' + lang.toolbar.fontSize + '</span><span class=\"icon-arrow-down\"></span>'],\n      fontColor: ['', lang.toolbar.fontColor, 'fontColor', 'submenu', '<div class=\"icon-fontColor\"></div>'],\n      hiliteColor: ['', lang.toolbar.hiliteColor, 'hiliteColor', 'submenu', '<div class=\"icon-hiliteColor\"></div>'],\n      align: ['btn_align', lang.toolbar.align, 'align', 'submenu', '<div class=\"icon-align-left\"></div>'],\n      list: ['', lang.toolbar.list, 'list', 'submenu', '<div class=\"icon-list-number\"></div>'],\n      horizontalRule: ['btn_line', lang.toolbar.horizontalRule, 'horizontalRule', 'submenu', '<div class=\"icon-hr\"></div>'],\n      table: ['', lang.toolbar.table, 'table', 'submenu', '<div class=\"icon-grid\"></div>'],\n\n      /** plugins - dialog */\n      link: ['', lang.toolbar.link, 'link', 'dialog', '<div class=\"icon-link\"></div>'],\n      image: ['', lang.toolbar.image, 'image', 'dialog', '<div class=\"icon-image\"></div>'],\n      video: ['', lang.toolbar.video, 'video', 'dialog', '<div class=\"icon-video\"></div>']\n    };\n  },\n\n  /**\r\n   * @description Create a group div containing each module\r\n   * @returns {Element}\r\n   * @private\r\n   */\n  _createModuleGroup: function (oneModule) {\n    const oDiv = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('DIV');\n    oDiv.className = 'tool_module' + (oneModule ? '' : ' sun-editor-module-border');\n    const oUl = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('UL');\n    oUl.className = 'editor_tool';\n    oDiv.appendChild(oUl);\n    return {\n      'div': oDiv,\n      'ul': oUl\n    };\n  },\n\n  /**\r\n   * @description Create a button element\r\n   * @param {string} buttonClass - className in button\r\n   * @param {string} title - Title in button\r\n   * @param {string} dataCommand - The data-command property of the button\r\n   * @param {string} dataDisplay - The data-display property of the button ('dialog', 'submenu')\r\n   * @param {string} innerHTML - Html in button\r\n   * @returns {Element}\r\n   * @private\r\n   */\n  _createButton: function (buttonClass, title, dataCommand, dataDisplay, innerHTML) {\n    const oLi = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('LI');\n    const oButton = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('BUTTON');\n    oButton.setAttribute('type', 'button');\n    oButton.setAttribute('class', 'btn_editor ' + buttonClass);\n    oButton.setAttribute('title', title);\n    oButton.setAttribute('data-command', dataCommand);\n    oButton.setAttribute('data-display', dataDisplay);\n    oButton.innerHTML = innerHTML;\n    oLi.appendChild(oButton);\n    return {\n      'li': oLi,\n      'button': oButton\n    };\n  },\n\n  /**\r\n   * @description Create editor HTML\r\n   * @param {Array} doc - document object\r\n   * @param {Array} buttonList - option.buttonList\r\n   * @param {Array} lang - option.lang\r\n   * @private\r\n   */\n  _createToolBar: function (doc, buttonList, _plugins, lang) {\n    const separator_vertical = doc.createElement('DIV');\n    separator_vertical.className = 'sun-editor-toolbar-separator-vertical';\n    const tool_bar = doc.createElement('DIV');\n    tool_bar.className = 'sun-editor-id-toolbar sun-editor-common';\n    /** create button list */\n\n    const defaultButtonList = this._defaultButtons(lang);\n\n    const plugins = {};\n\n    if (_plugins) {\n      const pluginsValues = _plugins.length ? _plugins : Object.keys(_plugins).map(function (e) {\n        return _plugins[e];\n      });\n\n      for (let i = 0, len = pluginsValues.length; i < len; i++) {\n        plugins[pluginsValues[i].name] = pluginsValues[i];\n      }\n    }\n\n    let module = null;\n    let button = null;\n    let moduleElement = null;\n    let buttonElement = null;\n    let pluginName = '';\n    let vertical = false;\n    const oneModule = buttonList.length === 1;\n\n    for (let i = 0; i < buttonList.length; i++) {\n      const buttonGroup = buttonList[i];\n      moduleElement = this._createModuleGroup(oneModule);\n      /** button object */\n\n      if (typeof buttonGroup === 'object') {\n        for (let j = 0; j < buttonGroup.length; j++) {\n          button = buttonGroup[j];\n\n          if (typeof button === 'object') {\n            if (typeof button.add === 'function') {\n              pluginName = button.name;\n              module = defaultButtonList[pluginName];\n              plugins[pluginName] = button;\n            } else {\n              pluginName = button.name;\n              module = [button.className, button.title, button.dataCommand, button.dataDisplay, button.displayOption, button.innerHTML];\n            }\n          } else {\n            module = defaultButtonList[button];\n            pluginName = button;\n          }\n\n          buttonElement = this._createButton(module[0], module[1], module[2], module[3], module[4]);\n          moduleElement.ul.appendChild(buttonElement.li);\n\n          if (plugins[pluginName]) {\n            plugins[pluginName].buttonElement = buttonElement.button;\n          }\n        }\n\n        if (vertical) tool_bar.appendChild(separator_vertical.cloneNode(false));\n        tool_bar.appendChild(moduleElement.div);\n        vertical = true;\n      }\n      /** line break  */\n      else if (/^\\/$/.test(buttonGroup)) {\n          const enterDiv = doc.createElement('DIV');\n          enterDiv.className = 'tool_module_enter';\n          tool_bar.appendChild(enterDiv);\n          vertical = false;\n        }\n    }\n\n    const tool_cover = doc.createElement('DIV');\n    tool_cover.className = 'sun-editor-id-toolbar-cover';\n    tool_bar.appendChild(tool_cover);\n    return {\n      'element': tool_bar,\n      'plugins': plugins\n    };\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (_Constructor);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbGliL2NvbnN0cnVjdG9yLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2xpYi9jb25zdHJ1Y3Rvci5qcz9jMTA1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIHd5c2l3eWcgd2ViIGVkaXRvclxyXG4gKlxyXG4gKiBzdW5lZGl0b3IuanNcclxuICogQ29weXJpZ2h0IDIwMTcgSmlIb25nIExlZS5cclxuICogTUlUIGxpY2Vuc2UuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5pbXBvcnQgdXRpbCBmcm9tICcuL3V0aWwnO1xyXG5cclxuLyoqXHJcbiAqIEBkZXNjcmlwdGlvbiBkb2N1bWVudCBjcmVhdGUgLSBjYWxsIF9jcmVhdGVUb29sQmFyKClcclxuICogQHBhcmFtIHtlbGVtZW50fSBlbGVtZW50IC0gdGV4dGFyZWFcclxuICogQHBhcmFtIHtKU09OfSBvcHRpb25zIC0gdXNlciBvcHRpb25zXHJcbiAqIEBwYXJhbSB7SlNPTn0gbGFuZyAtIHVzZXIgbGFuZ3VhZ2VcclxuICogQHBhcmFtIHtKU09OfSBfcGx1Z2lucyAtIHBsdWdpbnMgb2JqZWN0XHJcbiAqIEByZXR1cm5zIHtKU09OfVxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuY29uc3QgX0NvbnN0cnVjdG9yID0ge1xyXG4gICAgaW5pdDogZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMsIGxhbmcsIF9wbHVnaW5zKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSAnb2JqZWN0Jykgb3B0aW9ucyA9IHt9O1xyXG4gICAgXHJcbiAgICAgICAgLyoqIHVzZXIgb3B0aW9ucyAqL1xyXG4gICAgICAgIG9wdGlvbnMubGFuZyA9IGxhbmc7XHJcbiAgICAgICAgLy8gdG9vbGJhclxyXG4gICAgICAgIG9wdGlvbnMubW9kZSA9IG9wdGlvbnMubW9kZSB8fCAnY2xhc3NpYyc7IC8vIGNsYXNzaWMsIGlubGluZSwgYmFsbG9vblxyXG4gICAgICAgIG9wdGlvbnMudG9vbGJhcldpZHRoID0gb3B0aW9ucy50b29sYmFyV2lkdGggPyAoL15cXGQrJC8udGVzdChvcHRpb25zLnRvb2xiYXJXaWR0aCkgPyBvcHRpb25zLnRvb2xiYXJXaWR0aCArICdweCcgOiBvcHRpb25zLnRvb2xiYXJXaWR0aCkgOiAnbWF4LWNvbnRlbnQnO1xyXG4gICAgICAgIG9wdGlvbnMuc3RpY2t5VG9vbGJhciA9IC9iYWxsb29uL2kudGVzdChvcHRpb25zLm1vZGUpID8gLTEgOiBvcHRpb25zLnN0aWNreVRvb2xiYXIgPT09IHVuZGVmaW5lZCA/IDAgOiAoL1xcZCsvLnRlc3Qob3B0aW9ucy5zdGlja3lUb29sYmFyKSA/IG9wdGlvbnMuc3RpY2t5VG9vbGJhci50b1N0cmluZygpLm1hdGNoKC9cXGQrLylbMF0gKiAxIDogLTEpO1xyXG4gICAgICAgIC8vIGJvdHRvbSByZXNpemluZyBiYXJcclxuICAgICAgICBvcHRpb25zLnJlc2l6aW5nQmFyID0gL2lubGluZXxiYWxsb29uL2kudGVzdChvcHRpb25zLm1vZGUpID8gZmFsc2UgOiBvcHRpb25zLnJlc2l6aW5nQmFyID09PSB1bmRlZmluZWQgPyB0cnVlIDogb3B0aW9ucy5yZXNpemluZ0JhcjtcclxuICAgICAgICBvcHRpb25zLnNob3dQYXRoTGFiZWwgPSB0eXBlb2Ygb3B0aW9ucy5zaG93UGF0aExhYmVsID09PSAnYm9vbGVhbicgPyBvcHRpb25zLnNob3dQYXRoTGFiZWwgOiB0cnVlO1xyXG4gICAgICAgIC8vIHBvcHVwLCBlZGl0b3IgZGlzcGxheVxyXG4gICAgICAgIG9wdGlvbnMucG9wdXBEaXNwbGF5ID0gb3B0aW9ucy5wb3B1cERpc3BsYXkgfHwgJ2Z1bGwnO1xyXG4gICAgICAgIG9wdGlvbnMuZGlzcGxheSA9IG9wdGlvbnMuZGlzcGxheSB8fCAoZWxlbWVudC5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScgfHwgIWVsZW1lbnQuc3R5bGUuZGlzcGxheSA/ICdibG9jaycgOiBlbGVtZW50LnN0eWxlLmRpc3BsYXkpO1xyXG4gICAgICAgIC8vIHNpemVcclxuICAgICAgICBvcHRpb25zLndpZHRoID0gb3B0aW9ucy53aWR0aCA/ICgvXlxcZCskLy50ZXN0KG9wdGlvbnMud2lkdGgpID8gb3B0aW9ucy53aWR0aCArICdweCcgOiBvcHRpb25zLndpZHRoKSA6IChlbGVtZW50LmNsaWVudFdpZHRoID8gZWxlbWVudC5jbGllbnRXaWR0aCArICdweCcgOiAnMTAwJScpO1xyXG4gICAgICAgIG9wdGlvbnMuaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQgPyAoL15cXGQrJC8udGVzdChvcHRpb25zLmhlaWdodCkgPyBvcHRpb25zLmhlaWdodCArICdweCcgOiBvcHRpb25zLmhlaWdodCkgOiAoZWxlbWVudC5jbGllbnRIZWlnaHQgPyBlbGVtZW50LmNsaWVudEhlaWdodCArICdweCcgOiAnYXV0bycpO1xyXG4gICAgICAgIG9wdGlvbnMubWluSGVpZ2h0ID0gKC9eXFxkKyQvLnRlc3Qob3B0aW9ucy5taW5IZWlnaHQpID8gb3B0aW9ucy5oZWlnaHQgKyAncHgnIDogb3B0aW9ucy5taW5IZWlnaHQpIHx8ICcnO1xyXG4gICAgICAgIG9wdGlvbnMubWF4SGVpZ2h0ID0gKC9eXFxkKyQvLnRlc3Qob3B0aW9ucy5tYXhIZWlnaHQpID8gb3B0aW9ucy5tYXhIZWlnaHQgKyAncHgnIDogb3B0aW9ucy5tYXhIZWlnaHQpIHx8ICcnO1xyXG4gICAgICAgIC8vIGZvbnQsIHNpemUsIGNvbG9yIGxpc3RcclxuICAgICAgICBvcHRpb25zLmZvbnQgPSBvcHRpb25zLmZvbnQgfHwgbnVsbDtcclxuICAgICAgICBvcHRpb25zLmZvbnRTaXplID0gb3B0aW9ucy5mb250U2l6ZSB8fCBudWxsO1xyXG4gICAgICAgIG9wdGlvbnMuY29sb3JMaXN0ID0gb3B0aW9ucy5jb2xvckxpc3QgfHwgbnVsbDtcclxuICAgICAgICAvLyBpbWFnZXNcclxuICAgICAgICBvcHRpb25zLmltYWdlUmVzaXppbmcgPSBvcHRpb25zLmltYWdlUmVzaXppbmcgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBvcHRpb25zLmltYWdlUmVzaXppbmc7XHJcbiAgICAgICAgb3B0aW9ucy5pbWFnZVdpZHRoID0gb3B0aW9ucy5pbWFnZVdpZHRoIHx8ICdhdXRvJztcclxuICAgICAgICBvcHRpb25zLmltYWdlRmlsZUlucHV0ID0gb3B0aW9ucy5pbWFnZUZpbGVJbnB1dCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IG9wdGlvbnMuaW1hZ2VGaWxlSW5wdXQ7XHJcbiAgICAgICAgb3B0aW9ucy5pbWFnZVVybElucHV0ID0gKG9wdGlvbnMuaW1hZ2VVcmxJbnB1dCA9PT0gdW5kZWZpbmVkIHx8ICFvcHRpb25zLmltYWdlRmlsZUlucHV0KSA/IHRydWUgOiBvcHRpb25zLmltYWdlVXJsSW5wdXQ7XHJcbiAgICAgICAgb3B0aW9ucy5pbWFnZVVwbG9hZFVybCA9IG9wdGlvbnMuaW1hZ2VVcGxvYWRVcmwgfHwgbnVsbDtcclxuICAgICAgICAvLyB2aWRlb1xyXG4gICAgICAgIG9wdGlvbnMudmlkZW9SZXNpemluZyA9IG9wdGlvbnMudmlkZW9SZXNpemluZyA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IG9wdGlvbnMudmlkZW9SZXNpemluZztcclxuICAgICAgICBvcHRpb25zLnZpZGVvV2lkdGggPSBvcHRpb25zLnZpZGVvV2lkdGggfHwgNTYwO1xyXG4gICAgICAgIG9wdGlvbnMudmlkZW9IZWlnaHQgPSBvcHRpb25zLnZpZGVvSGVpZ2h0IHx8IDMxNTtcclxuICAgICAgICBvcHRpb25zLnlvdXR1YmVRdWVyeSA9IG9wdGlvbnMueW91dHViZVF1ZXJ5IHx8ICcnO1xyXG4gICAgICAgIC8vIGNhbGxCYWNrIGZ1bmN0aW9uXHJcbiAgICAgICAgLy8gb3B0aW9ucy5jYWxsQmFja1NhdmUgPSBvcHRpb25zLmNhbGxCYWNrU2F2ZTtcclxuICAgICAgICAvLyBidXR0b25zXHJcbiAgICAgICAgb3B0aW9ucy5idXR0b25MaXN0ID0gb3B0aW9ucy5idXR0b25MaXN0IHx8IFtcclxuICAgICAgICAgICAgWyd1bmRvJywgJ3JlZG8nXSxcclxuICAgICAgICAgICAgWydib2xkJywgJ3VuZGVybGluZScsICdpdGFsaWMnLCAnc3RyaWtlJywgJ3N1YnNjcmlwdCcsICdzdXBlcnNjcmlwdCddLFxyXG4gICAgICAgICAgICBbJ3JlbW92ZUZvcm1hdCddLFxyXG4gICAgICAgICAgICBbJ2luZGVudCcsICdvdXRkZW50J10sXHJcbiAgICAgICAgICAgIFsnZnVsbFNjcmVlbicsICdzaG93QmxvY2tzJywgJ2NvZGVWaWV3J10sXHJcbiAgICAgICAgICAgIFsncHJldmlldycsICdwcmludCddXHJcbiAgICAgICAgXTtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IGRvYyA9IGRvY3VtZW50O1xyXG4gICAgXHJcbiAgICAgICAgLyoqIHN1bmVkaXRvciBkaXYgKi9cclxuICAgICAgICBjb25zdCB0b3BfZGl2ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIHRvcF9kaXYuY2xhc3NOYW1lID0gJ3N1bi1lZGl0b3InO1xyXG4gICAgICAgIGlmIChlbGVtZW50LmlkKSB0b3BfZGl2LmlkID0gJ3N1bmVkaXRvcl8nICsgZWxlbWVudC5pZDtcclxuICAgICAgICB0b3BfZGl2LnN0eWxlLndpZHRoID0gb3B0aW9ucy53aWR0aDtcclxuICAgICAgICB0b3BfZGl2LnN0eWxlLmRpc3BsYXkgPSBvcHRpb25zLmRpc3BsYXk7XHJcbiAgICBcclxuICAgICAgICAvKiogcmVsYXRpdmUgZGl2ICovXHJcbiAgICAgICAgY29uc3QgcmVsYXRpdmUgPSBkb2MuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICAgICAgcmVsYXRpdmUuY2xhc3NOYW1lID0gJ3N1bi1lZGl0b3ItY29udGFpbmVyJztcclxuICAgIFxyXG4gICAgICAgIC8qKiB0b29sYmFyICovXHJcbiAgICAgICAgY29uc3QgdG9vbF9iYXIgPSB0aGlzLl9jcmVhdGVUb29sQmFyKGRvYywgb3B0aW9ucy5idXR0b25MaXN0LCBfcGx1Z2lucywgbGFuZyk7XHJcblxyXG4gICAgICAgIGxldCBhcnJvdyA9IG51bGw7XHJcbiAgICAgICAgaWYgKC9pbmxpbmV8YmFsbG9vbi9pLnRlc3Qob3B0aW9ucy5tb2RlKSkge1xyXG4gICAgICAgICAgICB0b29sX2Jhci5lbGVtZW50LmNsYXNzTmFtZSArPSAnIHN1bi1pbmxpbmUtdG9vbGJhcic7XHJcbiAgICAgICAgICAgIHRvb2xfYmFyLmVsZW1lbnQuc3R5bGUud2lkdGggPSBvcHRpb25zLnRvb2xiYXJXaWR0aDtcclxuICAgICAgICAgICAgaWYgKC9iYWxsb29uL2kudGVzdChvcHRpb25zLm1vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICBhcnJvdyA9IGRvYy5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICAgICAgICAgIGFycm93LmNsYXNzTmFtZSA9ICdhcnJvdyc7XHJcbiAgICAgICAgICAgICAgICB0b29sX2Jhci5lbGVtZW50LmFwcGVuZENoaWxkKGFycm93KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqIHN0aWNreSB0b29sYmFyIGR1bW15ICovXHJcbiAgICAgICAgY29uc3Qgc3RpY2t5X2R1bW15ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIHN0aWNreV9kdW1teS5jbGFzc05hbWUgPSAnc3VuLWVkaXRvci1zdGlja3ktZHVtbXknO1xyXG4gICAgXHJcbiAgICAgICAgLyoqIGlubmVyIGVkaXRvciBkaXYgKi9cclxuICAgICAgICBjb25zdCBlZGl0b3JfZGl2ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIGVkaXRvcl9kaXYuY2xhc3NOYW1lID0gJ3N1bi1lZGl0b3ItaWQtZWRpdG9yQXJlYSc7XHJcbiAgICBcclxuICAgICAgICAvKiogd3lzaXd5ZyBkaXYgKi9cclxuICAgICAgICBjb25zdCB3eXNpd3lnX2RpdiA9IGRvYy5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICB3eXNpd3lnX2Rpdi5zZXRBdHRyaWJ1dGUoJ2NvbnRlbnRlZGl0YWJsZScsIHRydWUpO1xyXG4gICAgICAgIHd5c2l3eWdfZGl2LnNldEF0dHJpYnV0ZSgnc2Nyb2xsaW5nJywgJ2F1dG8nKTtcclxuICAgICAgICB3eXNpd3lnX2Rpdi5jbGFzc05hbWUgPSAnaW5wdXRfZWRpdG9yIHN1bi1lZGl0b3ItaWQtd3lzaXd5ZyBzdW4tZWRpdG9yLWVkaXRhYmxlJztcclxuICAgICAgICB3eXNpd3lnX2Rpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICB3eXNpd3lnX2Rpdi5pbm5lckhUTUwgPSB1dGlsLmNvbnZlcnRDb250ZW50c0ZvckVkaXRvcihlbGVtZW50LnZhbHVlKTtcclxuICAgICAgICB3eXNpd3lnX2Rpdi5zdHlsZS5oZWlnaHQgPSBvcHRpb25zLmhlaWdodDtcclxuICAgICAgICB3eXNpd3lnX2Rpdi5zdHlsZS5taW5IZWlnaHQgPSBvcHRpb25zLm1pbkhlaWdodDtcclxuICAgICAgICB3eXNpd3lnX2Rpdi5zdHlsZS5tYXhIZWlnaHQgPSBvcHRpb25zLm1heEhlaWdodDtcclxuICAgIFxyXG4gICAgICAgIC8qKiB0ZXh0YXJlYSBmb3IgY29kZSB2aWV3ICovXHJcbiAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBkb2MuY3JlYXRlRWxlbWVudCgnVEVYVEFSRUEnKTtcclxuICAgICAgICB0ZXh0YXJlYS5jbGFzc05hbWUgPSAnaW5wdXRfZWRpdG9yIHN1bi1lZGl0b3ItaWQtY29kZSc7XHJcbiAgICAgICAgdGV4dGFyZWEuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICB0ZXh0YXJlYS5zdHlsZS5oZWlnaHQgPSBvcHRpb25zLmhlaWdodDtcclxuICAgICAgICB0ZXh0YXJlYS5zdHlsZS5taW5IZWlnaHQgPSBvcHRpb25zLm1pbkhlaWdodDtcclxuICAgICAgICB0ZXh0YXJlYS5zdHlsZS5tYXhIZWlnaHQgPSBvcHRpb25zLm1heEhlaWdodDtcclxuICAgIFxyXG4gICAgICAgIC8qKiByZXNpemUgYmFyICovXHJcbiAgICAgICAgbGV0IHJlc2l6aW5nX2JhciA9IG51bGw7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMucmVzaXppbmdCYXIpIHtcclxuICAgICAgICAgICAgcmVzaXppbmdfYmFyID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgICAgICByZXNpemluZ19iYXIuY2xhc3NOYW1lID0gJ3N1bi1lZGl0b3ItaWQtcmVzaXppbmdCYXIgc3VuLWVkaXRvci1jb21tb24nO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIC8qKiBuYXZpZ2F0aW9uICovXHJcbiAgICAgICAgY29uc3QgbmF2aWdhdGlvbiA9IGRvYy5jcmVhdGVFbGVtZW50KCdTUEFOJyk7XHJcbiAgICAgICAgbmF2aWdhdGlvbi5jbGFzc05hbWUgPSAnc3VuLWVkaXRvci1pZC1uYXZpZ2F0aW9uIHN1bi1lZGl0b3ItY29tbW9uJztcclxuICAgIFxyXG4gICAgICAgIC8qKiBsb2FkaW5nIGJveCAqL1xyXG4gICAgICAgIGNvbnN0IGxvYWRpbmdfYm94ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIGxvYWRpbmdfYm94LmNsYXNzTmFtZSA9ICdzdW4tZWRpdG9yLWlkLWxvYWRpbmcgc3VuLWVkaXRvci1jb21tb24nO1xyXG4gICAgICAgIGxvYWRpbmdfYm94LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwibG9hZGluZy1lZmZlY3RcIj48L2Rpdj4nO1xyXG4gICAgXHJcbiAgICAgICAgLyoqIHJlc2l6ZSBvcGVyYXRpb24gYmFja2dyb3VuZCAqL1xyXG4gICAgICAgIGNvbnN0IHJlc2l6ZV9iYWNrID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIHJlc2l6ZV9iYWNrLmNsYXNzTmFtZSA9ICdzdW4tZWRpdG9yLWlkLXJlc2l6ZS1iYWNrZ3JvdW5kJztcclxuICAgIFxyXG4gICAgICAgIC8qKiBhcHBlbmQgaHRtbCAqL1xyXG4gICAgICAgIGVkaXRvcl9kaXYuYXBwZW5kQ2hpbGQod3lzaXd5Z19kaXYpO1xyXG4gICAgICAgIGVkaXRvcl9kaXYuYXBwZW5kQ2hpbGQodGV4dGFyZWEpO1xyXG4gICAgICAgIHJlbGF0aXZlLmFwcGVuZENoaWxkKHRvb2xfYmFyLmVsZW1lbnQpO1xyXG4gICAgICAgIHJlbGF0aXZlLmFwcGVuZENoaWxkKHN0aWNreV9kdW1teSk7XHJcbiAgICAgICAgcmVsYXRpdmUuYXBwZW5kQ2hpbGQoZWRpdG9yX2Rpdik7XHJcbiAgICAgICAgcmVsYXRpdmUuYXBwZW5kQ2hpbGQocmVzaXplX2JhY2spO1xyXG4gICAgICAgIHJlbGF0aXZlLmFwcGVuZENoaWxkKGxvYWRpbmdfYm94KTtcclxuXHJcbiAgICAgICAgaWYgKHJlc2l6aW5nX2Jhcikge1xyXG4gICAgICAgICAgICByZXNpemluZ19iYXIuYXBwZW5kQ2hpbGQobmF2aWdhdGlvbik7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlLmFwcGVuZENoaWxkKHJlc2l6aW5nX2Jhcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRvcF9kaXYuYXBwZW5kQ2hpbGQocmVsYXRpdmUpO1xyXG4gICAgXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY29uc3RydWN0ZWQ6IHtcclxuICAgICAgICAgICAgICAgIF90b3A6IHRvcF9kaXYsXHJcbiAgICAgICAgICAgICAgICBfcmVsYXRpdmU6IHJlbGF0aXZlLFxyXG4gICAgICAgICAgICAgICAgX3Rvb2xCYXI6IHRvb2xfYmFyLmVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBfZWRpdG9yQXJlYTogZWRpdG9yX2RpdixcclxuICAgICAgICAgICAgICAgIF93eXNpd3lnQXJlYTogd3lzaXd5Z19kaXYsXHJcbiAgICAgICAgICAgICAgICBfY29kZUFyZWE6IHRleHRhcmVhLFxyXG4gICAgICAgICAgICAgICAgX3Jlc2l6aW5nQmFyOiByZXNpemluZ19iYXIsXHJcbiAgICAgICAgICAgICAgICBfbmF2aWdhdGlvbjogbmF2aWdhdGlvbixcclxuICAgICAgICAgICAgICAgIF9sb2FkaW5nOiBsb2FkaW5nX2JveCxcclxuICAgICAgICAgICAgICAgIF9yZXNpemVCYWNrOiByZXNpemVfYmFjayxcclxuICAgICAgICAgICAgICAgIF9zdGlja3lEdW1teTogc3RpY2t5X2R1bW15LFxyXG4gICAgICAgICAgICAgICAgX2Fycm93OiBhcnJvd1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zLFxyXG4gICAgICAgICAgICBwbHVnaW5zOiB0b29sX2Jhci5wbHVnaW5zXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gU3VuZWRpdG9yJ3MgRGVmYXVsdCBidXR0b24gbGlzdFxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX2RlZmF1bHRCdXR0b25zOiBmdW5jdGlvbiAobGFuZykge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIC8qKiBjb21tYW5kICovXHJcbiAgICAgICAgICAgIGJvbGQ6IFsnc3VuLWVkaXRvci1pZC1ib2xkJywgbGFuZy50b29sYmFyLmJvbGQgKyAnKEN0cmwrQiknLCAnYm9sZCcsICcnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWJvbGRcIj48L2Rpdj4nXHJcbiAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICB1bmRlcmxpbmU6IFsnc3VuLWVkaXRvci1pZC11bmRlcmxpbmUnLCBsYW5nLnRvb2xiYXIudW5kZXJsaW5lICsgJyhDdHJsK1UpJywgJ3VuZGVybGluZScsICcnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLXVuZGVybGluZVwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIGl0YWxpYzogWydzdW4tZWRpdG9yLWlkLWl0YWxpYycsIGxhbmcudG9vbGJhci5pdGFsaWMgKyAnKEN0cmwrSSknLCAnaXRhbGljJywgJycsXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImljb24taXRhbGljXCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgc3RyaWtlOiBbJ3N1bi1lZGl0b3ItaWQtc3RyaWtlJywgbGFuZy50b29sYmFyLnN0cmlrZSArICcoQ3RybCtTSElGVCtTKScsICdzdHJpa2V0aHJvdWdoJywgJycsXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImljb24tc3Ryb2tldGhyb3VnaFwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIHN1YnNjcmlwdDogWydzdW4tZWRpdG9yLWlkLXN1YnNjcmlwdCcsIGxhbmcudG9vbGJhci5zdWJzY3JpcHQsICdzdWJzY3JpcHQnLCAnJyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi1zdWJzY3JpcHRcIj48L2Rpdj4nXHJcbiAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICBzdXBlcnNjcmlwdDogWydzdW4tZWRpdG9yLWlkLXN1cGVyc2NyaXB0JywgbGFuZy50b29sYmFyLnN1cGVyc2NyaXB0LCAnc3VwZXJzY3JpcHQnLCAnJyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi1zdXBlcnNjcmlwdFwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIHJlbW92ZUZvcm1hdDogWycnLCBsYW5nLnRvb2xiYXIucmVtb3ZlRm9ybWF0LCAncmVtb3ZlRm9ybWF0JywgJycsXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImljb24tZXJhc2VcIj48L2Rpdj4nXHJcbiAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICBpbmRlbnQ6IFsnJywgbGFuZy50b29sYmFyLmluZGVudCArICcoQ3RybCArIF0pJywgJ2luZGVudCcsICcnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWluZGVudC1yaWdodFwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIG91dGRlbnQ6IFsnJywgbGFuZy50b29sYmFyLm91dGRlbnQgKyAnKEN0cmwgKyBbKScsICdvdXRkZW50JywgJycsXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImljb24taW5kZW50LWxlZnRcIj48L2Rpdj4nXHJcbiAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICBmdWxsU2NyZWVuOiBbJ2NvZGUtdmlldy1lbmFibGVkJywgbGFuZy50b29sYmFyLmZ1bGxTY3JlZW4sICdmdWxsU2NyZWVuJywgJycsXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImljb24tZXhwYW5zaW9uXCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgc2hvd0Jsb2NrczogWycnLCBsYW5nLnRvb2xiYXIuc2hvd0Jsb2NrcywgJ3Nob3dCbG9ja3MnLCAnJyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi1zaG93QmxvY2tzXCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgY29kZVZpZXc6IFsnY29kZS12aWV3LWVuYWJsZWQnLCBsYW5nLnRvb2xiYXIuY29kZVZpZXcsICdjb2RlVmlldycsICcnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWNvZGUtdmlld1wiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIHVuZG86IFsnY29kZS12aWV3LWVuYWJsZWQnLCBsYW5nLnRvb2xiYXIudW5kbyArICcgKEN0cmwrWiknLCAndW5kbycsICcnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLXVuZG9cIj48L2Rpdj4nXHJcbiAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICByZWRvOiBbJ2NvZGUtdmlldy1lbmFibGVkJywgbGFuZy50b29sYmFyLnJlZG8gKyAnIChDdHJsK1kpJywgJ3JlZG8nLCAnJyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi1yZWRvXCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgcHJldmlldzogWycnLCBsYW5nLnRvb2xiYXIucHJldmlldywgJ3ByZXZpZXcnLCAnJyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi1wcmV2aWV3XCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgcHJpbnQ6IFsnJywgbGFuZy50b29sYmFyLnByaW50LCAncHJpbnQnLCAnJyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi1wcmludFwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIHNhdmU6IFsnJywgbGFuZy50b29sYmFyLnNhdmUsICdzYXZlJywgJycsXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImljb24tc2F2ZVwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIC8qKiBwbHVnaW5zIC0gc3VibWVudSAqL1xyXG4gICAgICAgICAgICBmb250OiBbJ2J0bl9mb250JywgbGFuZy50b29sYmFyLmZvbnQsICdmb250JywgJ3N1Ym1lbnUnLFxyXG4gICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidHh0IHN1bi1lZGl0b3ItZm9udC1mYW1pbHlcIj4nICsgbGFuZy50b29sYmFyLmZvbnQgKyAnPC9zcGFuPjxzcGFuIGNsYXNzPVwiaWNvbi1hcnJvdy1kb3duXCI+PC9zcGFuPidcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgZm9ybWF0QmxvY2s6IFsnYnRuX2Zvcm1hdCcsIGxhbmcudG9vbGJhci5mb3JtYXRzLCAnZm9ybWF0QmxvY2snLCAnc3VibWVudScsXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ0eHQgc3VuLWVkaXRvci1mb250LWZvcm1hdFwiPicgKyBsYW5nLnRvb2xiYXIuZm9ybWF0cyArICc8L3NwYW4+PHNwYW4gY2xhc3M9XCJpY29uLWFycm93LWRvd25cIj48L3NwYW4+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgZm9udFNpemU6IFsnYnRuX3NpemUnLCBsYW5nLnRvb2xiYXIuZm9udFNpemUsICdmb250U2l6ZScsICdzdWJtZW51JyxcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInR4dCBzdW4tZWRpdG9yLWZvbnQtc2l6ZVwiPicgKyBsYW5nLnRvb2xiYXIuZm9udFNpemUgKyAnPC9zcGFuPjxzcGFuIGNsYXNzPVwiaWNvbi1hcnJvdy1kb3duXCI+PC9zcGFuPidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIGZvbnRDb2xvcjogWycnLCBsYW5nLnRvb2xiYXIuZm9udENvbG9yLCAnZm9udENvbG9yJywgJ3N1Ym1lbnUnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWZvbnRDb2xvclwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIGhpbGl0ZUNvbG9yOiBbJycsIGxhbmcudG9vbGJhci5oaWxpdGVDb2xvciwgJ2hpbGl0ZUNvbG9yJywgJ3N1Ym1lbnUnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWhpbGl0ZUNvbG9yXCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgYWxpZ246IFsnYnRuX2FsaWduJywgbGFuZy50b29sYmFyLmFsaWduLCAnYWxpZ24nLCAnc3VibWVudScsXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImljb24tYWxpZ24tbGVmdFwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIGxpc3Q6IFsnJywgbGFuZy50b29sYmFyLmxpc3QsICdsaXN0JywgJ3N1Ym1lbnUnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWxpc3QtbnVtYmVyXCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgaG9yaXpvbnRhbFJ1bGU6IFsnYnRuX2xpbmUnLCBsYW5nLnRvb2xiYXIuaG9yaXpvbnRhbFJ1bGUsICdob3Jpem9udGFsUnVsZScsICdzdWJtZW51JyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi1oclwiPjwvZGl2PidcclxuICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgIHRhYmxlOiBbJycsIGxhbmcudG9vbGJhci50YWJsZSwgJ3RhYmxlJywgJ3N1Ym1lbnUnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWdyaWRcIj48L2Rpdj4nXHJcbiAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICAvKiogcGx1Z2lucyAtIGRpYWxvZyAqL1xyXG4gICAgICAgICAgICBsaW5rOiBbJycsIGxhbmcudG9vbGJhci5saW5rLCAnbGluaycsICdkaWFsb2cnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWxpbmtcIj48L2Rpdj4nXHJcbiAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICBpbWFnZTogWycnLCBsYW5nLnRvb2xiYXIuaW1hZ2UsICdpbWFnZScsICdkaWFsb2cnLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpY29uLWltYWdlXCI+PC9kaXY+J1xyXG4gICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgdmlkZW86IFsnJywgbGFuZy50b29sYmFyLnZpZGVvLCAndmlkZW8nLCAnZGlhbG9nJyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaWNvbi12aWRlb1wiPjwvZGl2PidcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIENyZWF0ZSBhIGdyb3VwIGRpdiBjb250YWluaW5nIGVhY2ggbW9kdWxlXHJcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH1cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIF9jcmVhdGVNb2R1bGVHcm91cDogZnVuY3Rpb24gKG9uZU1vZHVsZSkge1xyXG4gICAgICAgIGNvbnN0IG9EaXYgPSB1dGlsLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIG9EaXYuY2xhc3NOYW1lID0gJ3Rvb2xfbW9kdWxlJyArIChvbmVNb2R1bGUgPyAnJyA6ICcgc3VuLWVkaXRvci1tb2R1bGUtYm9yZGVyJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9VbCA9IHV0aWwuY3JlYXRlRWxlbWVudCgnVUwnKTtcclxuICAgICAgICBvVWwuY2xhc3NOYW1lID0gJ2VkaXRvcl90b29sJztcclxuICAgICAgICBvRGl2LmFwcGVuZENoaWxkKG9VbCk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICdkaXYnOiBvRGl2LFxyXG4gICAgICAgICAgICAndWwnOiBvVWxcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBDcmVhdGUgYSBidXR0b24gZWxlbWVudFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGJ1dHRvbkNsYXNzIC0gY2xhc3NOYW1lIGluIGJ1dHRvblxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlIC0gVGl0bGUgaW4gYnV0dG9uXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGF0YUNvbW1hbmQgLSBUaGUgZGF0YS1jb21tYW5kIHByb3BlcnR5IG9mIHRoZSBidXR0b25cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhRGlzcGxheSAtIFRoZSBkYXRhLWRpc3BsYXkgcHJvcGVydHkgb2YgdGhlIGJ1dHRvbiAoJ2RpYWxvZycsICdzdWJtZW51JylcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbm5lckhUTUwgLSBIdG1sIGluIGJ1dHRvblxyXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfY3JlYXRlQnV0dG9uOiBmdW5jdGlvbiAoYnV0dG9uQ2xhc3MsIHRpdGxlLCBkYXRhQ29tbWFuZCwgZGF0YURpc3BsYXksIGlubmVySFRNTCkge1xyXG4gICAgICAgIGNvbnN0IG9MaSA9IHV0aWwuY3JlYXRlRWxlbWVudCgnTEknKTtcclxuICAgICAgICBjb25zdCBvQnV0dG9uID0gdXRpbC5jcmVhdGVFbGVtZW50KCdCVVRUT04nKTtcclxuXHJcbiAgICAgICAgb0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XHJcbiAgICAgICAgb0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2J0bl9lZGl0b3IgJyArIGJ1dHRvbkNsYXNzKTtcclxuICAgICAgICBvQnV0dG9uLnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0aXRsZSk7XHJcbiAgICAgICAgb0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtY29tbWFuZCcsIGRhdGFDb21tYW5kKTtcclxuICAgICAgICBvQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1kaXNwbGF5JywgZGF0YURpc3BsYXkpO1xyXG4gICAgICAgIG9CdXR0b24uaW5uZXJIVE1MID0gaW5uZXJIVE1MO1xyXG4gICAgICAgIG9MaS5hcHBlbmRDaGlsZChvQnV0dG9uKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgJ2xpJzogb0xpLFxyXG4gICAgICAgICAgICAnYnV0dG9uJzogb0J1dHRvblxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIENyZWF0ZSBlZGl0b3IgSFRNTFxyXG4gICAgICogQHBhcmFtIHtBcnJheX0gZG9jIC0gZG9jdW1lbnQgb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBidXR0b25MaXN0IC0gb3B0aW9uLmJ1dHRvbkxpc3RcclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxhbmcgLSBvcHRpb24ubGFuZ1xyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX2NyZWF0ZVRvb2xCYXI6IGZ1bmN0aW9uIChkb2MsIGJ1dHRvbkxpc3QsIF9wbHVnaW5zLCBsYW5nKSB7XHJcbiAgICAgICAgY29uc3Qgc2VwYXJhdG9yX3ZlcnRpY2FsID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIHNlcGFyYXRvcl92ZXJ0aWNhbC5jbGFzc05hbWUgPSAnc3VuLWVkaXRvci10b29sYmFyLXNlcGFyYXRvci12ZXJ0aWNhbCc7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvb2xfYmFyID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIHRvb2xfYmFyLmNsYXNzTmFtZSA9ICdzdW4tZWRpdG9yLWlkLXRvb2xiYXIgc3VuLWVkaXRvci1jb21tb24nO1xyXG5cclxuICAgICAgICAvKiogY3JlYXRlIGJ1dHRvbiBsaXN0ICovXHJcbiAgICAgICAgY29uc3QgZGVmYXVsdEJ1dHRvbkxpc3QgPSB0aGlzLl9kZWZhdWx0QnV0dG9ucyhsYW5nKTtcclxuICAgICAgICBjb25zdCBwbHVnaW5zID0ge307XHJcbiAgICAgICAgaWYgKF9wbHVnaW5zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbnNWYWx1ZXMgPSBfcGx1Z2lucy5sZW5ndGggPyBfcGx1Z2lucyA6IE9iamVjdC5rZXlzKF9wbHVnaW5zKS5tYXAoZnVuY3Rpb24oZSkgeyByZXR1cm4gX3BsdWdpbnNbZV07IH0pO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gcGx1Z2luc1ZhbHVlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgcGx1Z2luc1twbHVnaW5zVmFsdWVzW2ldLm5hbWVdID0gcGx1Z2luc1ZhbHVlc1tpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG1vZHVsZSA9IG51bGw7XHJcbiAgICAgICAgbGV0IGJ1dHRvbiA9IG51bGw7XHJcbiAgICAgICAgbGV0IG1vZHVsZUVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIGxldCBidXR0b25FbGVtZW50ID0gbnVsbDtcclxuICAgICAgICBsZXQgcGx1Z2luTmFtZSA9ICcnO1xyXG4gICAgICAgIGxldCB2ZXJ0aWNhbCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IG9uZU1vZHVsZSA9IGJ1dHRvbkxpc3QubGVuZ3RoID09PSAxO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1dHRvbkxpc3QubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkdyb3VwID0gYnV0dG9uTGlzdFtpXTtcclxuICAgICAgICAgICAgbW9kdWxlRWxlbWVudCA9IHRoaXMuX2NyZWF0ZU1vZHVsZUdyb3VwKG9uZU1vZHVsZSk7XHJcblxyXG4gICAgICAgICAgICAvKiogYnV0dG9uIG9iamVjdCAqL1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGJ1dHRvbkdyb3VwID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBidXR0b25Hcm91cC5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidXR0b24gPSBidXR0b25Hcm91cFtqXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJ1dHRvbiA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBidXR0b24uYWRkID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5OYW1lID0gYnV0dG9uLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUgPSBkZWZhdWx0QnV0dG9uTGlzdFtwbHVnaW5OYW1lXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbnNbcGx1Z2luTmFtZV0gPSBidXR0b247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5OYW1lID0gYnV0dG9uLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUgPSBbYnV0dG9uLmNsYXNzTmFtZSwgYnV0dG9uLnRpdGxlLCBidXR0b24uZGF0YUNvbW1hbmQsIGJ1dHRvbi5kYXRhRGlzcGxheSwgYnV0dG9uLmRpc3BsYXlPcHRpb24sIGJ1dHRvbi5pbm5lckhUTUxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlID0gZGVmYXVsdEJ1dHRvbkxpc3RbYnV0dG9uXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luTmFtZSA9IGJ1dHRvbjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9jcmVhdGVCdXR0b24obW9kdWxlWzBdLCBtb2R1bGVbMV0sIG1vZHVsZVsyXSwgbW9kdWxlWzNdLCBtb2R1bGVbNF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZUVsZW1lbnQudWwuYXBwZW5kQ2hpbGQoYnV0dG9uRWxlbWVudC5saSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwbHVnaW5zW3BsdWdpbk5hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbnNbcGx1Z2luTmFtZV0uYnV0dG9uRWxlbWVudCA9IGJ1dHRvbkVsZW1lbnQuYnV0dG9uO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodmVydGljYWwpIHRvb2xfYmFyLmFwcGVuZENoaWxkKHNlcGFyYXRvcl92ZXJ0aWNhbC5jbG9uZU5vZGUoZmFsc2UpKTtcclxuICAgICAgICAgICAgICAgIHRvb2xfYmFyLmFwcGVuZENoaWxkKG1vZHVsZUVsZW1lbnQuZGl2KTtcclxuICAgICAgICAgICAgICAgIHZlcnRpY2FsID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvKiogbGluZSBicmVhayAgKi9cclxuICAgICAgICAgICAgZWxzZSBpZiAoL15cXC8kLy50ZXN0KGJ1dHRvbkdyb3VwKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW50ZXJEaXYgPSBkb2MuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICAgICAgICAgICAgICBlbnRlckRpdi5jbGFzc05hbWUgPSAndG9vbF9tb2R1bGVfZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgdG9vbF9iYXIuYXBwZW5kQ2hpbGQoZW50ZXJEaXYpO1xyXG4gICAgICAgICAgICAgICAgdmVydGljYWwgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdG9vbF9jb3ZlciA9IGRvYy5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICB0b29sX2NvdmVyLmNsYXNzTmFtZSA9ICdzdW4tZWRpdG9yLWlkLXRvb2xiYXItY292ZXInO1xyXG4gICAgICAgIHRvb2xfYmFyLmFwcGVuZENoaWxkKHRvb2xfY292ZXIpO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAnZWxlbWVudCc6IHRvb2xfYmFyLFxyXG4gICAgICAgICAgICAncGx1Z2lucyc6IHBsdWdpbnNcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgX0NvbnN0cnVjdG9yOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFTQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBU0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFjQTtBQUNBO0FBaEJBO0FBa0JBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFDQTtBQUdBO0FBQ0E7QUFHQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBQ0E7QUFHQTtBQUNBO0FBSUE7QUFJQTtBQW5IQTtBQXVIQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7QUFVQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlCQTtBQWdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFoYUE7QUFtYUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/lib/constructor.js\n");

/***/ }),

/***/ "./src/lib/context.js":
/*!****************************!*\
  !*** ./src/lib/context.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/*\r\n * wysiwyg web editor\r\n *\r\n * suneditor.js\r\n * Copyright 2017 JiHong Lee.\r\n * MIT license.\r\n */\n\n/**\r\n * @description Elements and variables you should have\r\n * @param {HTMLElement} element - textarea element\r\n * @param {object} cons - Toolbar element you created\r\n * @param {json} options - Inserted options\r\n * @returns Elements, variables of the editor\r\n * @private\r\n */\n\nconst _Context = function (element, cons, options) {\n  return {\n    element: {\n      originElement: element,\n      topArea: cons._top,\n      relative: cons._relative,\n      toolbar: cons._toolBar,\n      resizingBar: cons._resizingBar,\n      navigation: cons._navigation,\n      editorArea: cons._editorArea,\n      wysiwyg: cons._wysiwygArea,\n      code: cons._codeArea,\n      loading: cons._loading,\n      resizeBackground: cons._resizeBack,\n      _stickyDummy: cons._stickyDummy,\n      _arrow: cons._arrow\n    },\n    tool: {\n      cover: cons._toolBar.getElementsByClassName('sun-editor-id-toolbar-cover')[0],\n      bold: cons._toolBar.getElementsByClassName('sun-editor-id-bold')[0],\n      underline: cons._toolBar.getElementsByClassName('sun-editor-id-underline')[0],\n      italic: cons._toolBar.getElementsByClassName('sun-editor-id-italic')[0],\n      strike: cons._toolBar.getElementsByClassName('sun-editor-id-strike')[0],\n      subscript: cons._toolBar.getElementsByClassName('sun-editor-id-subscript')[0],\n      superscript: cons._toolBar.getElementsByClassName('sun-editor-id-superscript')[0],\n      font: cons._toolBar.getElementsByClassName('sun-editor-font-family')[0],\n      format: cons._toolBar.getElementsByClassName('sun-editor-font-format')[0],\n      fontSize: cons._toolBar.getElementsByClassName('sun-editor-font-size')[0]\n    },\n    option: {\n      mode: options.mode,\n      toolbarWidth: options.toolbarWidth,\n      stickyToolbar: options.stickyToolbar,\n      resizingBar: options.resizingBar,\n      showPathLabel: options.showPathLabel,\n      popupDisplay: options.popupDisplay,\n      display: options.display,\n      height: options.height,\n      minHeight: options.minHeight,\n      maxHeight: options.maxHeight,\n      font: options.font,\n      fontSize: options.fontSize,\n      colorList: options.colorList,\n      imageResizing: options.imageResizing,\n      imageWidth: options.imageWidth,\n      imageFileInput: options.imageFileInput,\n      imageUrlInput: options.imageUrlInput,\n      imageUploadUrl: options.imageUploadUrl,\n      videoResizing: options.videoResizing,\n      videoWidth: options.videoWidth,\n      videoHeight: options.videoHeight,\n      youtubeQuery: options.youtubeQuery.replace('?', ''),\n      callBackSave: options.callBackSave\n    }\n  };\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (_Context);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbGliL2NvbnRleHQuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbGliL2NvbnRleHQuanM/ZDgzOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiB3eXNpd3lnIHdlYiBlZGl0b3JcclxuICpcclxuICogc3VuZWRpdG9yLmpzXHJcbiAqIENvcHlyaWdodCAyMDE3IEppSG9uZyBMZWUuXHJcbiAqIE1JVCBsaWNlbnNlLlxyXG4gKi9cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuLyoqXHJcbiAqIEBkZXNjcmlwdGlvbiBFbGVtZW50cyBhbmQgdmFyaWFibGVzIHlvdSBzaG91bGQgaGF2ZVxyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50IC0gdGV4dGFyZWEgZWxlbWVudFxyXG4gKiBAcGFyYW0ge29iamVjdH0gY29ucyAtIFRvb2xiYXIgZWxlbWVudCB5b3UgY3JlYXRlZFxyXG4gKiBAcGFyYW0ge2pzb259IG9wdGlvbnMgLSBJbnNlcnRlZCBvcHRpb25zXHJcbiAqIEByZXR1cm5zIEVsZW1lbnRzLCB2YXJpYWJsZXMgb2YgdGhlIGVkaXRvclxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuY29uc3QgX0NvbnRleHQgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29ucywgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBlbGVtZW50OiB7XHJcbiAgICAgICAgICAgIG9yaWdpbkVsZW1lbnQ6IGVsZW1lbnQsXHJcbiAgICAgICAgICAgIHRvcEFyZWE6IGNvbnMuX3RvcCxcclxuICAgICAgICAgICAgcmVsYXRpdmU6IGNvbnMuX3JlbGF0aXZlLFxyXG4gICAgICAgICAgICB0b29sYmFyOiBjb25zLl90b29sQmFyLFxyXG4gICAgICAgICAgICByZXNpemluZ0JhcjogY29ucy5fcmVzaXppbmdCYXIsXHJcbiAgICAgICAgICAgIG5hdmlnYXRpb246IGNvbnMuX25hdmlnYXRpb24sXHJcbiAgICAgICAgICAgIGVkaXRvckFyZWE6IGNvbnMuX2VkaXRvckFyZWEsXHJcbiAgICAgICAgICAgIHd5c2l3eWc6IGNvbnMuX3d5c2l3eWdBcmVhLFxyXG4gICAgICAgICAgICBjb2RlOiBjb25zLl9jb2RlQXJlYSxcclxuICAgICAgICAgICAgbG9hZGluZzogY29ucy5fbG9hZGluZyxcclxuICAgICAgICAgICAgcmVzaXplQmFja2dyb3VuZDogY29ucy5fcmVzaXplQmFjayxcclxuICAgICAgICAgICAgX3N0aWNreUR1bW15OiBjb25zLl9zdGlja3lEdW1teSxcclxuICAgICAgICAgICAgX2Fycm93OiBjb25zLl9hcnJvd1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9vbDoge1xyXG4gICAgICAgICAgICBjb3ZlcjogY29ucy5fdG9vbEJhci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzdW4tZWRpdG9yLWlkLXRvb2xiYXItY292ZXInKVswXSxcclxuICAgICAgICAgICAgYm9sZDogY29ucy5fdG9vbEJhci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzdW4tZWRpdG9yLWlkLWJvbGQnKVswXSxcclxuICAgICAgICAgICAgdW5kZXJsaW5lOiBjb25zLl90b29sQmFyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3N1bi1lZGl0b3ItaWQtdW5kZXJsaW5lJylbMF0sXHJcbiAgICAgICAgICAgIGl0YWxpYzogY29ucy5fdG9vbEJhci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzdW4tZWRpdG9yLWlkLWl0YWxpYycpWzBdLFxyXG4gICAgICAgICAgICBzdHJpa2U6IGNvbnMuX3Rvb2xCYXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc3VuLWVkaXRvci1pZC1zdHJpa2UnKVswXSxcclxuICAgICAgICAgICAgc3Vic2NyaXB0OiBjb25zLl90b29sQmFyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3N1bi1lZGl0b3ItaWQtc3Vic2NyaXB0JylbMF0sXHJcbiAgICAgICAgICAgIHN1cGVyc2NyaXB0OiBjb25zLl90b29sQmFyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3N1bi1lZGl0b3ItaWQtc3VwZXJzY3JpcHQnKVswXSxcclxuICAgICAgICAgICAgZm9udDogY29ucy5fdG9vbEJhci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzdW4tZWRpdG9yLWZvbnQtZmFtaWx5JylbMF0sXHJcbiAgICAgICAgICAgIGZvcm1hdDogY29ucy5fdG9vbEJhci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzdW4tZWRpdG9yLWZvbnQtZm9ybWF0JylbMF0sXHJcbiAgICAgICAgICAgIGZvbnRTaXplOiBjb25zLl90b29sQmFyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3N1bi1lZGl0b3ItZm9udC1zaXplJylbMF1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG9wdGlvbjoge1xyXG4gICAgICAgICAgICBtb2RlOiBvcHRpb25zLm1vZGUsXHJcbiAgICAgICAgICAgIHRvb2xiYXJXaWR0aDogb3B0aW9ucy50b29sYmFyV2lkdGgsXHJcbiAgICAgICAgICAgIHN0aWNreVRvb2xiYXI6IG9wdGlvbnMuc3RpY2t5VG9vbGJhcixcclxuICAgICAgICAgICAgcmVzaXppbmdCYXI6IG9wdGlvbnMucmVzaXppbmdCYXIsXHJcbiAgICAgICAgICAgIHNob3dQYXRoTGFiZWw6IG9wdGlvbnMuc2hvd1BhdGhMYWJlbCxcclxuICAgICAgICAgICAgcG9wdXBEaXNwbGF5OiBvcHRpb25zLnBvcHVwRGlzcGxheSxcclxuICAgICAgICAgICAgZGlzcGxheTogb3B0aW9ucy5kaXNwbGF5LFxyXG4gICAgICAgICAgICBoZWlnaHQ6IG9wdGlvbnMuaGVpZ2h0LFxyXG4gICAgICAgICAgICBtaW5IZWlnaHQ6IG9wdGlvbnMubWluSGVpZ2h0LFxyXG4gICAgICAgICAgICBtYXhIZWlnaHQ6IG9wdGlvbnMubWF4SGVpZ2h0LFxyXG4gICAgICAgICAgICBmb250OiBvcHRpb25zLmZvbnQsXHJcbiAgICAgICAgICAgIGZvbnRTaXplOiBvcHRpb25zLmZvbnRTaXplLFxyXG4gICAgICAgICAgICBjb2xvckxpc3Q6IG9wdGlvbnMuY29sb3JMaXN0LFxyXG4gICAgICAgICAgICBpbWFnZVJlc2l6aW5nOiBvcHRpb25zLmltYWdlUmVzaXppbmcsXHJcbiAgICAgICAgICAgIGltYWdlV2lkdGg6IG9wdGlvbnMuaW1hZ2VXaWR0aCxcclxuICAgICAgICAgICAgaW1hZ2VGaWxlSW5wdXQ6IG9wdGlvbnMuaW1hZ2VGaWxlSW5wdXQsXHJcbiAgICAgICAgICAgIGltYWdlVXJsSW5wdXQ6IG9wdGlvbnMuaW1hZ2VVcmxJbnB1dCxcclxuICAgICAgICAgICAgaW1hZ2VVcGxvYWRVcmw6IG9wdGlvbnMuaW1hZ2VVcGxvYWRVcmwsXHJcbiAgICAgICAgICAgIHZpZGVvUmVzaXppbmc6IG9wdGlvbnMudmlkZW9SZXNpemluZyxcclxuICAgICAgICAgICAgdmlkZW9XaWR0aDogb3B0aW9ucy52aWRlb1dpZHRoLFxyXG4gICAgICAgICAgICB2aWRlb0hlaWdodDogb3B0aW9ucy52aWRlb0hlaWdodCxcclxuICAgICAgICAgICAgeW91dHViZVF1ZXJ5OiBvcHRpb25zLnlvdXR1YmVRdWVyeS5yZXBsYWNlKCc/JywgJycpLFxyXG4gICAgICAgICAgICBjYWxsQmFja1NhdmU6IG9wdGlvbnMuY2FsbEJhY2tTYXZlXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IF9Db250ZXh0OyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTs7Ozs7OztBQU9BO0FBRUE7Ozs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2QkE7QUE1QkE7QUFzREE7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/lib/context.js\n");

/***/ }),

/***/ "./src/lib/core.js":
/*!*************************!*\
  !*** ./src/lib/core.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./util */ \"./src/lib/util.js\");\n/* harmony import */ var _plugins_modules_notice__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../plugins/modules/notice */ \"./src/plugins/modules/notice.js\");\n/*\r\n * wysiwyg web editor\r\n *\r\n * suneditor.js\r\n * Copyright 2017 JiHong Lee.\r\n * MIT license.\r\n */\n\n\n\n\n/**\r\n * @description SunEditor core function\r\n * @param context\r\n * @param plugins\r\n * @param lang\r\n * @returns {Object} UserFunction Object\r\n */\n\nconst core = function (context, plugins, lang) {\n  const _d = document;\n  const _w = window;\n  /**\r\n   * @description editor core object\r\n   * should always bind this object when registering an event in the plug-in.\r\n   */\n\n  const editor = {\n    /**\r\n     * @description Elements and user options parameters of the suneditor\r\n     */\n    context: context,\n\n    /**\r\n     * @description loaded plugins\r\n     */\n    plugins: {},\n\n    /**\r\n     * @description Whether the plugin is initialized\r\n     */\n    initPlugins: {},\n\n    /**\r\n     * @description loaded language\r\n     */\n    lang: lang,\n\n    /**\r\n     * @description dialog element\r\n     */\n    dialogForm: null,\n\n    /**\r\n     * @description current subment name\r\n     * @private\r\n     */\n    _submenuName: '',\n\n    /**\r\n     * @description submenu element\r\n     */\n    submenu: null,\n\n    /**\r\n     * @description binded submenuOff method\r\n     * @private\r\n     */\n    _bindedSubmenuOff: null,\n\n    /**\r\n     * @description active button element in submenu\r\n     */\n    submenuActiveButton: null,\n\n    /**\r\n     * @description The elements array to be processed unvisible when the controllersOff function is executed (resizing, link modified button, table controller)\r\n     */\n    controllerArray: [],\n\n    /**\r\n     * @description binded controllersOff method\r\n     * @private\r\n     */\n    _bindControllersOff: null,\n\n    /**\r\n     * @description An array of buttons whose class name is not \"code-view-enabled\"\r\n     */\n    codeViewDisabledButtons: context.element.toolbar.querySelectorAll('.sun-editor-id-toolbar button:not([class~=\"code-view-enabled\"])'),\n\n    /**\r\n     * @description Is inline mode?\r\n     * @private\r\n     */\n    _isInline: /inline/i.test(context.option.mode),\n\n    /**\r\n     * @description Is balloon mode?\r\n     * @private\r\n     */\n    _isBalloon: /balloon/i.test(context.option.mode),\n\n    /**\r\n     * @description Required value when using inline mode to sticky toolbar\r\n     * @private\r\n     */\n    _inlineToolbarAttr: {\n      width: 0,\n      height: 0,\n      isShow: false\n    },\n\n    /**\r\n     * @description An user event function when image uploaded success or remove image\r\n     * @private\r\n     */\n    _imageUpload: function (targetImgElement, index, isDelete, imageInfo) {\n      if (typeof userFunction.onImageUpload === 'function') userFunction.onImageUpload(targetImgElement, index * 1, isDelete, imageInfo);\n    },\n\n    /**\r\n     * @description An user event function when image upload failed\r\n     * @private\r\n     */\n    _imageUploadError: function (errorMessage, result) {\n      if (typeof userFunction.onImageUploadError === 'function') return userFunction.onImageUploadError(errorMessage, result);\n      return true;\n    },\n\n    /**\r\n     * @description Elements that need to change text or className for each selection change\r\n     * @property {Element} FORMAT - format button\r\n     * @property {Element} FONT - font family button\r\n     * @property {Element} SIZE - font size button\r\n     * @property {Element} B - bold button\r\n     * @property {Element} U - underline button\r\n     * @property {Element} I - italic button\r\n     * @property {Element} STRIKE - strike button\r\n     * @property {Element} SUB - subscript button\r\n     * @property {Element} SUP - superscript button\r\n     */\n    commandMap: {\n      FORMAT: context.tool.format,\n      FONT: context.tool.font,\n      SIZE: context.tool.fontSize,\n      B: context.tool.bold,\n      U: context.tool.underline,\n      I: context.tool.italic,\n      STRIKE: context.tool.strike,\n      SUB: context.tool.subscript,\n      SUP: context.tool.superscript\n    },\n\n    /**\r\n     * @description Variables used internally in editor operation\r\n     * @property {Boolean} wysiwygActive - The wysiwyg frame or code view state\r\n     * @property {Boolean} isFullScreen - State of full screen\r\n     * @property {Number} innerHeight_fullScreen - InnerHeight in editor when in full screen\r\n     * @property {Number} resizeClientY - Remember the vertical size of the editor before resizing the editor (Used when calculating during resize operation)\r\n     * @property {Number} tabSize - Indented size when tab button clicked (4)\r\n     * @property {Number} minResizingSize - Minimum size of editing area when resized (65)\r\n     * @property {Array} currentNodes -  An array of the current cursor's node structure\r\n     * @private\r\n     */\n    _variable: {\n      wysiwygActive: true,\n      isFullScreen: false,\n      innerHeight_fullScreen: 0,\n      resizeClientY: 0,\n      tabSize: 4,\n      minResizingSize: 65,\n      currentNodes: [],\n      _range: null,\n      _selectionNode: null,\n      _originCssText: context.element.topArea.style.cssText,\n      _bodyOverflow: '',\n      _editorAreaOriginCssText: '',\n      _wysiwygOriginCssText: '',\n      _codeOriginCssText: '',\n      _sticky: false,\n      _imagesInfo: [],\n      _imageIndex: 0\n    },\n\n    /**\r\n     * @description If the plugin is not added, add the plugin and call the 'add' function.\r\n     * If the plugin is added call callBack function.\r\n     * @param {String} pluginName - The name of the plugin to call\r\n     * @param {function} callBackFunction - Function to be executed immediately after module call\r\n     */\n    callPlugin: function (pluginName, callBackFunction) {\n      if (!this.plugins[pluginName]) {\n        throw Error('[SUNEDITOR.core.callPlugin.fail] The called plugin does not exist or is in an invalid format. (pluginName:\"' + pluginName + '\")');\n      } else if (!this.initPlugins[pluginName]) {\n        this.plugins[pluginName].add(this, this.plugins[pluginName].buttonElement);\n        this.initPlugins[pluginName] = true;\n      }\n\n      callBackFunction();\n    },\n\n    /**\r\n     * @description If the module is not added, add the module and call the 'add' function\r\n     * @param {Array} moduleArray - module object's Array [dialog, resizing]\r\n     */\n    addModule: function (moduleArray) {\n      let moduleName = '';\n\n      for (let i = 0, len = moduleArray.length; i < len; i++) {\n        moduleName = moduleArray[i].name;\n\n        if (!this.plugins[moduleName]) {\n          this.plugins[moduleName] = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].copyObj(moduleArray[i]);\n          this.plugins[moduleName].add(this);\n        }\n      }\n    },\n\n    /**\r\n     * @description Enabled submenu\r\n     * @param {Element} element - Submenu element to call\r\n     */\n    submenuOn: function (element) {\n      const submenuName = this._submenuName = element.getAttribute('data-command');\n      if (this.plugins[submenuName].on) this.plugins[submenuName].on.call(this);\n      this.submenu = element.nextElementSibling;\n      this.submenu.style.display = 'block';\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(element, 'on');\n      this.submenuActiveButton = element;\n      const overLeft = this.context.element.toolbar.offsetWidth - (element.parentElement.offsetLeft + this.submenu.offsetWidth);\n      if (overLeft < 0) this.submenu.style.left = overLeft + 'px';else this.submenu.style.left = '1px';\n      this._bindedSubmenuOff = this.submenuOff.bind(this);\n\n      _d.addEventListener('mousedown', this._bindedSubmenuOff, false);\n    },\n\n    /**\r\n     * @description Disable submenu\r\n     */\n    submenuOff: function () {\n      if (this.submenu) {\n        this._submenuName = '';\n        this.submenu.style.display = 'none';\n        this.submenu = null;\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(this.submenuActiveButton, 'on');\n        this.submenuActiveButton = null;\n\n        _d.removeEventListener('mousedown', this._bindedSubmenuOff);\n      }\n\n      this.controllersOff();\n    },\n\n    /**\r\n     * @description Disable controller in editor area (link button, image resize button)\r\n     */\n    controllersOn: function () {\n      for (let i = 0; i < arguments.length; i++) {\n        arguments[i].style.display = 'block';\n        this.controllerArray[i] = arguments[i];\n      }\n\n      this._bindControllersOff = this.controllersOff.bind(this);\n\n      _d.addEventListener('mousedown', this._bindControllersOff, false);\n    },\n\n    /**\r\n     * @description Disable controller in editor area (link button, image resize button)\r\n     */\n    controllersOff: function () {\n      const len = this.controllerArray.length;\n\n      if (len > 0) {\n        for (let i = 0; i < len; i++) {\n          this.controllerArray[i].style.display = 'none';\n        }\n\n        this.controllerArray = [];\n\n        _d.removeEventListener('mousedown', this._bindControllersOff);\n      }\n    },\n\n    /**\r\n     * @description javascript execCommand\r\n     * @param {String} command - javascript execCommand function property\r\n     * @param {Boolean} showDefaultUI - javascript execCommand function property\r\n     * @param {String} value - javascript execCommand function property\r\n     */\n    execCommand: function (command, showDefaultUI, value) {\n      _d.execCommand(command, showDefaultUI, command === 'formatBlock' ? '<' + value + '>' : value);\n    },\n\n    /**\r\n     * @description Focus to wysiwyg area\r\n     */\n    focus: function () {\n      if (context.element.wysiwyg.style.display === 'none') return;\n      const caption = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getParentElement(this.getSelectionNode(), 'figcaption');\n\n      if (caption) {\n        caption.focus();\n      } else {\n        context.element.wysiwyg.focus();\n      }\n\n      event._findButtonEffectTag();\n    },\n\n    /**\r\n     * @description Set current editor's range object\r\n     * @param {Element} startCon - The startContainer property of the selection object.\r\n     * @param {Number} startOff - The startOffset property of the selection object.\r\n     * @param {Element} endCon - The endContainer property of the selection object.\r\n     * @param {Element} endOff - The endOffset property of the selection object.\r\n     */\n    setRange: function (startCon, startOff, endCon, endOff) {\n      const range = _d.createRange();\n\n      range.setStart(startCon, startOff);\n      range.setEnd(endCon, endOff);\n\n      const selection = _w.getSelection();\n\n      if (selection.removeAllRanges) {\n        selection.removeAllRanges();\n      }\n\n      selection.addRange(range);\n\n      this._editorRange();\n    },\n\n    /**\r\n     * @description Get current editor's range object\r\n     * @returns {Object}\r\n     */\n    getRange: function () {\n      return this._variable._range || this._createDefaultRange();\n    },\n\n    /**\r\n     * @description Get current select node\r\n     * @returns {Node}\r\n     */\n    getSelectionNode: function () {\n      return this._variable._selectionNode || context.element.wysiwyg.firstChild;\n    },\n\n    /**\r\n     * @description Saving the range object and the currently selected node of editor\r\n     * @private\r\n     */\n    _editorRange: function () {\n      const selection = _w.getSelection();\n\n      if (!_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getParentElement(selection.focusNode, '.sun-editor-id-wysiwyg')) return;\n      let range = null;\n      let selectionNode = null;\n\n      if (selection.rangeCount > 0) {\n        range = selection.getRangeAt(0);\n      } else {\n        range = this._createDefaultRange();\n      }\n\n      this._variable._range = range;\n\n      if (range.collapsed) {\n        selectionNode = range.commonAncestorContainer;\n      } else {\n        selectionNode = selection.extentNode || selection.anchorNode;\n      }\n\n      this._variable._selectionNode = selectionNode;\n    },\n\n    /**\r\n     * @description Return the range object of editor's first child node\r\n     * @returns {Object}\r\n     * @private\r\n     */\n    _createDefaultRange: function () {\n      const range = _d.createRange();\n\n      range.setStart(context.element.wysiwyg.firstChild, 0);\n      range.setEnd(context.element.wysiwyg.firstChild, 0);\n      return range;\n    },\n\n    /**\r\n     * @description Returns a \"formatElement\"(P, DIV, H[1-6], LI) array from the currently selected range.\r\n     * @returns {Array}\r\n     */\n    getSelectedFormatElements: function () {\n      let range = this.getRange();\n\n      if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(range.startContainer)) {\n        const children = context.element.wysiwyg.children;\n        this.setRange(children[0], 0, children[children.length - 1], children[children.length - 1].textContent.length);\n        range = this.getRange();\n      }\n\n      const startCon = range.startContainer;\n      const endCon = range.endContainer;\n      const commonCon = range.commonAncestorContainer;\n      const rangeFormatElements = [];\n      if (!_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(commonCon) && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(commonCon)) return [_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(commonCon)]; // get line nodes\n\n      const lineNodes = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getListChildren(commonCon, function (current) {\n        return _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isFormatElement(current);\n      });\n      if (startCon === endCon) return lineNodes[0];\n      let startLine = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(startCon);\n      let endLine = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(endCon);\n      let startIdx = 0;\n      let endIdx = 0;\n\n      for (let i = 0, len = lineNodes.length; i < len; i++) {\n        if (startLine === lineNodes[i]) {\n          startIdx = i;\n          continue;\n        }\n\n        if (endLine === lineNodes[i]) {\n          endIdx = i;\n          break;\n        }\n      }\n\n      for (let i = startIdx; i <= endIdx; i++) {\n        rangeFormatElements.push(lineNodes[i]);\n      }\n\n      return rangeFormatElements;\n    },\n\n    /**\r\n     * @description Returns a \"rangeFormatElement\"(blockquote, TABLE, TR, TD, OL, UL, PRE) array from the currently selected range.\r\n     * @returns {Array}\r\n     */\n    getSelectedRangeFormatElements: function () {\n      let range = this.getRange();\n\n      if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(range.startContainer)) {\n        const children = context.element.wysiwyg.children;\n        this.setRange(children[0], 0, children[children.length - 1], children[children.length - 1].textContent.length);\n        range = this.getRange();\n      }\n\n      const startCon = range.startContainer;\n      const endCon = range.endContainer;\n      const commonCon = range.commonAncestorContainer;\n      const rangeFormatElements = [];\n      if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(commonCon)) return [commonCon];\n\n      if (!_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(commonCon)) {\n        const el = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getRangeFormatElement(commonCon);\n        return el ? [el] : [];\n      } // get range Elements\n\n\n      const rangeElements = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getListChildren(commonCon, function (current) {\n        return _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(current);\n      });\n      if (startCon === endCon) return rangeElements[0];\n      let startLine = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getRangeFormatElement(startCon);\n      let endLine = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getRangeFormatElement(endCon);\n      let startIdx = 0;\n      let endIdx = 0;\n\n      for (let i = 0, len = rangeElements.length; i < len; i++) {\n        if (startLine === rangeElements[i]) {\n          startIdx = i;\n          continue;\n        }\n\n        if (endLine === rangeElements[i]) {\n          endIdx = i;\n          break;\n        }\n      }\n\n      for (let i = startIdx; i <= endIdx; i++) {\n        if (rangeElements[i]) rangeFormatElements.push(rangeElements[i]);\n      }\n\n      return rangeFormatElements;\n    },\n\n    /**\r\n     * @description Determine if this offset is the edge offset of container\r\n     * @param {Object} container - The container property of the selection object.\r\n     * @param {Number} offset - The offset property of the selection object.\r\n     * @returns {Boolean}\r\n     */\n    isEdgePoint: function (container, offset) {\n      return offset === 0 || offset === container.nodeValue.length;\n    },\n\n    /**\r\n     * @description Show loading box\r\n     */\n    showLoading: function () {\n      context.element.loading.style.display = 'block';\n    },\n\n    /**\r\n     * @description Close loading box\r\n     */\n    closeLoading: function () {\n      context.element.loading.style.display = 'none';\n    },\n\n    /**\r\n     * @description Append format element to sibling node of argument element.\r\n     * If the \"formatNodeName\" argument value is present, the tag of that argument value is inserted,\r\n     * If not, the currently selected format tag is inserted.\r\n     * @param {Element} element - Insert as siblings of that element\r\n     * @param {String|null} formatNodeName - Node name to be inserted\r\n     * @returns {Element}\r\n     */\n    appendFormatTag: function (element, formatNodeName) {\n      const formatEl = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getRangeFormatElement(element) || _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(element);\n      const currentFormatEl = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(this.getSelectionNode());\n      const oFormatName = formatNodeName ? formatNodeName : _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isFormatElement(currentFormatEl) ? currentFormatEl.nodeName : 'P';\n      const oFormat = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement(oFormatName);\n      oFormat.innerHTML = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace;\n      if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isCell(formatEl)) formatEl.insertBefore(oFormat, element.nextElementSibling);else formatEl.parentNode.insertBefore(oFormat, formatEl.nextElementSibling);\n      return oFormat;\n    },\n\n    /**\r\n     * @description Delete selected node and insert argument value node\r\n     * @param {Element} oNode - Node to be inserted\r\n     * @param {(Element|null)} rightNode - If the node exists, it is inserted after the node\r\n     */\n    insertNode: function (oNode, rightNode) {\n      const range = this.getRange();\n      let parentNode = null;\n\n      if (!rightNode) {\n        const startCon = range.startContainer;\n        const startOff = range.startOffset;\n        const endCon = range.endContainer;\n        const endOff = range.endOffset;\n        const commonCon = range.commonAncestorContainer;\n        parentNode = startCon;\n\n        if (startCon.nodeType === 3) {\n          parentNode = startCon.parentNode;\n        }\n        /** No Select range node */\n\n\n        if (range.collapsed) {\n          if (commonCon.nodeType === 3) {\n            rightNode = commonCon.splitText(endOff);\n          } else {\n            if (parentNode.lastChild !== null && _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(parentNode.lastChild)) {\n              parentNode.removeChild(parentNode.lastChild);\n            }\n\n            rightNode = null;\n          }\n        }\n        /** Select range nodes */\n        else {\n            const isSameContainer = startCon === endCon;\n\n            if (isSameContainer) {\n              if (this.isEdgePoint(endCon, endOff)) rightNode = endCon.nextSibling;else rightNode = endCon.splitText(endOff);\n              let removeNode = startCon;\n              if (!this.isEdgePoint(startCon, startOff)) removeNode = startCon.splitText(startOff);\n              parentNode.removeChild(removeNode);\n            } else {\n              this.removeNode();\n              parentNode = commonCon;\n              rightNode = endCon;\n\n              while (rightNode.parentNode !== commonCon) {\n                rightNode = rightNode.parentNode;\n              }\n            }\n          }\n      } else {\n        parentNode = rightNode.parentNode;\n        rightNode = rightNode.nextSibling;\n      }\n\n      try {\n        parentNode.insertBefore(oNode, rightNode);\n      } catch (e) {\n        parentNode.appendChild(oNode);\n      }\n    },\n\n    /**\r\n     * @description Delete the currently selected node\r\n     */\n    removeNode: function () {\n      const range = this.getRange();\n\n      if (range.deleteContents) {\n        range.deleteContents();\n        return;\n      }\n\n      const startCon = range.startContainer;\n      const startOff = range.startOffset;\n      const endCon = range.endContainer;\n      const endOff = range.endOffset;\n      const commonCon = range.commonAncestorContainer;\n      let beforeNode = null;\n      let afterNode = null;\n      const childNodes = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getListChildNodes(commonCon);\n      let startIndex = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getArrayIndex(childNodes, startCon);\n      let endIndex = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getArrayIndex(childNodes, endCon);\n\n      for (let i = startIndex + 1, startNode = startCon; i >= 0; i--) {\n        if (childNodes[i] === startNode.parentNode && childNodes[i].firstChild === startNode && startOff === 0) {\n          startIndex = i;\n          startNode = startNode.parentNode;\n        }\n      }\n\n      for (let i = endIndex - 1, endNode = endCon; i > startIndex; i--) {\n        if (childNodes[i] === endNode.parentNode && childNodes[i].nodeType === 1) {\n          childNodes.splice(i, 1);\n          endNode = endNode.parentNode;\n          --endIndex;\n        }\n      }\n\n      for (let i = startIndex; i <= endIndex; i++) {\n        const item = childNodes[i];\n\n        if (item.length === 0 || item.nodeType === 3 && item.data === undefined) {\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(item);\n          continue;\n        }\n\n        if (item === startCon) {\n          if (startCon.nodeType === 1) {\n            beforeNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(startCon.textContent);\n          } else {\n            beforeNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(startCon.substringData(0, startOff));\n          }\n\n          if (beforeNode.length > 0) {\n            startCon.data = beforeNode.data;\n          } else {\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(startCon);\n          }\n\n          continue;\n        }\n\n        if (item === endCon) {\n          if (endCon.nodeType === 1) {\n            afterNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(endCon.textContent);\n          } else {\n            afterNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(endCon.substringData(endOff, endCon.length - endOff));\n          }\n\n          if (afterNode.length > 0) {\n            endCon.data = afterNode.data;\n          } else {\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(endCon);\n          }\n\n          continue;\n        }\n\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(item);\n      }\n    },\n\n    /**\r\n     * @description appended all selected format Element to the argument element and insert\r\n     * @param {Element} wrapTag - Element of wrap the arguments\r\n     */\n    wrapToTags: function (wrapTag) {\n      const range = this.getRange();\n      const rangeLines = this.getSelectedFormatElements();\n\n      if (!rangeLines) {\n        const inner = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isCell(this.getSelectionNode()) ? 'DIV' : 'P');\n        inner.innerHTML = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace;\n        wrapTag.appendChild(inner);\n        this.getSelectionNode().appendChild(wrapTag);\n        return;\n      }\n\n      let last = rangeLines[rangeLines.length - 1];\n      let standTag, beforeTag, pElement;\n\n      if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(last) || _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isFormatElement(last)) {\n        standTag = last;\n      } else {\n        standTag = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getRangeFormatElement(last) || _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(last);\n      }\n\n      if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isCell(standTag)) {\n        beforeTag = null;\n        pElement = standTag;\n      } else {\n        beforeTag = standTag.nextSibling;\n        pElement = standTag.parentNode;\n      }\n\n      let listParent = null;\n      let line = null;\n      let prevNodeName = '';\n\n      for (let i = 0, len = rangeLines.length; i < len; i++) {\n        line = rangeLines[i];\n\n        if (/^LI$/i.test(line.nodeName)) {\n          if (listParent === null || !/^LI$/i.test(prevNodeName)) {\n            listParent = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement(line.parentNode.nodeName);\n          }\n\n          listParent.appendChild(line);\n          if (i === len - 1 || !/^LI$/i.test(rangeLines[i + 1].nodeName)) wrapTag.appendChild(listParent);\n        } else {\n          wrapTag.appendChild(line);\n        }\n\n        prevNodeName = line.nodeName;\n      }\n\n      pElement.insertBefore(wrapTag, beforeTag);\n      if (!range.collapsed && (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(range.startContainer) || _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(range.endContainer))) _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeEmptyNode(pElement);\n    },\n\n    /**\r\n     * @description Add the node received as an argument value to the selected area.\r\n     * 1. When there is the same css value node in the selection area, the tag is stripped.\r\n     * 2. If there is another css value other thanCss attribute values received as arguments on the node, removed only Css attribute values received as arguments\r\n     * 3. If you pass an element whose node name is \"removenode\" as an argument value, it performs a type removal operation. ex) nodeChange(document.createElement('removenode'))\r\n     * @param {Element} appendNode - The dom that will wrap the selected text area\r\n     * @param {Array} checkCSSPropertyArray - The css attribute name Array to check (['font-size'], ['font-family', 'background-color', 'border']...])\r\n     */\n    nodeChange: function (appendNode, checkCSSPropertyArray) {\n      const range = this.getRange();\n      const isRemoveFormat = /removenode/i.test(appendNode.nodeName);\n      let tempCon, tempOffset, tempChild, tempArray;\n      /* checked same style property */\n\n      if (range.startContainer === range.endContainer) {\n        let sNode = range.startContainer;\n\n        if (isRemoveFormat) {\n          if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(sNode) === sNode.parentNode) return;\n        } else {\n          let checkCnt = 0;\n\n          for (let i = 0; i < checkCSSPropertyArray.length; i++) {\n            while (!_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isFormatElement(sNode) && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(sNode)) {\n              if (sNode.nodeType === 1 && sNode.style[checkCSSPropertyArray[i]] === appendNode.style[checkCSSPropertyArray[i]]) {\n                checkCnt++;\n              }\n\n              sNode = sNode.parentNode;\n            }\n          }\n\n          if (checkCnt >= checkCSSPropertyArray.length) return;\n        }\n      }\n      /* find text node */\n      // startContainer\n\n\n      tempCon = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(range.startContainer) ? context.element.wysiwyg.firstChild : range.startContainer;\n      tempOffset = range.startOffset;\n\n      if (tempCon.nodeType === 1 && tempCon.childNodes.length > 0) {\n        while (tempCon && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(tempCon) && tempCon.nodeType === 1) {\n          tempArray = [];\n          tempChild = tempCon.childNodes;\n\n          for (let i = 0, len = tempChild.length; i < len; i++) {\n            tempArray.push(tempChild[i]);\n          }\n\n          tempCon = tempArray[tempOffset] || tempCon.nextElementSibling || tempCon.nextSibling;\n          tempOffset = 0;\n        }\n\n        if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(tempCon)) {\n          const emptyText = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace);\n          tempCon.parentNode.insertBefore(emptyText, tempCon);\n          tempCon = emptyText;\n        }\n      }\n\n      const startCon = tempCon;\n      const startOff = tempOffset; // endContainer\n\n      tempCon = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(range.endContainer) ? context.element.wysiwyg.lastChild : range.endContainer;\n      tempOffset = range.endOffset;\n\n      if (tempCon.nodeType === 1 && tempCon.childNodes.length > 0) {\n        while (tempCon && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(tempCon) && tempCon.nodeType === 1) {\n          tempArray = [];\n          tempChild = tempCon.childNodes;\n\n          for (let i = 0, len = tempChild.length; i < len; i++) {\n            tempArray.push(tempChild[i]);\n          }\n\n          tempCon = tempArray[tempOffset - 1] || !/FIGURE/i.test(tempArray[0].nodeName) ? tempArray[0] : tempCon.previousElementSibling || tempCon.previousSibling || startCon;\n        }\n\n        tempOffset = tempCon.textContent.length;\n\n        if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(tempCon)) {\n          const emptyText = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace);\n          tempCon.parentNode.insertBefore(emptyText, tempCon);\n          tempCon = emptyText;\n          tempOffset = 0;\n        }\n      }\n\n      const endCon = tempCon;\n      const endOff = tempOffset;\n      const commonCon = range.commonAncestorContainer;\n      const newNodeName = appendNode.nodeName;\n      this.setRange(startCon, startOff, endCon, endOff);\n      let start = {},\n          end = {};\n      let newNode, regExp;\n\n      if (checkCSSPropertyArray) {\n        regExp = '(?:;|^|\\\\s)(?:' + checkCSSPropertyArray[0];\n\n        for (let i = 1; i < checkCSSPropertyArray.length; i++) {\n          regExp += '|' + checkCSSPropertyArray[i];\n        }\n\n        regExp += ')\\\\s*:[^;]*\\\\s*(?:;|$)';\n        regExp = new RegExp(regExp, 'ig');\n      }\n      /** tag check function*/\n\n\n      const checkCss = function (vNode) {\n        if (isRemoveFormat || vNode.nodeType === 3 || _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(vNode)) return true;\n        let style = '';\n\n        if (regExp && vNode.style.cssText.length > 0) {\n          style = vNode.style.cssText.replace(regExp, '').trim();\n        }\n\n        if (style.length > 0 || vNode.nodeName !== newNodeName) {\n          if (vNode.style.cssText.length > 0) vNode.style.cssText = style;\n          return true;\n        }\n\n        return false;\n      };\n      /** one line */\n\n\n      if (!_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(commonCon) && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(commonCon)) {\n        newNode = appendNode.cloneNode(false);\n\n        const newRange = this._nodeChange_oneLine(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(commonCon), newNode, checkCss, startCon, startOff, endCon, endOff, isRemoveFormat, range.collapsed);\n\n        start.container = newRange.startContainer;\n        start.offset = newRange.startOffset;\n        end.container = newRange.endContainer;\n        end.offset = newRange.endOffset;\n      }\n      /** multi line */\n      else {\n          // get line nodes\n          const lineNodes = this.getSelectedFormatElements();\n          const endLength = lineNodes.length - 1; // startCon\n\n          newNode = appendNode.cloneNode(false);\n          start = this._nodeChange_startLine(lineNodes[0], newNode, checkCss, startCon, startOff, isRemoveFormat); // mid\n\n          for (let i = 1; i < endLength; i++) {\n            newNode = appendNode.cloneNode(false);\n\n            this._nodeChange_middleLine(lineNodes[i], newNode, checkCss, isRemoveFormat);\n          } // endCon\n\n\n          if (endLength > 0) {\n            newNode = appendNode.cloneNode(false);\n            end = this._nodeChange_endLine(lineNodes[endLength], newNode, checkCss, endCon, endOff, isRemoveFormat);\n          } else {\n            end = start;\n          }\n        } // set range\n\n\n      this.setRange(start.container, start.offset, end.container, end.offset);\n    },\n\n    /**\r\n     * @description wraps text nodes of line selected text.\r\n     * @param {Element} element - The node of the line that contains the selected text node.\r\n     * @param {Element} newInnerNode - The dom that will wrap the selected text area\r\n     * @param {function} validation - Check if the node should be stripped.\r\n     * @param {Element} startCon - The startContainer property of the selection object.\r\n     * @param {Number} startOff - The startOffset property of the selection object.\r\n     * @param {Element} endCon - The endContainer property of the selection object.\r\n     * @param {Number} endOff - The endOffset property of the selection object.\r\n     * @param {Boolean} isRemoveFormat - Is the remove format command ?\r\n     * @param {Boolean} collapsed - range.collapsed\r\n     * @returns {{startContainer: *, startOffset: *, endContainer: *, endOffset: *}}\r\n     * @private\r\n     */\n    _nodeChange_oneLine: function (element, newInnerNode, validation, startCon, startOff, endCon, endOff, isRemoveFormat, collapsed) {\n      const el = element;\n      const pNode = element.cloneNode(false);\n      const isSameNode = startCon === endCon;\n      let startContainer = startCon;\n      let startOffset = startOff;\n      let endContainer = endCon;\n      let endOffset = endOff;\n      let startPass = false;\n      let endPass = false;\n      let pCurrent, newNode, appendNode, cssText;\n\n      function checkCss(vNode) {\n        const regExp = new RegExp('(?:;|^|\\\\s)(?:' + cssText + 'null)\\\\s*:[^;]*\\\\s*(?:;|$)', 'ig');\n        let style = '';\n\n        if (regExp && vNode.style.cssText.length > 0) {\n          style = regExp.test(vNode.style.cssText);\n        }\n\n        return !style;\n      }\n\n      (function recursionFunc(current, node) {\n        const childNodes = current.childNodes;\n\n        for (let i = 0, len = childNodes.length; i < len; i++) {\n          let child = childNodes[i];\n          let coverNode = node;\n          let cloneNode; // startContainer\n\n          if (!startPass && child === startContainer) {\n            const prevNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(startContainer.nodeType === 1 ? '' : startContainer.substringData(0, startOffset));\n            const textNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(startContainer.nodeType === 1 ? '' : startContainer.substringData(startOffset, endOffset > startOffset ? endOffset - startOffset : endOffset === startOffset ? 0 : startContainer.data.length - startOffset));\n\n            if (prevNode.data.length > 0) {\n              node.appendChild(prevNode);\n            }\n\n            newNode = child;\n            pCurrent = [];\n            cssText = '';\n\n            while (newNode !== pNode && newNode !== el && newNode !== null) {\n              if (validation(newNode) && newNode.nodeType === 1 && checkCss(newNode)) {\n                pCurrent.push(newNode.cloneNode(false));\n                cssText += newNode.style.cssText.substr(0, newNode.style.cssText.indexOf(':')) + '|';\n              }\n\n              newNode = newNode.parentNode;\n            }\n\n            const childNode = pCurrent.pop() || textNode;\n            appendNode = newNode = childNode;\n\n            while (pCurrent.length > 0) {\n              newNode = pCurrent.pop();\n              appendNode.appendChild(newNode);\n              appendNode = newNode;\n            }\n\n            newInnerNode.appendChild(childNode);\n            pNode.appendChild(newInnerNode);\n            startContainer = textNode;\n            startOffset = 0;\n            startPass = true;\n            if (newNode !== textNode) newNode.appendChild(startContainer);\n            if (!isSameNode) continue;\n          } // endContainer\n\n\n          if (!endPass && child === endContainer) {\n            const afterNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(endContainer.nodeType === 1 ? '' : endContainer.substringData(endOffset, endContainer.length - endOffset));\n            const textNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(isSameNode || endContainer.nodeType === 1 ? '' : endContainer.substringData(0, endOffset));\n\n            if (afterNode.data.length > 0) {\n              newNode = child;\n              cssText = '';\n              pCurrent = [];\n\n              while (newNode !== pNode && newNode !== el && newNode !== null) {\n                if (newNode.nodeType === 1 && checkCss(newNode)) {\n                  pCurrent.push(newNode.cloneNode(false));\n                  cssText += newNode.style.cssText.substr(0, newNode.style.cssText.indexOf(':')) + '|';\n                }\n\n                newNode = newNode.parentNode;\n              }\n\n              cloneNode = appendNode = newNode = pCurrent.pop() || afterNode;\n\n              while (pCurrent.length > 0) {\n                newNode = pCurrent.pop();\n                appendNode.appendChild(newNode);\n                appendNode = newNode;\n              }\n\n              pNode.appendChild(cloneNode);\n              newNode.textContent = afterNode.data;\n            }\n\n            newNode = child;\n            pCurrent = [];\n            cssText = '';\n\n            while (newNode !== pNode && newNode !== el && newNode !== null) {\n              if (validation(newNode) && newNode.nodeType === 1 && checkCss(newNode)) {\n                pCurrent.push(newNode.cloneNode(false));\n                cssText += newNode.style.cssText.substr(0, newNode.style.cssText.indexOf(':')) + '|';\n              }\n\n              newNode = newNode.parentNode;\n            }\n\n            const childNode = pCurrent.pop() || textNode;\n            appendNode = newNode = childNode;\n\n            while (pCurrent.length > 0) {\n              newNode = pCurrent.pop();\n              appendNode.appendChild(newNode);\n              appendNode = newNode;\n            }\n\n            newInnerNode.appendChild(childNode);\n            endContainer = textNode;\n            endOffset = textNode.data.length;\n            endPass = true;\n\n            if (!isRemoveFormat && collapsed) {\n              newInnerNode = textNode;\n              textNode.textContent = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace;\n            }\n\n            if (newNode !== textNode) newNode.appendChild(endContainer);\n            continue;\n          } // other\n\n\n          if (startPass) {\n            if (child.nodeType === 1 && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) {\n              recursionFunc(child, child);\n              continue;\n            }\n\n            newNode = child;\n            pCurrent = [];\n            cssText = '';\n\n            while (newNode.parentNode !== null && newNode !== el && newNode !== newInnerNode) {\n              if (newNode.nodeType === 1 && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child) && (endPass || validation(newNode)) && checkCss(newNode)) {\n                pCurrent.push(newNode.cloneNode(false));\n                cssText += newNode.style.cssText.substr(0, newNode.style.cssText.indexOf(':')) + '|';\n              }\n\n              newNode = newNode.parentNode;\n            }\n\n            const childNode = pCurrent.pop() || child;\n            appendNode = newNode = childNode;\n\n            while (pCurrent.length > 0) {\n              newNode = pCurrent.pop();\n              appendNode.appendChild(newNode);\n              appendNode = newNode;\n            }\n\n            if (childNode === child) {\n              if (!endPass) node = newInnerNode;else node = pNode;\n            } else if (endPass) {\n              pNode.appendChild(childNode);\n              node = newNode;\n            } else {\n              newInnerNode.appendChild(childNode);\n              node = newNode;\n            }\n          }\n\n          cloneNode = child.cloneNode(false);\n          node.appendChild(cloneNode);\n          if (child.nodeType === 1 && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) coverNode = cloneNode;\n          recursionFunc(child, coverNode);\n        }\n      })(element, pNode);\n\n      if (isRemoveFormat) {\n        startContainer = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(collapsed ? _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace : newInnerNode.textContent);\n        pNode.insertBefore(startContainer, newInnerNode);\n        pNode.removeChild(newInnerNode);\n        if (collapsed) startOffset = 1;\n      } else if (collapsed) {\n        startContainer = endContainer = newInnerNode;\n        startOffset = 1;\n        endOffset = 1;\n      }\n\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeEmptyNode(pNode);\n      element.parentNode.insertBefore(pNode, element);\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(element);\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: isRemoveFormat || !endContainer.textContent ? startContainer : endContainer,\n        endOffset: isRemoveFormat || !endContainer.textContent ? startContainer.textContent.length : endOffset\n      };\n    },\n\n    /**\r\n     * @description wraps mid lines selected text.\r\n     * @param {Element} element - The node of the line that contains the selected text node.\r\n     * @param {Element} newInnerNode - The dom that will wrap the selected text area\r\n     * @param {function} validation - Check if the node should be stripped.\r\n     * @param {Boolean} isRemoveFormat - Is the remove format command ?\r\n     * @private\r\n     */\n    _nodeChange_middleLine: function (element, newInnerNode, validation, isRemoveFormat) {\n      if (isRemoveFormat) {\n        newInnerNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(element.textContent ? element.textContent : _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace);\n      } else {\n        (function recursionFunc(current, node) {\n          const childNodes = current.childNodes;\n\n          for (let i = 0, len = childNodes.length; i < len; i++) {\n            let child = childNodes[i];\n            let coverNode = node;\n\n            if (validation(child)) {\n              let cloneNode = child.cloneNode(false);\n              node.appendChild(cloneNode);\n              if (child.nodeType === 1 && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) coverNode = cloneNode;\n            }\n\n            recursionFunc(child, coverNode);\n          }\n        })(element, newInnerNode);\n      }\n\n      element.innerHTML = '';\n      element.appendChild(newInnerNode);\n    },\n\n    /**\r\n     * @description wraps first line selected text.\r\n     * @param {Element} element - The node of the line that contains the selected text node.\r\n     * @param {Element} newInnerNode - The dom that will wrap the selected text area\r\n     * @param {function} validation - Check if the node should be stripped.\r\n     * @param {Element} startCon - The startContainer property of the selection object.\r\n     * @param {Number} startOff - The startOffset property of the selection object.\r\n     * @param {Boolean} isRemoveFormat - Is the remove format command ?\r\n     * @returns {{container: *, offset: *}}\r\n     * @private\r\n     */\n    _nodeChange_startLine: function (element, newInnerNode, validation, startCon, startOff, isRemoveFormat) {\n      const el = element;\n      const pNode = element.cloneNode(false);\n      let container = startCon;\n      let offset = startOff;\n      let passNode = false;\n      let pCurrent, newNode, appendNode;\n\n      (function recursionFunc(current, node) {\n        const childNodes = current.childNodes;\n\n        for (let i = 0, len = childNodes.length; i < len; i++) {\n          const child = childNodes[i];\n          let coverNode = node;\n\n          if (passNode && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) {\n            if (child.nodeType === 1) {\n              recursionFunc(child, child);\n              continue;\n            }\n\n            newNode = child;\n            pCurrent = [];\n\n            while (newNode.parentNode !== null && newNode !== el && newNode !== newInnerNode) {\n              if (newNode.nodeType === 1 && validation(newNode)) {\n                pCurrent.push(newNode.cloneNode(false));\n              }\n\n              newNode = newNode.parentNode;\n            }\n\n            if (pCurrent.length > 0) {\n              const childNode = pCurrent.pop();\n              appendNode = newNode = childNode;\n\n              while (pCurrent.length > 0) {\n                newNode = pCurrent.pop();\n                appendNode.appendChild(newNode);\n                appendNode = newNode;\n              }\n\n              newInnerNode.appendChild(childNode);\n              node = newNode;\n            } else {\n              node = newInnerNode;\n            }\n          } // startContainer\n\n\n          if (!passNode && child === container) {\n            const prevNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(container.nodeType === 1 ? '' : container.substringData(0, offset));\n            const textNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(container.nodeType === 1 ? '' : container.substringData(offset, container.length - offset));\n\n            if (prevNode.data.length > 0) {\n              node.appendChild(prevNode);\n            }\n\n            newNode = node;\n            pCurrent = [];\n\n            while (newNode !== pNode && newNode !== null) {\n              if (newNode.nodeType === 1 && validation(newNode)) {\n                pCurrent.push(newNode.cloneNode(false));\n              }\n\n              newNode = newNode.parentNode;\n            }\n\n            const childNode = pCurrent.pop() || node;\n            appendNode = newNode = childNode;\n\n            while (pCurrent.length > 0) {\n              newNode = pCurrent.pop();\n              appendNode.appendChild(newNode);\n              appendNode = newNode;\n            }\n\n            if (childNode !== node) {\n              newInnerNode.appendChild(childNode);\n              node = newNode;\n            } else {\n              node = newInnerNode;\n            }\n\n            if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) newInnerNode.appendChild(child.cloneNode(false));\n            pNode.appendChild(newInnerNode);\n            container = textNode;\n            offset = 0;\n            passNode = true;\n            node.appendChild(container);\n            continue;\n          }\n\n          if (!passNode || validation(child)) {\n            const cloneNode = child.cloneNode(false);\n            node.appendChild(cloneNode);\n            if (child.nodeType === 1 && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) coverNode = cloneNode;\n          }\n\n          recursionFunc(child, coverNode);\n        }\n      })(element, pNode);\n\n      if (isRemoveFormat) {\n        container = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(newInnerNode.textContent);\n        pNode.insertBefore(container, newInnerNode);\n        pNode.removeChild(newInnerNode);\n      }\n\n      if (!isRemoveFormat && pNode.children.length === 0) {\n        if (element.childNodes) {\n          container = element.childNodes[0];\n        } else {\n          container = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace);\n          element.appendChild(container);\n        }\n      } else {\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeEmptyNode(pNode);\n        element.parentNode.insertBefore(pNode, element);\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(element);\n      }\n\n      return {\n        container: container,\n        offset: offset\n      };\n    },\n\n    /**\r\n     * @description wraps last line selected text.\r\n     * @param {Element} element - The node of the line that contains the selected text node.\r\n     * @param {Element} newInnerNode - The dom that will wrap the selected text area\r\n     * @param {function} validation - Check if the node should be stripped.\r\n     * @param {Element} endCon - The endContainer property of the selection object.\r\n     * @param {Number} endOff - The endOffset property of the selection object.\r\n     * @param {Boolean} isRemoveFormat - Is the remove format command ?\r\n     * @returns {{container: *, offset: *}}\r\n     * @private\r\n     */\n    _nodeChange_endLine: function (element, newInnerNode, validation, endCon, endOff, isRemoveFormat) {\n      const el = element;\n      const pNode = element.cloneNode(false);\n      let container = endCon;\n      let offset = endOff;\n      let passNode = false;\n      let pCurrent, newNode, appendNode;\n\n      (function recursionFunc(current, node) {\n        const childNodes = current.childNodes;\n\n        for (let i = childNodes.length - 1; 0 <= i; i--) {\n          const child = childNodes[i];\n          let coverNode = node;\n\n          if (passNode && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) {\n            if (child.nodeType === 1) {\n              recursionFunc(child, child);\n              continue;\n            }\n\n            newNode = child;\n            pCurrent = [];\n\n            while (newNode.parentNode !== null && newNode !== el && newNode !== newInnerNode) {\n              if (validation(newNode) && newNode.nodeType === 1) {\n                pCurrent.push(newNode.cloneNode(false));\n              }\n\n              newNode = newNode.parentNode;\n            }\n\n            if (pCurrent.length > 0) {\n              const childNode = pCurrent.pop();\n              appendNode = newNode = childNode;\n\n              while (pCurrent.length > 0) {\n                newNode = pCurrent.pop();\n                appendNode.appendChild(newNode);\n                appendNode = newNode;\n              }\n\n              newInnerNode.insertBefore(childNode, newInnerNode.firstChild);\n              node = newNode;\n            } else {\n              node = newInnerNode;\n            }\n          } // endContainer\n\n\n          if (!passNode && child === container) {\n            const afterNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(container.nodeType === 1 ? '' : container.substringData(offset, container.length - offset));\n            const textNode = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(container.nodeType === 1 ? '' : container.substringData(0, offset));\n\n            if (afterNode.data.length > 0) {\n              node.insertBefore(afterNode, node.firstChild);\n            }\n\n            newNode = node;\n            pCurrent = [];\n\n            while (newNode !== pNode && newNode !== null) {\n              if (validation(newNode) && newNode.nodeType === 1) {\n                pCurrent.push(newNode.cloneNode(false));\n              }\n\n              newNode = newNode.parentNode;\n            }\n\n            const childNode = pCurrent.pop() || node;\n            appendNode = newNode = childNode;\n\n            while (pCurrent.length > 0) {\n              newNode = pCurrent.pop();\n              appendNode.appendChild(newNode);\n              appendNode = newNode;\n            }\n\n            if (childNode !== node) {\n              newInnerNode.insertBefore(childNode, newInnerNode.firstChild);\n              node = newNode;\n            } else {\n              node = newInnerNode;\n            }\n\n            if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) newInnerNode.appendChild(child.cloneNode(false));\n            pNode.insertBefore(newInnerNode, pNode.firstChild);\n            container = textNode;\n            offset = textNode.data.length;\n            passNode = true;\n            node.insertBefore(container, node.firstChild);\n            continue;\n          }\n\n          if (!passNode || validation(child)) {\n            const cloneNode = child.cloneNode(false);\n            node.insertBefore(cloneNode, node.firstChild);\n            if (child.nodeType === 1 && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isBreak(child)) coverNode = cloneNode;\n          }\n\n          recursionFunc(child, coverNode);\n        }\n      })(element, pNode);\n\n      if (isRemoveFormat) {\n        container = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(newInnerNode.textContent);\n        offset = container.textContent.length;\n        pNode.insertBefore(container, newInnerNode);\n        pNode.removeChild(newInnerNode);\n      }\n\n      if (!isRemoveFormat && pNode.childNodes.length === 0) {\n        if (element.childNodes) {\n          container = element.childNodes[0];\n        } else {\n          container = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace);\n          element.appendChild(container);\n        }\n      } else {\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeEmptyNode(pNode);\n        element.parentNode.insertBefore(pNode, element);\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(element);\n      }\n\n      return {\n        container: container,\n        offset: offset\n      };\n    },\n\n    /**\r\n     * @description Execute command of command button(All Buttons except submenu and dialog)\r\n     * (redo, undo, bold, underline, italic, strikethrough, subscript, superscript, removeFormat, indent, outdent, fullscreen, showBlocks, codeview, preview, print)\r\n     * @param {Element} target - The element of command button\r\n     * @param {String} command - Property of command button (data-value)\r\n     */\n    commandHandler: function (target, command) {\n      switch (command) {\n        case 'codeView':\n          this.controllersOff();\n          this.toggleCodeView();\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(target, 'on');\n          break;\n\n        case 'fullScreen':\n          this.controllersOff();\n          this.toggleFullScreen(target);\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(target, 'on');\n          break;\n\n        case 'indent':\n        case 'outdent':\n          this.indent(command);\n          break;\n\n        case 'redo':\n        case 'undo':\n          this.execCommand(command, false, null);\n          break;\n\n        case 'removeFormat':\n          this.removeFormat();\n          break;\n\n        case 'preview':\n        case 'print':\n          this.openWindowContents(command);\n          break;\n\n        case 'showBlocks':\n          this.toggleDisplayBlocks();\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(target, 'on');\n          break;\n\n        case 'subscript':\n          if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hasClass(context.tool.superscript, 'on')) {\n            this.execCommand('superscript', false, null);\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(context.tool.superscript, 'on');\n          }\n\n          this.execCommand(command, false, null);\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(target, 'on');\n          break;\n\n        case 'superscript':\n          if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hasClass(context.tool.subscript, 'on')) {\n            this.execCommand('subscript', false, null);\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(context.tool.subscript, 'on');\n          }\n\n          this.execCommand(command, false, null);\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(target, 'on');\n          break;\n\n        case 'save':\n          if (typeof context.option.callBackSave === 'function') {\n            context.option.callBackSave(this.getContents());\n          } else {\n            throw Error('[SUNEDITOR.core.commandHandler.fail] Please register call back function in creation option. (callBackSave : Function)');\n          }\n\n          break;\n\n        default:\n          // 'bold', 'underline', 'italic', 'strike'\n          this.execCommand(command, false, target.getAttribute('data-value'));\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(target, 'on');\n      }\n\n      this.focus();\n    },\n\n    /**\r\n     * @description Remove format of the currently selected range (IE, Edge not working)\r\n     */\n    removeFormat: function () {\n      this.nodeChange(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('REMOVENODE'));\n    },\n\n    /**\r\n     * @description This method implements indentation to selected range.\r\n     * Setted \"margin-left\" to \"25px\" in the top \"P\" tag of the parameter node.\r\n     * @param command {String} - Separator (\"indent\" or \"outdent\")\r\n     */\n    indent: function (command) {\n      const rangeLines = this.getSelectedFormatElements();\n      let p, margin;\n\n      for (let i = 0, len = rangeLines.length; i < len; i++) {\n        p = rangeLines[i];\n        margin = /\\d+/.test(p.style.marginLeft) ? p.style.marginLeft.match(/\\d+/)[0] * 1 : 0;\n\n        if ('indent' === command) {\n          margin += 25;\n        } else {\n          margin -= 25;\n        }\n\n        p.style.marginLeft = (margin < 0 ? 0 : margin) + 'px';\n      }\n    },\n\n    /**\r\n     * @description Add or remove the class name of \"body\" so that the code block is visible\r\n     */\n    toggleDisplayBlocks: function () {\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(context.element.wysiwyg, 'sun-editor-show-block');\n    },\n\n    /**\r\n     * @description Changes to code view or wysiwyg view\r\n     */\n    toggleCodeView: function () {\n      const wysiwygActive = this._variable.wysiwygActive;\n      const disButtons = this.codeViewDisabledButtons;\n\n      for (let i = 0, len = disButtons.length; i < len; i++) {\n        disButtons[i].disabled = wysiwygActive;\n      }\n\n      if (!wysiwygActive) {\n        const code_html = context.element.code.value.trim();\n        context.element.wysiwyg.innerHTML = code_html.length > 0 ? _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].convertContentsForEditor(code_html) : '<p>' + _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace + '</p>';\n        context.element.wysiwyg.scrollTop = 0;\n        context.element.code.style.display = 'none';\n        context.element.wysiwyg.style.display = 'block';\n        if (context.option.height === 'auto') context.element.code.style.height = '0px';\n        this._variable.wysiwygActive = true;\n        this.focus();\n      } else {\n        context.element.code.value = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].convertHTMLForCodeView(context.element.wysiwyg.innerHTML.trim());\n        context.element.wysiwyg.style.display = 'none';\n        context.element.code.style.display = 'block';\n        if (context.option.height === 'auto') context.element.code.style.height = context.element.code.scrollHeight > 0 ? context.element.code.scrollHeight + 'px' : 'auto';\n        this._variable.wysiwygActive = false;\n        context.element.code.focus();\n      }\n    },\n\n    /**\r\n     * @description Changes to full screen or default screen\r\n     * @param {Element} element - full screen button\r\n     */\n    toggleFullScreen: function (element) {\n      if (!this._variable.isFullScreen) {\n        this._variable.isFullScreen = true;\n        context.element.topArea.style.position = 'fixed';\n        context.element.topArea.style.top = '0';\n        context.element.topArea.style.left = '0';\n        context.element.topArea.style.width = '100%';\n        context.element.topArea.style.height = '100%';\n        context.element.topArea.style.zIndex = '2147483647';\n        this._variable._bodyOverflow = _d.body.style.overflow;\n        _d.body.style.overflow = 'hidden';\n        this._variable._editorAreaOriginCssText = context.element.editorArea.style.cssText;\n        this._variable._wysiwygOriginCssText = context.element.wysiwyg.style.cssText;\n        this._variable._codeOriginCssText = context.element.code.style.cssText;\n        context.element.editorArea.style.cssText = context.element.toolbar.style.cssText = context.element.wysiwyg.style.cssText = context.element.code.style.cssText = '';\n        context.element.toolbar.style.width = context.element.wysiwyg.style.height = context.element.code.style.height = '100%';\n        context.element.toolbar.style.position = 'relative';\n        this._variable.innerHeight_fullScreen = _w.innerHeight - context.element.toolbar.offsetHeight;\n        context.element.editorArea.style.height = this._variable.innerHeight_fullScreen + 'px';\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(element.firstElementChild, 'icon-expansion');\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(element.firstElementChild, 'icon-reduction');\n      } else {\n        this._variable.isFullScreen = false;\n        context.element.code.style.cssText = this._variable._codeOriginCssText;\n        context.element.wysiwyg.style.cssText = this._variable._wysiwygOriginCssText;\n        context.element.toolbar.style.cssText = '';\n        context.element.editorArea.style.cssText = this._variable._editorAreaOriginCssText;\n        context.element.topArea.style.cssText = this._variable._originCssText;\n        _d.body.style.overflow = this._variable._bodyOverflow;\n\n        if (context.option.stickyToolbar > -1) {\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(context.element.toolbar, 'sun-editor-sticky');\n          event.onScroll_window();\n        }\n\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(element.firstElementChild, 'icon-reduction');\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(element.firstElementChild, 'icon-expansion');\n      }\n    },\n\n    /**\r\n     * @description Open the preview window or open the print window\r\n     * @param {String} mode - 'preview' or 'print'\r\n     */\n    openWindowContents: function (mode) {\n      const isPrint = mode === 'print';\n\n      const windowObject = _w.open('', '_blank');\n\n      windowObject.mimeType = 'text/html';\n      windowObject.document.write('' + '<!doctype html><html>' + '<head>' + '<meta charset=\"utf-8\" />' + '<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">' + '<title>' + (isPrint ? lang.toolbar.print : lang.toolbar.preview) + '</title>' + '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getIncludePath(['suneditor-contents', 'suneditor'], 'css') + '\">' + '</head>' + '<body>' + '<div class=\"sun-editor-editable\" style=\"width:' + context.element.wysiwyg.offsetWidth + 'px; margin:auto;\">' + this.getContents() + '</div>' + (isPrint ? '<script>_w.print();</script>' : '') + '</body>' + '</html>');\n    },\n\n    /**\r\n     * @description Gets the current contents\r\n     * @returns {Object}\r\n     */\n    getContents: function () {\n      let contents = '';\n      if (context.element.wysiwyg.innerText.trim().length === 0) return contents;\n\n      if (editor._variable.wysiwygActive) {\n        contents = context.element.wysiwyg.innerHTML;\n      } else {\n        contents = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].convertContentsForEditor(context.element.code.value);\n      }\n\n      const renderHTML = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('DIV');\n      renderHTML.innerHTML = contents;\n      const figcaptions = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getListChildren(renderHTML, function (current) {\n        return /FIGCAPTION/i.test(current.nodeName);\n      });\n\n      for (let i = 0, len = figcaptions.length; i < len; i++) {\n        figcaptions[i].outerHTML = figcaptions[i].outerHTML.replace(/(?!^<figcaption\\s+)(contenteditable=\"([a-z]+|\\s*)\")\\s*(?=[^>]*>)/i, '');\n      }\n\n      return renderHTML.innerHTML;\n    }\n  };\n  /**\r\n   * @description event function\r\n   */\n\n  const event = {\n    _shortcutKeyCode: {\n      66: ['bold', 'B'],\n      83: ['strikethrough', 'STRIKE'],\n      85: ['underline', 'U'],\n      73: ['italic', 'I'],\n      89: ['redo'],\n      90: ['undo'],\n      219: ['outdent'],\n      221: ['indent']\n    },\n    _directionKeyKeyCode: new RegExp('^(?:8|13|32|46|33|34|35|36|37|38|39|40|98|100|102|104)$'),\n    _changeButtonClassTagCheck: new RegExp('^(?:B|U|I|STRIKE|SUB|SUP)$'),\n    _findButtonEffectTag: function () {\n      const commandMap = editor.commandMap;\n      const classOnCheck = this._changeButtonClassTagCheck;\n      const commandMapNodes = [];\n      const currentNodes = [];\n      let findFormat = true,\n          findFont = true,\n          findSize = true,\n          findA = true;\n      let findB = true,\n          findI = true,\n          findU = true,\n          findS = true;\n      let cssText = '',\n          nodeName = '';\n\n      for (let selectionParent = editor.getSelectionNode(); !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(selectionParent); selectionParent = selectionParent.parentNode) {\n        if (!selectionParent) break;\n        if (selectionParent.nodeType !== 1) continue;\n        nodeName = selectionParent.nodeName.toUpperCase();\n        currentNodes.push(nodeName);\n        /** Format */\n\n        if (findFormat && _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isFormatElement(selectionParent)) {\n          commandMapNodes.push('FORMAT');\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].changeTxt(commandMap.FORMAT, nodeName);\n          findFormat = false;\n          continue;\n        }\n        /** Font */\n\n\n        if (findFont && (selectionParent.style.fontFamily.length > 0 || selectionParent.face && selectionParent.face.length > 0)) {\n          commandMapNodes.push('FONT');\n          const selectFont = (selectionParent.style.fontFamily || selectionParent.face || lang.toolbar.font).replace(/[\"']/g, '');\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].changeTxt(commandMap.FONT, selectFont);\n          findFont = false;\n        }\n        /** A */\n\n\n        if (findA && /^A$/.test(nodeName) && selectionParent.getAttribute('data-image-link') === null) {\n          if (!context.link || editor.controllerArray[0] !== context.link.linkBtn) {\n            editor.callPlugin('link', function () {\n              editor.plugins.link.call_controller_linkButton.call(editor, selectionParent);\n            });\n          }\n\n          findA = false;\n        } else if (findA && context.link && editor.controllerArray[0] === context.link.linkBtn) {\n          editor.controllersOff();\n        }\n        /** SPAN */\n\n\n        if (findSize && /^SPAN$/.test(nodeName)) {\n          /** font size */\n          if (selectionParent.style.fontSize.length > 0) {\n            commandMapNodes.push('SIZE');\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].changeTxt(commandMap.SIZE, selectionParent.style.fontSize);\n            findSize = false;\n          }\n        }\n        /** command map */\n\n\n        cssText = selectionParent.style.cssText;\n\n        if (findB && /font\\-weight\\s*:\\s*(?:\\d+|bold|bolder)(?:;|\\s|)/.test(cssText)) {\n          commandMapNodes.push('B');\n          findB = false;\n        }\n\n        if (findI && /font\\-style\\s*:\\s*(?:italic|oblique)(?:;|\\s)/.test(cssText)) {\n          commandMapNodes.push('I');\n          findI = false;\n        }\n\n        if (findU && /text\\-decoration(?:\\-line)?\\s*:\\s*underline(?:;|\\s|)/.test(cssText)) {\n          commandMapNodes.push('U');\n          findU = false;\n        }\n\n        if (findS && /text\\-decoration(?:\\-line)?\\s*:\\s*line-through(?:;|\\s|)/.test(cssText)) {\n          commandMapNodes.push('STRIKE');\n          findS = false;\n        }\n\n        commandMapNodes.push(/^STRONG$/.test(nodeName) ? 'B' : /^EM$/.test(nodeName) ? 'I' : nodeName);\n      }\n      /** A Tag edit controller off */\n\n\n      if (findA) editor.controllersOff();\n      /** toggle class on */\n\n      for (let i = 0; i < commandMapNodes.length; i++) {\n        nodeName = commandMapNodes[i];\n\n        if (classOnCheck.test(nodeName)) {\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(commandMap[nodeName], 'on');\n        }\n      }\n      /** remove class, display text */\n\n\n      for (let key in commandMap) {\n        if (commandMapNodes.indexOf(key) > -1) continue;\n\n        if (/^FONT/i.test(key)) {\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].changeTxt(commandMap[key], lang.toolbar.font);\n        } else if (/^SIZE$/i.test(key)) {\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].changeTxt(commandMap[key], lang.toolbar.fontSize);\n        } else {\n          _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(commandMap[key], 'on');\n        }\n      }\n      /** save current nodes */\n\n\n      editor._variable.currentNodes = currentNodes.reverse();\n      /**  Displays the current node structure to resizingBar */\n\n      if (context.option.showPathLabel) context.element.navigation.textContent = editor._variable.currentNodes.join(' > ');\n    },\n    _cancelCaptionEdit: function () {\n      this.setAttribute('contenteditable', false);\n      this.removeEventListener('blur', event._cancelCaptionEdit);\n    },\n    onMouseDown_toolbar: function (e) {\n      let target = e.target;\n\n      if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getParentElement(target, '.sun-editor-submenu')) {\n        e.stopPropagation();\n      } else {\n        e.preventDefault();\n        let command = target.getAttribute('data-command');\n        let className = target.className;\n\n        while (!command && !/editor_tool/.test(className) && !/sun-editor-id-toolbar/.test(className)) {\n          target = target.parentNode;\n          command = target.getAttribute('data-command');\n          className = target.className;\n        }\n\n        if (command === editor._submenuName) {\n          e.stopPropagation();\n        }\n      }\n    },\n    onClick_toolbar: function (e) {\n      e.preventDefault();\n      e.stopPropagation();\n      let target = e.target;\n      let display = target.getAttribute('data-display');\n      let command = target.getAttribute('data-command');\n      let className = target.className;\n\n      while (!command && !/editor_tool/.test(className) && !/sun-editor-id-toolbar/.test(className)) {\n        target = target.parentNode;\n        command = target.getAttribute('data-command');\n        display = target.getAttribute('data-display');\n        className = target.className;\n      }\n\n      if (!command && !display) return;\n      if (target.disabled) return;\n      editor.focus();\n      /** Dialog, Submenu */\n\n      if (display) {\n        if (/submenu/.test(display) && (target.nextElementSibling === null || target !== editor.submenuActiveButton)) {\n          editor.callPlugin(command, function () {\n            editor.submenuOn(target);\n          });\n          return;\n        } else if (/dialog/.test(display)) {\n          editor.callPlugin(command, function () {\n            editor.plugins.dialog.open.call(editor, command, false);\n          });\n          return;\n        }\n\n        editor.submenuOff();\n        return;\n      }\n      /** default command */\n\n\n      if (command) {\n        editor.commandHandler(target, command);\n      }\n    },\n    onMouseUp_wysiwyg: function () {\n      editor._editorRange();\n\n      if (editor._isBalloon) {\n        const range = editor.getRange();\n        if (range.collapsed) event._hideToolbar();else event._showToolbarBalloon(range);\n      }\n    },\n    onClick_wysiwyg: function (e) {\n      e.stopPropagation();\n      const targetElement = e.target;\n\n      if (/^IMG$/i.test(targetElement.nodeName)) {\n        e.preventDefault();\n        editor.callPlugin('image', function () {\n          const size = editor.plugins.resizing.call_controller_resize.call(editor, targetElement, 'image');\n          editor.plugins.image.onModifyMode.call(editor, targetElement, size);\n\n          if (!_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getParentElement(targetElement, '.sun-editor-id-image-container')) {\n            editor.plugins.image.openModify.call(editor, true);\n            editor.plugins.image.update_image.call(editor);\n            editor.controllersOff();\n          }\n        });\n        return;\n      }\n\n      if (/sun-editor-id-iframe-inner-resizing-cover/i.test(targetElement.className)) {\n        e.preventDefault();\n        editor.callPlugin('video', function () {\n          const iframe = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getChildElement(targetElement.parentNode, 'iframe');\n          const size = editor.plugins.resizing.call_controller_resize.call(editor, iframe, 'video');\n          editor.plugins.video.onModifyMode.call(editor, iframe, size);\n        });\n        return;\n      }\n\n      event._findButtonEffectTag();\n\n      const figcaption = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getParentElement(targetElement, 'FIGCAPTION');\n\n      if (figcaption && figcaption.getAttribute('contenteditable') !== 'ture') {\n        e.preventDefault();\n        figcaption.setAttribute('contenteditable', true);\n        figcaption.focus();\n\n        if (editor._isInline && !editor._inlineToolbarAttr.isShow) {\n          event._showToolbarInline();\n\n          const hideToolbar = function () {\n            event._hideToolbar();\n\n            _d.removeEventListener('click', hideToolbar);\n          };\n\n          _d.addEventListener('click', hideToolbar);\n        }\n      } else {\n        const td = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getParentElement(targetElement, _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isCell);\n\n        if (td) {\n          if (editor.controllerArray.length === 0) {\n            editor.callPlugin('table', editor.plugins.table.call_controller_tableEdit.bind(editor, td));\n          }\n        }\n      }\n\n      if (userFunction.onClick) userFunction.onClick(e);\n    },\n    _showToolbarBalloon: function (rangeObj) {\n      const range = rangeObj || editor.getRange();\n      const padding = 20;\n      const toolbar = context.element.toolbar;\n\n      const selection = _w.getSelection();\n\n      let isDirTop;\n\n      if (selection.focusNode === selection.anchorNode) {\n        isDirTop = selection.focusOffset < selection.anchorOffset;\n      } else {\n        const childNodes = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getListChildNodes(range.commonAncestorContainer);\n        isDirTop = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getArrayIndex(childNodes, selection.focusNode) < _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getArrayIndex(childNodes, selection.anchorNode);\n      }\n\n      let rects = range.getClientRects();\n      rects = rects[isDirTop ? 0 : rects.length - 1];\n      toolbar.style.display = 'block';\n      const toolbarWidth = toolbar.offsetWidth;\n      const toolbarHeight = toolbar.offsetHeight;\n      let l = (isDirTop ? rects.left : rects.right) - context.element.topArea.offsetLeft + (_w.scrollX || _d.documentElement.scrollLeft) - toolbarWidth / 2;\n      let t = (isDirTop ? rects.top - toolbarHeight - 11 : rects.bottom + 11) - context.element.topArea.offsetTop + (_w.scrollY || _d.documentElement.scrollTop);\n      const overRight = l + toolbarWidth - context.element.topArea.offsetWidth;\n      toolbar.style.left = (l < 0 ? padding : overRight < 0 ? l : l - overRight - padding) + 'px';\n      toolbar.style.top = t + 'px';\n\n      if (isDirTop) {\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(context.element._arrow, 'arrow-up');\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(context.element._arrow, 'arrow-down');\n        context.element._arrow.style.top = toolbarHeight + 'px';\n      } else {\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(context.element._arrow, 'arrow-down');\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(context.element._arrow, 'arrow-up');\n        context.element._arrow.style.top = '-11px';\n      }\n\n      const arrow_width = context.element._arrow.offsetWidth;\n      const arrow_left = toolbarWidth / 2 + (l < 0 ? l - arrow_width : overRight < 0 ? 0 : overRight + arrow_width);\n      const arrow_point_width = arrow_width / 2;\n      context.element._arrow.style.left = (arrow_left < arrow_point_width ? arrow_point_width : arrow_left + arrow_point_width >= toolbarWidth ? arrow_left - arrow_point_width : arrow_left) + 'px';\n    },\n    _showToolbarInline: function () {\n      const toolbar = context.element.toolbar;\n      toolbar.style.display = 'block';\n      editor._inlineToolbarAttr.width = toolbar.style.width = context.option.toolbarWidth;\n      editor._inlineToolbarAttr.top = toolbar.style.top = -1 - toolbar.offsetHeight + 'px';\n      event.onScroll_window();\n      editor._inlineToolbarAttr.isShow = true;\n    },\n    _hideToolbar: function () {\n      context.element.toolbar.style.display = 'none';\n      editor._inlineToolbarAttr.isShow = false;\n    },\n    onKeyDown_wysiwyg: function (e) {\n      const keyCode = e.keyCode;\n      const shift = e.shiftKey;\n      const ctrl = e.ctrlKey || e.metaKey;\n      const alt = e.altKey;\n\n      if (editor._isBalloon) {\n        event._hideToolbar();\n      }\n\n      function shortcutCommand(keyCode) {\n        const key = event._shortcutKeyCode[keyCode];\n        if (!key) return false;\n        editor.commandHandler(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFormatElement(editor.getSelectionNode()), key[0]);\n        _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleClass(editor.commandMap[key[1]], 'on');\n        return true;\n      }\n      /** Shortcuts */\n\n\n      if (ctrl && !/^(?:16|17|18)$/.test(keyCode)) {\n        if (!(!shift && keyCode === 83) && shortcutCommand(keyCode)) {\n          e.preventDefault();\n          return;\n        }\n      }\n      /** default key action */\n\n\n      const selectionNode = editor.getSelectionNode();\n\n      switch (keyCode) {\n        case 8:\n          /**backspace key*/\n          if (_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isFormatElement(selectionNode) && _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(selectionNode.parentNode) && selectionNode.previousSibling === null) {\n            e.preventDefault();\n            e.stopPropagation();\n            selectionNode.innerHTML = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace;\n            return false;\n          }\n\n          break;\n\n        case 9:\n          /**tab key*/\n          e.preventDefault();\n          if (ctrl || alt) break;\n          editor.controllersOff();\n          let currentNode = selectionNode || editor.getSelectionNode();\n\n          while (!_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isCell(currentNode) && !_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(currentNode)) {\n            currentNode = currentNode.parentNode;\n          }\n\n          if (currentNode && _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isCell(currentNode)) {\n            const table = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getParentElement(currentNode, 'table');\n            const cells = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getListChildren(table, _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isCell);\n            let idx = shift ? _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].prevIdx(cells, currentNode) : _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].nextIdx(cells, currentNode);\n            if (idx === cells.length && !shift) idx = 0;\n            if (idx === -1 && shift) idx = cells.length - 1;\n            const moveCell = cells[idx];\n            if (!moveCell) return false;\n            editor.setRange(moveCell, 0, moveCell, 0);\n            break;\n          }\n          /** format Tag */\n\n\n          const lines = editor.getSelectedFormatElements();\n\n          if (!shift) {\n            const tabText = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createTextNode(new Array(editor._variable.tabSize + 1).join('\\u00A0'));\n\n            if (lines.length === 1) {\n              editor.insertNode(tabText);\n              editor.setRange(tabText, editor._variable.tabSize, tabText, editor._variable.tabSize);\n            } else {\n              for (let i = 0, len = lines.length; i < len; i++) {\n                lines[i].insertBefore(tabText.cloneNode(false), lines[i].firstChild);\n              }\n            }\n          } else {\n            for (let i = 0, len = lines.length, child; i < len; i++) {\n              child = lines[i].firstChild;\n\n              if (/^\\s{1,4}$/.test(child.textContent)) {\n                _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(child);\n              } else if (/^\\s{1,4}/.test(child.textContent)) {\n                child.textContent = child.textContent.replace(/^\\s{1,4}/, '');\n              }\n            }\n          }\n\n          break;\n      }\n\n      if (userFunction.onKeyDown) userFunction.onKeyDown(e);\n    },\n    onKeyUp_wysiwyg: function (e) {\n      editor._editorRange();\n\n      editor.controllersOff();\n      const selectionNode = editor.getSelectionNode();\n\n      if (editor._isBalloon && !editor.getRange().collapsed) {\n        event._showToolbarBalloon();\n\n        return;\n      }\n      /** when format tag deleted */\n\n\n      if (e.keyCode === 8 && _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(selectionNode) && context.element.wysiwyg.textContent.length === 0) {\n        e.preventDefault();\n        e.stopPropagation();\n        const oFormatTag = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement(_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isFormatElement(editor._variable.currentNodes[0]) ? editor._variable.currentNodes[0] : 'P');\n        oFormatTag.innerHTML = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zeroWidthSpace;\n        selectionNode.appendChild(oFormatTag);\n        editor.setRange(oFormatTag, 0, oFormatTag, 0);\n        return;\n      }\n\n      if ((_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(selectionNode.parentElement) || _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isRangeFormatElement(selectionNode.parentElement)) && selectionNode.nodeType === 3) {\n        editor.execCommand('formatBlock', false, _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isWysiwygDiv(selectionNode.parentElement) ? 'P' : 'DIV');\n\n        event._findButtonEffectTag();\n\n        return;\n      }\n\n      if (event._directionKeyKeyCode.test(e.keyCode)) {\n        event._findButtonEffectTag();\n      }\n\n      if (userFunction.onKeyUp) userFunction.onKeyUp(e);\n    },\n    onScroll_wysiwyg: function (e) {\n      editor.controllersOff();\n      if (userFunction.onScroll) userFunction.onScroll(e);\n    },\n    onDrop_wysiwyg: function (e) {\n      const files = e.dataTransfer.files;\n\n      if (files.length > 0) {\n        e.stopPropagation();\n        e.preventDefault();\n        editor.focus();\n        editor.callPlugin('image', function () {\n          context.image.imgInputFile.files = files;\n          editor.plugins.image.onRender_imgInput.call(editor);\n          context.image.imgInputFile.files = null;\n        });\n      }\n\n      if (userFunction.onDrop) userFunction.onDrop(e);\n    },\n    onMouseDown_resizingBar: function (e) {\n      e.stopPropagation();\n      editor._variable.resizeClientY = e.clientY;\n      context.element.resizeBackground.style.display = 'block';\n\n      function closureFunc() {\n        context.element.resizeBackground.style.display = 'none';\n\n        _d.removeEventListener('mousemove', event._resize_editor);\n\n        _d.removeEventListener('mouseup', closureFunc);\n      }\n\n      _d.addEventListener('mousemove', event._resize_editor);\n\n      _d.addEventListener('mouseup', closureFunc);\n    },\n    _resize_editor: function (e) {\n      const resizeInterval = context.element.editorArea.offsetHeight + (e.clientY - editor._variable.resizeClientY);\n      context.element.wysiwyg.style.height = context.element.code.style.height = (resizeInterval < editor._variable.minResizingSize ? editor._variable.minResizingSize : resizeInterval) + 'px';\n      editor._variable.resizeClientY = e.clientY;\n    },\n    onResize_window: function () {\n      if (context.element.toolbar.offsetWidth === 0) return;\n\n      if (editor._variable.isFullScreen) {\n        editor._variable.innerHeight_fullScreen += _w.innerHeight - context.element.toolbar.offsetHeight - editor._variable.innerHeight_fullScreen;\n        context.element.editorArea.style.height = editor._variable.innerHeight_fullScreen + 'px';\n      } else if (editor._variable._sticky) {\n        context.element.toolbar.style.width = context.element.topArea.offsetWidth - 2 + 'px';\n        event.onScroll_window();\n      }\n\n      editor.controllersOff();\n    },\n    onScroll_window: function () {\n      if (editor._variable.isFullScreen || context.element.toolbar.offsetWidth === 0) return;\n      const element = context.element;\n      const editorHeight = element.editorArea.offsetHeight;\n      const editorTop = element.topArea.offsetTop - (editor._isInline ? element.toolbar.offsetHeight : 0);\n      const y = (this.scrollY || _d.documentElement.scrollTop) + context.option.stickyToolbar;\n\n      if (y < editorTop) {\n        event._offStickyToolbar(element);\n      } else if (y + editor._variable.minResizingSize >= editorHeight + editorTop) {\n        if (!editor._variable._sticky) event._onStickyToolbar(element);\n        element.toolbar.style.top = editorHeight + editorTop + context.option.stickyToolbar - y - editor._variable.minResizingSize + 'px';\n      } else if (y >= editorTop) {\n        event._onStickyToolbar(element);\n      }\n    },\n    _onStickyToolbar: function (element) {\n      if (!editor._isInline) {\n        element._stickyDummy.style.height = element.toolbar.offsetHeight + 'px';\n        element._stickyDummy.style.display = 'block';\n      }\n\n      element.toolbar.style.top = context.option.stickyToolbar + 'px';\n      element.toolbar.style.width = editor._isInline ? editor._inlineToolbarAttr.width : element.toolbar.offsetWidth + 'px';\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(element.toolbar, 'sun-editor-sticky');\n      editor._variable._sticky = true;\n    },\n    _offStickyToolbar: function (element) {\n      element._stickyDummy.style.display = 'none';\n      element.toolbar.style.top = editor._isInline ? editor._inlineToolbarAttr.top : '';\n      element.toolbar.style.width = editor._isInline ? editor._inlineToolbarAttr.width : '';\n      element.editorArea.style.marginTop = '';\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeClass(element.toolbar, 'sun-editor-sticky');\n      editor._variable._sticky = false;\n    },\n    _codeViewAutoScroll: function () {\n      context.element.code.style.height = context.element.code.scrollHeight + 'px';\n    },\n    onPaste_wysiwyg: function (e) {\n      if (!e.clipboardData.getData) return true;\n      const cleanData = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cleanHTML(e.clipboardData.getData('text/html'));\n\n      if (cleanData) {\n        editor.execCommand('insertHTML', false, cleanData);\n        e.stopPropagation();\n        e.preventDefault();\n      }\n    }\n  };\n  /** add event listeners */\n\n  /** toolbar event */\n\n  context.element.toolbar.addEventListener('mousedown', event.onMouseDown_toolbar, false);\n  context.element.toolbar.addEventListener('click', event.onClick_toolbar, false);\n  /** editor area */\n\n  context.element.relative.addEventListener('click', editor.focus.bind(editor), false);\n  context.element.wysiwyg.addEventListener('mouseup', event.onMouseUp_wysiwyg, false);\n  context.element.wysiwyg.addEventListener('click', event.onClick_wysiwyg, false);\n  context.element.wysiwyg.addEventListener('scroll', event.onScroll_wysiwyg, false);\n  context.element.wysiwyg.addEventListener('keydown', event.onKeyDown_wysiwyg, false);\n  context.element.wysiwyg.addEventListener('keyup', event.onKeyUp_wysiwyg, false);\n  context.element.wysiwyg.addEventListener('drop', event.onDrop_wysiwyg, false);\n  context.element.wysiwyg.addEventListener('paste', event.onPaste_wysiwyg, false);\n  /** code view area auto line */\n\n  if (context.option.height === 'auto') context.element.code.addEventListener('keyup', event._codeViewAutoScroll, false);\n  /** resizingBar */\n\n  if (context.element.resizingBar) {\n    if (/\\d+/.test(context.option.height)) {\n      context.element.resizingBar.addEventListener('mousedown', event.onMouseDown_resizingBar, false);\n    } else {\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addClass(context.element.resizingBar, 'none-resize');\n    }\n  }\n  /** inline editor */\n\n\n  if (editor._isInline) {\n    context.element.wysiwyg.addEventListener('focus', event._showToolbarInline, false);\n  }\n\n  if (editor._isInline || editor._isBalloon) {\n    context.element.wysiwyg.addEventListener('blur', event._hideToolbar, false);\n  }\n  /** window event */\n\n\n  _w.addEventListener('resize', event.onResize_window, false);\n\n  if (context.option.stickyToolbar > -1) _w.addEventListener('scroll', event.onScroll_window, false);\n  /** add plugin to plugins object */\n\n  if (plugins) {\n    Object.keys(plugins).map(function (key) {\n      let plugin = plugins[key];\n      editor.plugins[plugin.name] = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].copyObj(plugin);\n    });\n  }\n  /** User function */\n\n\n  const userFunction = {\n    /**\r\n     * @description Event functions\r\n     * @param {Object} event - Event Object\r\n     */\n    onScroll: null,\n    onClick: null,\n    onKeyDown: null,\n    onKeyUp: null,\n    onDrop: null,\n\n    /**\r\n     * @description Called when the image is uploaded or the uploaded image is deleted\r\n     * @param {Element} targetImgElement - Current img element\r\n     * @param {Number} index - Uploaded index\r\n     * @param {Boolean} isDelete - Whether or not it was called after the delete operation\r\n     * @param {Object} imageInfo - Image info object\r\n     */\n    onImageUpload: null,\n\n    /**\r\n     * @description Called when the image is upload failed\r\n     * @param {String} errorMessage - Error message\r\n     * @param {Object} result - Result info Object\r\n     */\n    onImageUploadError: null,\n\n    /**\r\n     * @description Open a notice area\r\n     * @param {String} message - Notice message\r\n     */\n    noticeOpen: function (message) {\n      editor.addModule([_plugins_modules_notice__WEBPACK_IMPORTED_MODULE_1__[\"default\"]]);\n      _plugins_modules_notice__WEBPACK_IMPORTED_MODULE_1__[\"default\"].open.call(editor, message);\n    },\n\n    /**\r\n     * @description Close a notice area\r\n     */\n    noticeClose: function () {\n      editor.addModule([_plugins_modules_notice__WEBPACK_IMPORTED_MODULE_1__[\"default\"]]);\n      _plugins_modules_notice__WEBPACK_IMPORTED_MODULE_1__[\"default\"].close.call(editor);\n    },\n\n    /**\r\n     * @description Copying the contents of the editor to the original textarea\r\n     */\n    save: function () {\n      context.element.originElement.value = editor.getContents();\n    },\n\n    /**\r\n     * @description Gets the suneditor's context object. Contains settings, plugins, and cached element objects\r\n     * @returns {Object}\r\n     */\n    getContext: function () {\n      return context;\n    },\n\n    /**\r\n     * @description Gets the contents of the suneditor\r\n     * @returns {String}\r\n     */\n    getContents: function () {\n      return editor.getContents();\n    },\n\n    /**\r\n     * @description Gets uploaded images informations\r\n     * @returns {Array}\r\n     */\n    getImagesInfo: function () {\n      return editor._variable._imagesInfo;\n    },\n\n    /**\r\n     * @description Inserts an HTML element or HTML string or plain string at the current cursor position\r\n     * @param {Element|String} html - HTML Element or HTML string or plain string\r\n     */\n    insertHTML: function (html) {\n      if (!html.nodeType || html.nodeType !== 1) {\n        const template = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('template');\n        template.innerHTML = html;\n        html = template.firstChild || template.content.firstChild;\n      }\n\n      editor.insertNode(html);\n      editor.focus();\n    },\n\n    /**\r\n     * @description Change the contents of the suneditor\r\n     * @param {String} contents - Contents to Input\r\n     */\n    setContents: function (contents) {\n      if (editor._variable.wysiwygActive) {\n        context.element.wysiwyg.innerHTML = _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].convertContentsForEditor(contents);\n      } else {\n        context.element.code.value = contents;\n      }\n    },\n\n    /**\r\n     * @description Add contents to the suneditor\r\n     * @param {String} contents - Contents to Input\r\n     */\n    appendContents: function (contents) {\n      if (editor._variable.wysiwygActive) {\n        context.element.wysiwyg.innerHTML += _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].convertContentsForEditor(contents);\n      } else {\n        context.element.code.value += contents;\n      }\n    },\n\n    /**\r\n     * @description Disable the suneditor\r\n     */\n    disabled: function () {\n      context.tool.cover.style.display = 'block';\n      context.element.wysiwyg.setAttribute('contenteditable', false);\n      context.element.code.setAttribute('disabled', 'disabled');\n    },\n\n    /**\r\n     * @description Enabled the suneditor\r\n     */\n    enabled: function () {\n      context.tool.cover.style.display = 'none';\n      context.element.wysiwyg.setAttribute('contenteditable', true);\n      context.element.code.removeAttribute('disabled');\n    },\n\n    /**\r\n     * @description Show the suneditor\r\n     */\n    show: function () {\n      const topAreaStyle = context.element.topArea.style;\n      if (topAreaStyle.display === 'none') topAreaStyle.display = context.option.display;\n    },\n\n    /**\r\n     * @description Hide the suneditor\r\n     */\n    hide: function () {\n      context.element.topArea.style.display = 'none';\n    },\n\n    /**\r\n     * @description Destroy the suneditor\r\n     */\n    destroy: function () {\n      /** remove window event listeners */\n      _w.removeEventListener('resize', event.onResize_window);\n\n      _w.removeEventListener('scroll', event.onScroll_window);\n      /** remove element */\n\n\n      _util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].removeItem(context.element.topArea);\n      this.onScroll = null;\n      this.onClick = null;\n      this.onKeyDown = null;\n      this.onKeyUp = null;\n      this.onDrop = null;\n      this.save = null;\n      this.onImageUpload = null;\n      this.onImageUploadError = null;\n      this.noticeOpen = null;\n      this.noticeClose = null;\n      this.getContext = null;\n      this.getContents = null;\n      this.getImagesInfo = null;\n      this.insertHTML = null;\n      this.setContents = null;\n      this.appendContents = null;\n      this.disabled = null;\n      this.enabled = null;\n      this.show = null;\n      this.hide = null;\n      this.destroy = null;\n      context = null;\n      plugins = null;\n      lang = null;\n    }\n  };\n  return userFunction;\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (core);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbGliL2NvcmUuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbGliL2NvcmUuanM/OGE4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiB3eXNpd3lnIHdlYiBlZGl0b3JcclxuICpcclxuICogc3VuZWRpdG9yLmpzXHJcbiAqIENvcHlyaWdodCAyMDE3IEppSG9uZyBMZWUuXHJcbiAqIE1JVCBsaWNlbnNlLlxyXG4gKi9cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuaW1wb3J0IHV0aWwgZnJvbSAnLi91dGlsJztcclxuaW1wb3J0IG5vdGljZSBmcm9tICcuLi9wbHVnaW5zL21vZHVsZXMvbm90aWNlJztcclxuXHJcbi8qKlxyXG4gKiBAZGVzY3JpcHRpb24gU3VuRWRpdG9yIGNvcmUgZnVuY3Rpb25cclxuICogQHBhcmFtIGNvbnRleHRcclxuICogQHBhcmFtIHBsdWdpbnNcclxuICogQHBhcmFtIGxhbmdcclxuICogQHJldHVybnMge09iamVjdH0gVXNlckZ1bmN0aW9uIE9iamVjdFxyXG4gKi9cclxuY29uc3QgY29yZSA9IGZ1bmN0aW9uIChjb250ZXh0LCBwbHVnaW5zLCBsYW5nKSB7XHJcbiAgICBjb25zdCBfZCA9IGRvY3VtZW50O1xyXG4gICAgY29uc3QgX3cgPSB3aW5kb3c7XHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBlZGl0b3IgY29yZSBvYmplY3RcclxuICAgICAqIHNob3VsZCBhbHdheXMgYmluZCB0aGlzIG9iamVjdCB3aGVuIHJlZ2lzdGVyaW5nIGFuIGV2ZW50IGluIHRoZSBwbHVnLWluLlxyXG4gICAgICovXHJcbiAgICBjb25zdCBlZGl0b3IgPSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEVsZW1lbnRzIGFuZCB1c2VyIG9wdGlvbnMgcGFyYW1ldGVycyBvZiB0aGUgc3VuZWRpdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29udGV4dDogY29udGV4dCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIGxvYWRlZCBwbHVnaW5zXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcGx1Z2luczoge30sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBXaGV0aGVyIHRoZSBwbHVnaW4gaXMgaW5pdGlhbGl6ZWRcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0UGx1Z2luczoge30sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBsb2FkZWQgbGFuZ3VhZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBsYW5nOiBsYW5nLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gZGlhbG9nIGVsZW1lbnRcclxuICAgICAgICAgKi9cclxuICAgICAgICBkaWFsb2dGb3JtOiBudWxsLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gY3VycmVudCBzdWJtZW50IG5hbWVcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9zdWJtZW51TmFtZTogJycsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBzdWJtZW51IGVsZW1lbnRcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdWJtZW51OiBudWxsLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gYmluZGVkIHN1Ym1lbnVPZmYgbWV0aG9kXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfYmluZGVkU3VibWVudU9mZjogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIGFjdGl2ZSBidXR0b24gZWxlbWVudCBpbiBzdWJtZW51XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3VibWVudUFjdGl2ZUJ1dHRvbjogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFRoZSBlbGVtZW50cyBhcnJheSB0byBiZSBwcm9jZXNzZWQgdW52aXNpYmxlIHdoZW4gdGhlIGNvbnRyb2xsZXJzT2ZmIGZ1bmN0aW9uIGlzIGV4ZWN1dGVkIChyZXNpemluZywgbGluayBtb2RpZmllZCBidXR0b24sIHRhYmxlIGNvbnRyb2xsZXIpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29udHJvbGxlckFycmF5OiBbXSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIGJpbmRlZCBjb250cm9sbGVyc09mZiBtZXRob2RcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9iaW5kQ29udHJvbGxlcnNPZmY6IG51bGwsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBbiBhcnJheSBvZiBidXR0b25zIHdob3NlIGNsYXNzIG5hbWUgaXMgbm90IFwiY29kZS12aWV3LWVuYWJsZWRcIlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNvZGVWaWV3RGlzYWJsZWRCdXR0b25zOiBjb250ZXh0LmVsZW1lbnQudG9vbGJhci5xdWVyeVNlbGVjdG9yQWxsKCcuc3VuLWVkaXRvci1pZC10b29sYmFyIGJ1dHRvbjpub3QoW2NsYXNzfj1cImNvZGUtdmlldy1lbmFibGVkXCJdKScpLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gSXMgaW5saW5lIG1vZGU/XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfaXNJbmxpbmU6IC9pbmxpbmUvaS50ZXN0KGNvbnRleHQub3B0aW9uLm1vZGUpLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gSXMgYmFsbG9vbiBtb2RlP1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2lzQmFsbG9vbjogL2JhbGxvb24vaS50ZXN0KGNvbnRleHQub3B0aW9uLm1vZGUpLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gUmVxdWlyZWQgdmFsdWUgd2hlbiB1c2luZyBpbmxpbmUgbW9kZSB0byBzdGlja3kgdG9vbGJhclxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2lubGluZVRvb2xiYXJBdHRyOiB7d2lkdGg6IDAsIGhlaWdodDogMCwgaXNTaG93OiBmYWxzZX0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBbiB1c2VyIGV2ZW50IGZ1bmN0aW9uIHdoZW4gaW1hZ2UgdXBsb2FkZWQgc3VjY2VzcyBvciByZW1vdmUgaW1hZ2VcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9pbWFnZVVwbG9hZDogZnVuY3Rpb24gKHRhcmdldEltZ0VsZW1lbnQsIGluZGV4LCBpc0RlbGV0ZSwgaW1hZ2VJbmZvKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXNlckZ1bmN0aW9uLm9uSW1hZ2VVcGxvYWQgPT09ICdmdW5jdGlvbicpIHVzZXJGdW5jdGlvbi5vbkltYWdlVXBsb2FkKHRhcmdldEltZ0VsZW1lbnQsIGluZGV4ICogMSwgaXNEZWxldGUsIGltYWdlSW5mbyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFuIHVzZXIgZXZlbnQgZnVuY3Rpb24gd2hlbiBpbWFnZSB1cGxvYWQgZmFpbGVkXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfaW1hZ2VVcGxvYWRFcnJvcjogZnVuY3Rpb24gKGVycm9yTWVzc2FnZSwgcmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXNlckZ1bmN0aW9uLm9uSW1hZ2VVcGxvYWRFcnJvciA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHVzZXJGdW5jdGlvbi5vbkltYWdlVXBsb2FkRXJyb3IoZXJyb3JNZXNzYWdlLCByZXN1bHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gRWxlbWVudHMgdGhhdCBuZWVkIHRvIGNoYW5nZSB0ZXh0IG9yIGNsYXNzTmFtZSBmb3IgZWFjaCBzZWxlY3Rpb24gY2hhbmdlXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtFbGVtZW50fSBGT1JNQVQgLSBmb3JtYXQgYnV0dG9uXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtFbGVtZW50fSBGT05UIC0gZm9udCBmYW1pbHkgYnV0dG9uXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtFbGVtZW50fSBTSVpFIC0gZm9udCBzaXplIGJ1dHRvblxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7RWxlbWVudH0gQiAtIGJvbGQgYnV0dG9uXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtFbGVtZW50fSBVIC0gdW5kZXJsaW5lIGJ1dHRvblxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7RWxlbWVudH0gSSAtIGl0YWxpYyBidXR0b25cclxuICAgICAgICAgKiBAcHJvcGVydHkge0VsZW1lbnR9IFNUUklLRSAtIHN0cmlrZSBidXR0b25cclxuICAgICAgICAgKiBAcHJvcGVydHkge0VsZW1lbnR9IFNVQiAtIHN1YnNjcmlwdCBidXR0b25cclxuICAgICAgICAgKiBAcHJvcGVydHkge0VsZW1lbnR9IFNVUCAtIHN1cGVyc2NyaXB0IGJ1dHRvblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNvbW1hbmRNYXA6IHtcclxuICAgICAgICAgICAgRk9STUFUOiBjb250ZXh0LnRvb2wuZm9ybWF0LFxyXG4gICAgICAgICAgICBGT05UOiBjb250ZXh0LnRvb2wuZm9udCxcclxuICAgICAgICAgICAgU0laRTogY29udGV4dC50b29sLmZvbnRTaXplLFxyXG4gICAgICAgICAgICBCOiBjb250ZXh0LnRvb2wuYm9sZCxcclxuICAgICAgICAgICAgVTogY29udGV4dC50b29sLnVuZGVybGluZSxcclxuICAgICAgICAgICAgSTogY29udGV4dC50b29sLml0YWxpYyxcclxuICAgICAgICAgICAgU1RSSUtFOiBjb250ZXh0LnRvb2wuc3RyaWtlLFxyXG4gICAgICAgICAgICBTVUI6IGNvbnRleHQudG9vbC5zdWJzY3JpcHQsXHJcbiAgICAgICAgICAgIFNVUDogY29udGV4dC50b29sLnN1cGVyc2NyaXB0XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFZhcmlhYmxlcyB1c2VkIGludGVybmFsbHkgaW4gZWRpdG9yIG9wZXJhdGlvblxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7Qm9vbGVhbn0gd3lzaXd5Z0FjdGl2ZSAtIFRoZSB3eXNpd3lnIGZyYW1lIG9yIGNvZGUgdmlldyBzdGF0ZVxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7Qm9vbGVhbn0gaXNGdWxsU2NyZWVuIC0gU3RhdGUgb2YgZnVsbCBzY3JlZW5cclxuICAgICAgICAgKiBAcHJvcGVydHkge051bWJlcn0gaW5uZXJIZWlnaHRfZnVsbFNjcmVlbiAtIElubmVySGVpZ2h0IGluIGVkaXRvciB3aGVuIGluIGZ1bGwgc2NyZWVuXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtOdW1iZXJ9IHJlc2l6ZUNsaWVudFkgLSBSZW1lbWJlciB0aGUgdmVydGljYWwgc2l6ZSBvZiB0aGUgZWRpdG9yIGJlZm9yZSByZXNpemluZyB0aGUgZWRpdG9yIChVc2VkIHdoZW4gY2FsY3VsYXRpbmcgZHVyaW5nIHJlc2l6ZSBvcGVyYXRpb24pXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtOdW1iZXJ9IHRhYlNpemUgLSBJbmRlbnRlZCBzaXplIHdoZW4gdGFiIGJ1dHRvbiBjbGlja2VkICg0KVxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBtaW5SZXNpemluZ1NpemUgLSBNaW5pbXVtIHNpemUgb2YgZWRpdGluZyBhcmVhIHdoZW4gcmVzaXplZCAoNjUpXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtBcnJheX0gY3VycmVudE5vZGVzIC0gIEFuIGFycmF5IG9mIHRoZSBjdXJyZW50IGN1cnNvcidzIG5vZGUgc3RydWN0dXJlXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdmFyaWFibGU6IHtcclxuICAgICAgICAgICAgd3lzaXd5Z0FjdGl2ZTogdHJ1ZSxcclxuICAgICAgICAgICAgaXNGdWxsU2NyZWVuOiBmYWxzZSxcclxuICAgICAgICAgICAgaW5uZXJIZWlnaHRfZnVsbFNjcmVlbjogMCxcclxuICAgICAgICAgICAgcmVzaXplQ2xpZW50WTogMCxcclxuICAgICAgICAgICAgdGFiU2l6ZTogNCxcclxuICAgICAgICAgICAgbWluUmVzaXppbmdTaXplOiA2NSxcclxuICAgICAgICAgICAgY3VycmVudE5vZGVzOiBbXSxcclxuICAgICAgICAgICAgX3JhbmdlOiBudWxsLFxyXG4gICAgICAgICAgICBfc2VsZWN0aW9uTm9kZTogbnVsbCxcclxuICAgICAgICAgICAgX29yaWdpbkNzc1RleHQ6IGNvbnRleHQuZWxlbWVudC50b3BBcmVhLnN0eWxlLmNzc1RleHQsXHJcbiAgICAgICAgICAgIF9ib2R5T3ZlcmZsb3c6ICcnLFxyXG4gICAgICAgICAgICBfZWRpdG9yQXJlYU9yaWdpbkNzc1RleHQ6ICcnLFxyXG4gICAgICAgICAgICBfd3lzaXd5Z09yaWdpbkNzc1RleHQ6ICcnLFxyXG4gICAgICAgICAgICBfY29kZU9yaWdpbkNzc1RleHQ6ICcnLFxyXG4gICAgICAgICAgICBfc3RpY2t5OiBmYWxzZSxcclxuICAgICAgICAgICAgX2ltYWdlc0luZm86IFtdLFxyXG4gICAgICAgICAgICBfaW1hZ2VJbmRleDogMFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBJZiB0aGUgcGx1Z2luIGlzIG5vdCBhZGRlZCwgYWRkIHRoZSBwbHVnaW4gYW5kIGNhbGwgdGhlICdhZGQnIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIElmIHRoZSBwbHVnaW4gaXMgYWRkZWQgY2FsbCBjYWxsQmFjayBmdW5jdGlvbi5cclxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGx1Z2luTmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBwbHVnaW4gdG8gY2FsbFxyXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxCYWNrRnVuY3Rpb24gLSBGdW5jdGlvbiB0byBiZSBleGVjdXRlZCBpbW1lZGlhdGVseSBhZnRlciBtb2R1bGUgY2FsbFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNhbGxQbHVnaW46IGZ1bmN0aW9uIChwbHVnaW5OYW1lLCBjYWxsQmFja0Z1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5wbHVnaW5zW3BsdWdpbk5hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignW1NVTkVESVRPUi5jb3JlLmNhbGxQbHVnaW4uZmFpbF0gVGhlIGNhbGxlZCBwbHVnaW4gZG9lcyBub3QgZXhpc3Qgb3IgaXMgaW4gYW4gaW52YWxpZCBmb3JtYXQuIChwbHVnaW5OYW1lOlwiJyArIHBsdWdpbk5hbWUgKyAnXCIpJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuaW5pdFBsdWdpbnNbcGx1Z2luTmFtZV0pe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW5zW3BsdWdpbk5hbWVdLmFkZCh0aGlzLCB0aGlzLnBsdWdpbnNbcGx1Z2luTmFtZV0uYnV0dG9uRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRQbHVnaW5zW3BsdWdpbk5hbWVdID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNhbGxCYWNrRnVuY3Rpb24oKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gSWYgdGhlIG1vZHVsZSBpcyBub3QgYWRkZWQsIGFkZCB0aGUgbW9kdWxlIGFuZCBjYWxsIHRoZSAnYWRkJyBmdW5jdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7QXJyYXl9IG1vZHVsZUFycmF5IC0gbW9kdWxlIG9iamVjdCdzIEFycmF5IFtkaWFsb2csIHJlc2l6aW5nXVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFkZE1vZHVsZTogZnVuY3Rpb24gKG1vZHVsZUFycmF5KSB7XHJcbiAgICAgICAgICAgIGxldCBtb2R1bGVOYW1lID0gJyc7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBtb2R1bGVBcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbW9kdWxlTmFtZSA9IG1vZHVsZUFycmF5W2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGx1Z2luc1ttb2R1bGVOYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luc1ttb2R1bGVOYW1lXSA9IHV0aWwuY29weU9iaihtb2R1bGVBcnJheVtpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW5zW21vZHVsZU5hbWVdLmFkZCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBFbmFibGVkIHN1Ym1lbnVcclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBTdWJtZW51IGVsZW1lbnQgdG8gY2FsbFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN1Ym1lbnVPbjogZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3VibWVudU5hbWUgPSB0aGlzLl9zdWJtZW51TmFtZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWNvbW1hbmQnKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luc1tzdWJtZW51TmFtZV0ub24pIHRoaXMucGx1Z2luc1tzdWJtZW51TmFtZV0ub24uY2FsbCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3VibWVudSA9IGVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG4gICAgICAgICAgICB0aGlzLnN1Ym1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgICAgIHV0aWwuYWRkQ2xhc3MoZWxlbWVudCwgJ29uJyk7XHJcbiAgICAgICAgICAgIHRoaXMuc3VibWVudUFjdGl2ZUJ1dHRvbiA9IGVsZW1lbnQ7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBvdmVyTGVmdCA9IHRoaXMuY29udGV4dC5lbGVtZW50LnRvb2xiYXIub2Zmc2V0V2lkdGggLSAoZWxlbWVudC5wYXJlbnRFbGVtZW50Lm9mZnNldExlZnQgKyB0aGlzLnN1Ym1lbnUub2Zmc2V0V2lkdGgpO1xyXG4gICAgICAgICAgICBpZiAob3ZlckxlZnQgPCAwKSB0aGlzLnN1Ym1lbnUuc3R5bGUubGVmdCA9IG92ZXJMZWZ0ICsgJ3B4JztcclxuICAgICAgICAgICAgZWxzZSB0aGlzLnN1Ym1lbnUuc3R5bGUubGVmdCA9ICcxcHgnO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fYmluZGVkU3VibWVudU9mZiA9IHRoaXMuc3VibWVudU9mZi5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICBfZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9iaW5kZWRTdWJtZW51T2ZmLCBmYWxzZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIERpc2FibGUgc3VibWVudVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN1Ym1lbnVPZmY6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3VibWVudSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3VibWVudU5hbWUgPSAnJztcclxuICAgICAgICAgICAgICAgIHRoaXMuc3VibWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJtZW51ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlQ2xhc3ModGhpcy5zdWJtZW51QWN0aXZlQnV0dG9uLCAnb24nKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3VibWVudUFjdGl2ZUJ1dHRvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBfZC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9iaW5kZWRTdWJtZW51T2ZmKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyc09mZigpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBEaXNhYmxlIGNvbnRyb2xsZXIgaW4gZWRpdG9yIGFyZWEgKGxpbmsgYnV0dG9uLCBpbWFnZSByZXNpemUgYnV0dG9uKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNvbnRyb2xsZXJzT246IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3VtZW50c1tpXS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udHJvbGxlckFycmF5W2ldID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9iaW5kQ29udHJvbGxlcnNPZmYgPSB0aGlzLmNvbnRyb2xsZXJzT2ZmLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIF9kLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2JpbmRDb250cm9sbGVyc09mZiwgZmFsc2UpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBEaXNhYmxlIGNvbnRyb2xsZXIgaW4gZWRpdG9yIGFyZWEgKGxpbmsgYnV0dG9uLCBpbWFnZSByZXNpemUgYnV0dG9uKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNvbnRyb2xsZXJzT2ZmOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IHRoaXMuY29udHJvbGxlckFycmF5Lmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIGlmIChsZW4gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyQXJyYXlbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXJBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgX2QucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5fYmluZENvbnRyb2xsZXJzT2ZmKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBqYXZhc2NyaXB0IGV4ZWNDb21tYW5kXHJcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbW1hbmQgLSBqYXZhc2NyaXB0IGV4ZWNDb21tYW5kIGZ1bmN0aW9uIHByb3BlcnR5XHJcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBzaG93RGVmYXVsdFVJIC0gamF2YXNjcmlwdCBleGVjQ29tbWFuZCBmdW5jdGlvbiBwcm9wZXJ0eVxyXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSAtIGphdmFzY3JpcHQgZXhlY0NvbW1hbmQgZnVuY3Rpb24gcHJvcGVydHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNvbW1hbmQsIHNob3dEZWZhdWx0VUksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIF9kLmV4ZWNDb21tYW5kKGNvbW1hbmQsIHNob3dEZWZhdWx0VUksIChjb21tYW5kID09PSAnZm9ybWF0QmxvY2snID8gJzwnICsgdmFsdWUgKyAnPicgOiB2YWx1ZSkpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBGb2N1cyB0byB3eXNpd3lnIGFyZWFcclxuICAgICAgICAgKi9cclxuICAgICAgICBmb2N1czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBjb25zdCBjYXB0aW9uID0gdXRpbC5nZXRQYXJlbnRFbGVtZW50KHRoaXMuZ2V0U2VsZWN0aW9uTm9kZSgpLCAnZmlnY2FwdGlvbicpO1xyXG4gICAgICAgICAgICBpZiAoY2FwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY2FwdGlvbi5mb2N1cygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXZlbnQuX2ZpbmRCdXR0b25FZmZlY3RUYWcoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU2V0IGN1cnJlbnQgZWRpdG9yJ3MgcmFuZ2Ugb2JqZWN0XHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBzdGFydENvbiAtIFRoZSBzdGFydENvbnRhaW5lciBwcm9wZXJ0eSBvZiB0aGUgc2VsZWN0aW9uIG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gc3RhcnRPZmYgLSBUaGUgc3RhcnRPZmZzZXQgcHJvcGVydHkgb2YgdGhlIHNlbGVjdGlvbiBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbmRDb24gLSBUaGUgZW5kQ29udGFpbmVyIHByb3BlcnR5IG9mIHRoZSBzZWxlY3Rpb24gb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZW5kT2ZmIC0gVGhlIGVuZE9mZnNldCBwcm9wZXJ0eSBvZiB0aGUgc2VsZWN0aW9uIG9iamVjdC5cclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRSYW5nZTogZnVuY3Rpb24gKHN0YXJ0Q29uLCBzdGFydE9mZiwgZW5kQ29uLCBlbmRPZmYpIHtcclxuICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSBfZC5jcmVhdGVSYW5nZSgpO1xyXG4gICAgICAgICAgICByYW5nZS5zZXRTdGFydChzdGFydENvbiwgc3RhcnRPZmYpO1xyXG4gICAgICAgICAgICByYW5nZS5zZXRFbmQoZW5kQ29uLCBlbmRPZmYpO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gX3cuZ2V0U2VsZWN0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcykge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xyXG4gICAgICAgICAgICB0aGlzLl9lZGl0b3JSYW5nZSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBHZXQgY3VycmVudCBlZGl0b3IncyByYW5nZSBvYmplY3RcclxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFJhbmdlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl92YXJpYWJsZS5fcmFuZ2UgfHwgdGhpcy5fY3JlYXRlRGVmYXVsdFJhbmdlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEdldCBjdXJyZW50IHNlbGVjdCBub2RlXHJcbiAgICAgICAgICogQHJldHVybnMge05vZGV9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0U2VsZWN0aW9uTm9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdmFyaWFibGUuX3NlbGVjdGlvbk5vZGUgfHwgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuZmlyc3RDaGlsZDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU2F2aW5nIHRoZSByYW5nZSBvYmplY3QgYW5kIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbm9kZSBvZiBlZGl0b3JcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9lZGl0b3JSYW5nZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBfdy5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgaWYgKCF1dGlsLmdldFBhcmVudEVsZW1lbnQoc2VsZWN0aW9uLmZvY3VzTm9kZSwgJy5zdW4tZWRpdG9yLWlkLXd5c2l3eWcnKSkgcmV0dXJuO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IHJhbmdlID0gbnVsbDtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdGlvbk5vZGUgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbi5yYW5nZUNvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5fY3JlYXRlRGVmYXVsdFJhbmdlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3ZhcmlhYmxlLl9yYW5nZSA9IHJhbmdlO1xyXG5cclxuICAgICAgICAgICAgaWYgKHJhbmdlLmNvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uTm9kZSA9IHJhbmdlLmNvbW1vbkFuY2VzdG9yQ29udGFpbmVyO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uTm9kZSA9IHNlbGVjdGlvbi5leHRlbnROb2RlIHx8IHNlbGVjdGlvbi5hbmNob3JOb2RlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLl92YXJpYWJsZS5fc2VsZWN0aW9uTm9kZSA9IHNlbGVjdGlvbk5vZGU7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFJldHVybiB0aGUgcmFuZ2Ugb2JqZWN0IG9mIGVkaXRvcidzIGZpcnN0IGNoaWxkIG5vZGVcclxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2NyZWF0ZURlZmF1bHRSYW5nZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zdCByYW5nZSA9IF9kLmNyZWF0ZVJhbmdlKCk7XHJcbiAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KGNvbnRleHQuZWxlbWVudC53eXNpd3lnLmZpcnN0Q2hpbGQsIDApO1xyXG4gICAgICAgICAgICByYW5nZS5zZXRFbmQoY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuZmlyc3RDaGlsZCwgMCk7XHJcbiAgICAgICAgICAgIHJldHVybiByYW5nZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gUmV0dXJucyBhIFwiZm9ybWF0RWxlbWVudFwiKFAsIERJViwgSFsxLTZdLCBMSSkgYXJyYXkgZnJvbSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHJhbmdlLlxyXG4gICAgICAgICAqIEByZXR1cm5zIHtBcnJheX1cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRTZWxlY3RlZEZvcm1hdEVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxldCByYW5nZSA9IHRoaXMuZ2V0UmFuZ2UoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh1dGlsLmlzV3lzaXd5Z0RpdihyYW5nZS5zdGFydENvbnRhaW5lcikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuY2hpbGRyZW47XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFJhbmdlKGNoaWxkcmVuWzBdLCAwLCBjaGlsZHJlbltjaGlsZHJlbi5sZW5ndGggLSAxXSwgY2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoIC0gMV0udGV4dENvbnRlbnQubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5nZXRSYW5nZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzdGFydENvbiA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyO1xyXG4gICAgICAgICAgICBjb25zdCBlbmRDb24gPSByYW5nZS5lbmRDb250YWluZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbW1vbkNvbiA9IHJhbmdlLmNvbW1vbkFuY2VzdG9yQ29udGFpbmVyO1xyXG4gICAgICAgICAgICBjb25zdCByYW5nZUZvcm1hdEVsZW1lbnRzID0gW107XHJcblxyXG4gICAgICAgICAgICBpZiAoIXV0aWwuaXNXeXNpd3lnRGl2KGNvbW1vbkNvbikgJiYgIXV0aWwuaXNSYW5nZUZvcm1hdEVsZW1lbnQoY29tbW9uQ29uKSkgcmV0dXJuIFt1dGlsLmdldEZvcm1hdEVsZW1lbnQoY29tbW9uQ29uKV07XHJcblxyXG4gICAgICAgICAgICAvLyBnZXQgbGluZSBub2Rlc1xyXG4gICAgICAgICAgICBjb25zdCBsaW5lTm9kZXMgPSB1dGlsLmdldExpc3RDaGlsZHJlbihjb21tb25Db24sIGZ1bmN0aW9uIChjdXJyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbC5pc0Zvcm1hdEVsZW1lbnQoY3VycmVudCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHN0YXJ0Q29uID09PSBlbmRDb24pIHJldHVybiBsaW5lTm9kZXNbMF07XHJcblxyXG4gICAgICAgICAgICBsZXQgc3RhcnRMaW5lID0gdXRpbC5nZXRGb3JtYXRFbGVtZW50KHN0YXJ0Q29uKTtcclxuICAgICAgICAgICAgbGV0IGVuZExpbmUgPSB1dGlsLmdldEZvcm1hdEVsZW1lbnQoZW5kQ29uKTtcclxuICAgICAgICAgICAgbGV0IHN0YXJ0SWR4ID0gMDtcclxuICAgICAgICAgICAgbGV0IGVuZElkeCA9IDA7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gbGluZU5vZGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRMaW5lID09PSBsaW5lTm9kZXNbaV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydElkeCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSA9PT0gbGluZU5vZGVzW2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW5kSWR4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0SWR4OyBpIDw9IGVuZElkeDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICByYW5nZUZvcm1hdEVsZW1lbnRzLnB1c2gobGluZU5vZGVzW2ldKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJhbmdlRm9ybWF0RWxlbWVudHM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFJldHVybnMgYSBcInJhbmdlRm9ybWF0RWxlbWVudFwiKGJsb2NrcXVvdGUsIFRBQkxFLCBUUiwgVEQsIE9MLCBVTCwgUFJFKSBhcnJheSBmcm9tIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgcmFuZ2UuXHJcbiAgICAgICAgICogQHJldHVybnMge0FycmF5fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFNlbGVjdGVkUmFuZ2VGb3JtYXRFbGVtZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsZXQgcmFuZ2UgPSB0aGlzLmdldFJhbmdlKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAodXRpbC5pc1d5c2l3eWdEaXYocmFuZ2Uuc3RhcnRDb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGNvbnRleHQuZWxlbWVudC53eXNpd3lnLmNoaWxkcmVuO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRSYW5nZShjaGlsZHJlblswXSwgMCwgY2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoIC0gMV0sIGNoaWxkcmVuW2NoaWxkcmVuLmxlbmd0aCAtIDFdLnRleHRDb250ZW50Lmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMuZ2V0UmFuZ2UoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3Qgc3RhcnRDb24gPSByYW5nZS5zdGFydENvbnRhaW5lcjtcclxuICAgICAgICAgICAgY29uc3QgZW5kQ29uID0gcmFuZ2UuZW5kQ29udGFpbmVyO1xyXG4gICAgICAgICAgICBjb25zdCBjb21tb25Db24gPSByYW5nZS5jb21tb25BbmNlc3RvckNvbnRhaW5lcjtcclxuICAgICAgICAgICAgY29uc3QgcmFuZ2VGb3JtYXRFbGVtZW50cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgaWYgKHV0aWwuaXNSYW5nZUZvcm1hdEVsZW1lbnQoY29tbW9uQ29uKSkgcmV0dXJuIFtjb21tb25Db25dO1xyXG4gICAgICAgICAgICBpZiAoIXV0aWwuaXNXeXNpd3lnRGl2KGNvbW1vbkNvbikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gdXRpbC5nZXRSYW5nZUZvcm1hdEVsZW1lbnQoY29tbW9uQ29uKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbCA/IFtlbF0gOiBbXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gZ2V0IHJhbmdlIEVsZW1lbnRzXHJcbiAgICAgICAgICAgIGNvbnN0IHJhbmdlRWxlbWVudHMgPSB1dGlsLmdldExpc3RDaGlsZHJlbihjb21tb25Db24sIGZ1bmN0aW9uIChjdXJyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbC5pc1JhbmdlRm9ybWF0RWxlbWVudChjdXJyZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc3RhcnRDb24gPT09IGVuZENvbikgcmV0dXJuIHJhbmdlRWxlbWVudHNbMF07XHJcblxyXG4gICAgICAgICAgICBsZXQgc3RhcnRMaW5lID0gdXRpbC5nZXRSYW5nZUZvcm1hdEVsZW1lbnQoc3RhcnRDb24pO1xyXG4gICAgICAgICAgICBsZXQgZW5kTGluZSA9IHV0aWwuZ2V0UmFuZ2VGb3JtYXRFbGVtZW50KGVuZENvbik7XHJcbiAgICAgICAgICAgIGxldCBzdGFydElkeCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBlbmRJZHggPSAwO1xyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHJhbmdlRWxlbWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChzdGFydExpbmUgPT09IHJhbmdlRWxlbWVudHNbaV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydElkeCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSA9PT0gcmFuZ2VFbGVtZW50c1tpXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVuZElkeCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydElkeDsgaSA8PSBlbmRJZHg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhbmdlRWxlbWVudHNbaV0pIHJhbmdlRm9ybWF0RWxlbWVudHMucHVzaChyYW5nZUVsZW1lbnRzW2ldKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJhbmdlRm9ybWF0RWxlbWVudHM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIERldGVybWluZSBpZiB0aGlzIG9mZnNldCBpcyB0aGUgZWRnZSBvZmZzZXQgb2YgY29udGFpbmVyXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGNvbnRhaW5lciAtIFRoZSBjb250YWluZXIgcHJvcGVydHkgb2YgdGhlIHNlbGVjdGlvbiBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQgcHJvcGVydHkgb2YgdGhlIHNlbGVjdGlvbiBvYmplY3QuXHJcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaXNFZGdlUG9pbnQ6IGZ1bmN0aW9uIChjb250YWluZXIsIG9mZnNldCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKG9mZnNldCA9PT0gMCkgfHwgKG9mZnNldCA9PT0gY29udGFpbmVyLm5vZGVWYWx1ZS5sZW5ndGgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBTaG93IGxvYWRpbmcgYm94XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2hvd0xvYWRpbmc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LmxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIENsb3NlIGxvYWRpbmcgYm94XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xvc2VMb2FkaW5nOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5sb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFwcGVuZCBmb3JtYXQgZWxlbWVudCB0byBzaWJsaW5nIG5vZGUgb2YgYXJndW1lbnQgZWxlbWVudC5cclxuICAgICAgICAgKiBJZiB0aGUgXCJmb3JtYXROb2RlTmFtZVwiIGFyZ3VtZW50IHZhbHVlIGlzIHByZXNlbnQsIHRoZSB0YWcgb2YgdGhhdCBhcmd1bWVudCB2YWx1ZSBpcyBpbnNlcnRlZCxcclxuICAgICAgICAgKiBJZiBub3QsIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgZm9ybWF0IHRhZyBpcyBpbnNlcnRlZC5cclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBJbnNlcnQgYXMgc2libGluZ3Mgb2YgdGhhdCBlbGVtZW50XHJcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd8bnVsbH0gZm9ybWF0Tm9kZU5hbWUgLSBOb2RlIG5hbWUgdG8gYmUgaW5zZXJ0ZWRcclxuICAgICAgICAgKiBAcmV0dXJucyB7RWxlbWVudH1cclxuICAgICAgICAgKi9cclxuICAgICAgICBhcHBlbmRGb3JtYXRUYWc6IGZ1bmN0aW9uIChlbGVtZW50LCBmb3JtYXROb2RlTmFtZSkge1xyXG4gICAgICAgICAgICBjb25zdCBmb3JtYXRFbCA9IHV0aWwuZ2V0UmFuZ2VGb3JtYXRFbGVtZW50KGVsZW1lbnQpIHx8IHV0aWwuZ2V0Rm9ybWF0RWxlbWVudChlbGVtZW50KTtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudEZvcm1hdEVsID0gdXRpbC5nZXRGb3JtYXRFbGVtZW50KHRoaXMuZ2V0U2VsZWN0aW9uTm9kZSgpKTtcclxuICAgICAgICAgICAgY29uc3Qgb0Zvcm1hdE5hbWUgPSBmb3JtYXROb2RlTmFtZSA/IGZvcm1hdE5vZGVOYW1lIDogdXRpbC5pc0Zvcm1hdEVsZW1lbnQoY3VycmVudEZvcm1hdEVsKSA/IGN1cnJlbnRGb3JtYXRFbC5ub2RlTmFtZSA6ICdQJztcclxuICAgICAgICAgICAgY29uc3Qgb0Zvcm1hdCA9IHV0aWwuY3JlYXRlRWxlbWVudChvRm9ybWF0TmFtZSk7XHJcbiAgICAgICAgICAgIG9Gb3JtYXQuaW5uZXJIVE1MID0gdXRpbC56ZXJvV2lkdGhTcGFjZTtcclxuXHJcbiAgICAgICAgICAgIGlmICh1dGlsLmlzQ2VsbChmb3JtYXRFbCkpIGZvcm1hdEVsLmluc2VydEJlZm9yZShvRm9ybWF0LCBlbGVtZW50Lm5leHRFbGVtZW50U2libGluZyk7XHJcbiAgICAgICAgICAgIGVsc2UgZm9ybWF0RWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUob0Zvcm1hdCwgZm9ybWF0RWwubmV4dEVsZW1lbnRTaWJsaW5nKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBvRm9ybWF0O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBEZWxldGUgc2VsZWN0ZWQgbm9kZSBhbmQgaW5zZXJ0IGFyZ3VtZW50IHZhbHVlIG5vZGVcclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG9Ob2RlIC0gTm9kZSB0byBiZSBpbnNlcnRlZFxyXG4gICAgICAgICAqIEBwYXJhbSB7KEVsZW1lbnR8bnVsbCl9IHJpZ2h0Tm9kZSAtIElmIHRoZSBub2RlIGV4aXN0cywgaXQgaXMgaW5zZXJ0ZWQgYWZ0ZXIgdGhlIG5vZGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbnNlcnROb2RlOiBmdW5jdGlvbiAob05vZGUsIHJpZ2h0Tm9kZSkge1xyXG4gICAgICAgICAgICBjb25zdCByYW5nZSA9IHRoaXMuZ2V0UmFuZ2UoKTtcclxuICAgICAgICAgICAgbGV0IHBhcmVudE5vZGUgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFyaWdodE5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0Q29uID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydE9mZiA9IHJhbmdlLnN0YXJ0T2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5kQ29uID0gcmFuZ2UuZW5kQ29udGFpbmVyO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5kT2ZmID0gcmFuZ2UuZW5kT2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29tbW9uQ29uID0gcmFuZ2UuY29tbW9uQW5jZXN0b3JDb250YWluZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZSA9IHN0YXJ0Q29uO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0Q29uLm5vZGVUeXBlID09PSAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZSA9IHN0YXJ0Q29uLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqIE5vIFNlbGVjdCByYW5nZSBub2RlICovXHJcbiAgICAgICAgICAgICAgICBpZiAocmFuZ2UuY29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1vbkNvbi5ub2RlVHlwZSA9PT0gMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByaWdodE5vZGUgPSBjb21tb25Db24uc3BsaXRUZXh0KGVuZE9mZik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Tm9kZS5sYXN0Q2hpbGQgIT09IG51bGwgJiYgdXRpbC5pc0JyZWFrKHBhcmVudE5vZGUubGFzdENoaWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZChwYXJlbnROb2RlLmxhc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHROb2RlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvKiogU2VsZWN0IHJhbmdlIG5vZGVzICovXHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1NhbWVDb250YWluZXIgPSBzdGFydENvbiA9PT0gZW5kQ29uO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTYW1lQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRWRnZVBvaW50KGVuZENvbiwgZW5kT2ZmKSkgcmlnaHROb2RlID0gZW5kQ29uLm5leHRTaWJsaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHJpZ2h0Tm9kZSA9IGVuZENvbi5zcGxpdFRleHQoZW5kT2ZmKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZW1vdmVOb2RlID0gc3RhcnRDb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0VkZ2VQb2ludChzdGFydENvbiwgc3RhcnRPZmYpKSByZW1vdmVOb2RlID0gc3RhcnRDb24uc3BsaXRUZXh0KHN0YXJ0T2ZmKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocmVtb3ZlTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZU5vZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZSA9IGNvbW1vbkNvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHROb2RlID0gZW5kQ29uO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHJpZ2h0Tm9kZS5wYXJlbnROb2RlICE9PSBjb21tb25Db24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0Tm9kZSA9IHJpZ2h0Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZSA9IHJpZ2h0Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgcmlnaHROb2RlID0gcmlnaHROb2RlLm5leHRTaWJsaW5nO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUob05vZGUsIHJpZ2h0Tm9kZSk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuYXBwZW5kQ2hpbGQob05vZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIERlbGV0ZSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIG5vZGVcclxuICAgICAgICAgKi9cclxuICAgICAgICByZW1vdmVOb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5nZXRSYW5nZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHJhbmdlLmRlbGV0ZUNvbnRlbnRzKSB7XHJcbiAgICAgICAgICAgICAgICByYW5nZS5kZWxldGVDb250ZW50cygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzdGFydENvbiA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyO1xyXG4gICAgICAgICAgICBjb25zdCBzdGFydE9mZiA9IHJhbmdlLnN0YXJ0T2Zmc2V0O1xyXG4gICAgICAgICAgICBjb25zdCBlbmRDb24gPSByYW5nZS5lbmRDb250YWluZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZE9mZiA9IHJhbmdlLmVuZE9mZnNldDtcclxuICAgICAgICAgICAgY29uc3QgY29tbW9uQ29uID0gcmFuZ2UuY29tbW9uQW5jZXN0b3JDb250YWluZXI7XHJcblxyXG4gICAgICAgICAgICBsZXQgYmVmb3JlTm9kZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGxldCBhZnRlck5vZGUgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2hpbGROb2RlcyA9IHV0aWwuZ2V0TGlzdENoaWxkTm9kZXMoY29tbW9uQ29uKTtcclxuICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSB1dGlsLmdldEFycmF5SW5kZXgoY2hpbGROb2Rlcywgc3RhcnRDb24pO1xyXG4gICAgICAgICAgICBsZXQgZW5kSW5kZXggPSB1dGlsLmdldEFycmF5SW5kZXgoY2hpbGROb2RlcywgZW5kQ29uKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydEluZGV4ICsgMSwgc3RhcnROb2RlID0gc3RhcnRDb247IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGROb2Rlc1tpXSA9PT0gc3RhcnROb2RlLnBhcmVudE5vZGUgJiYgY2hpbGROb2Rlc1tpXS5maXJzdENoaWxkID09PSBzdGFydE5vZGUgJiYgc3RhcnRPZmYgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydE5vZGUgPSBzdGFydE5vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGVuZEluZGV4IC0gMSwgZW5kTm9kZSA9IGVuZENvbjsgaSA+IHN0YXJ0SW5kZXg7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkTm9kZXNbaV0gPT09IGVuZE5vZGUucGFyZW50Tm9kZSAmJiBjaGlsZE5vZGVzW2ldLm5vZGVUeXBlID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGROb2Rlcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZW5kTm9kZSA9IGVuZE5vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAtLWVuZEluZGV4O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRJbmRleDsgaSA8PSBlbmRJbmRleDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gY2hpbGROb2Rlc1tpXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5sZW5ndGggPT09IDAgfHwgKGl0ZW0ubm9kZVR5cGUgPT09IDMgJiYgaXRlbS5kYXRhID09PSB1bmRlZmluZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC5yZW1vdmVJdGVtKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpdGVtID09PSBzdGFydENvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGFydENvbi5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVOb2RlID0gdXRpbC5jcmVhdGVUZXh0Tm9kZShzdGFydENvbi50ZXh0Q29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmVmb3JlTm9kZSA9IHV0aWwuY3JlYXRlVGV4dE5vZGUoc3RhcnRDb24uc3Vic3RyaW5nRGF0YSgwLCBzdGFydE9mZikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJlZm9yZU5vZGUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydENvbi5kYXRhID0gYmVmb3JlTm9kZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlSXRlbShzdGFydENvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PT0gZW5kQ29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZENvbi5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlck5vZGUgPSB1dGlsLmNyZWF0ZVRleHROb2RlKGVuZENvbi50ZXh0Q29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXJOb2RlID0gdXRpbC5jcmVhdGVUZXh0Tm9kZShlbmRDb24uc3Vic3RyaW5nRGF0YShlbmRPZmYsIChlbmRDb24ubGVuZ3RoIC0gZW5kT2ZmKSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFmdGVyTm9kZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZENvbi5kYXRhID0gYWZ0ZXJOb2RlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbC5yZW1vdmVJdGVtKGVuZENvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB1dGlsLnJlbW92ZUl0ZW0oaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gYXBwZW5kZWQgYWxsIHNlbGVjdGVkIGZvcm1hdCBFbGVtZW50IHRvIHRoZSBhcmd1bWVudCBlbGVtZW50IGFuZCBpbnNlcnRcclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHdyYXBUYWcgLSBFbGVtZW50IG9mIHdyYXAgdGhlIGFyZ3VtZW50c1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHdyYXBUb1RhZ3M6IGZ1bmN0aW9uICh3cmFwVGFnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5nZXRSYW5nZSgpO1xyXG4gICAgICAgICAgICBjb25zdCByYW5nZUxpbmVzID0gdGhpcy5nZXRTZWxlY3RlZEZvcm1hdEVsZW1lbnRzKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXJhbmdlTGluZXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlubmVyID0gdXRpbC5jcmVhdGVFbGVtZW50KHV0aWwuaXNDZWxsKHRoaXMuZ2V0U2VsZWN0aW9uTm9kZSgpKSA/ICdESVYnIDogJ1AnKTtcclxuICAgICAgICAgICAgICAgIGlubmVyLmlubmVySFRNTCA9IHV0aWwuemVyb1dpZHRoU3BhY2U7XHJcbiAgICAgICAgICAgICAgICB3cmFwVGFnLmFwcGVuZENoaWxkKGlubmVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2VsZWN0aW9uTm9kZSgpLmFwcGVuZENoaWxkKHdyYXBUYWcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgbGFzdCAgPSByYW5nZUxpbmVzW3JhbmdlTGluZXMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGxldCBzdGFuZFRhZywgYmVmb3JlVGFnLCBwRWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgIGlmICh1dGlsLmlzUmFuZ2VGb3JtYXRFbGVtZW50KGxhc3QpIHx8IHV0aWwuaXNGb3JtYXRFbGVtZW50KGxhc3QpKSB7XHJcbiAgICAgICAgICAgICAgICBzdGFuZFRhZyA9IGxhc3Q7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdGFuZFRhZyA9IHV0aWwuZ2V0UmFuZ2VGb3JtYXRFbGVtZW50KGxhc3QpIHx8IHV0aWwuZ2V0Rm9ybWF0RWxlbWVudChsYXN0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHV0aWwuaXNDZWxsKHN0YW5kVGFnKSkge1xyXG4gICAgICAgICAgICAgICAgYmVmb3JlVGFnID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHBFbGVtZW50ID0gc3RhbmRUYWc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBiZWZvcmVUYWcgPSBzdGFuZFRhZy5uZXh0U2libGluZztcclxuICAgICAgICAgICAgICAgIHBFbGVtZW50ID0gc3RhbmRUYWcucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IGxpc3RQYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICBsZXQgbGluZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGxldCBwcmV2Tm9kZU5hbWUgPSAnJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSByYW5nZUxpbmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBsaW5lID0gcmFuZ2VMaW5lc1tpXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoL15MSSQvaS50ZXN0KGxpbmUubm9kZU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RQYXJlbnQgPT09IG51bGwgfHwgIS9eTEkkL2kudGVzdChwcmV2Tm9kZU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RQYXJlbnQgPSB1dGlsLmNyZWF0ZUVsZW1lbnQobGluZS5wYXJlbnROb2RlLm5vZGVOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxpc3RQYXJlbnQuYXBwZW5kQ2hpbGQobGluZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IGxlbiAtIDEgfHwgIS9eTEkkL2kudGVzdChyYW5nZUxpbmVzW2kgKyAxXS5ub2RlTmFtZSkpIHdyYXBUYWcuYXBwZW5kQ2hpbGQobGlzdFBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB3cmFwVGFnLmFwcGVuZENoaWxkKGxpbmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHByZXZOb2RlTmFtZSA9IGxpbmUubm9kZU5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHBFbGVtZW50Lmluc2VydEJlZm9yZSh3cmFwVGFnLCBiZWZvcmVUYWcpO1xyXG4gICAgICAgICAgICBpZiAoIXJhbmdlLmNvbGxhcHNlZCAmJiAodXRpbC5pc1JhbmdlRm9ybWF0RWxlbWVudChyYW5nZS5zdGFydENvbnRhaW5lcikgfHwgdXRpbC5pc1JhbmdlRm9ybWF0RWxlbWVudChyYW5nZS5lbmRDb250YWluZXIpKSkgdXRpbC5yZW1vdmVFbXB0eU5vZGUocEVsZW1lbnQpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGQgdGhlIG5vZGUgcmVjZWl2ZWQgYXMgYW4gYXJndW1lbnQgdmFsdWUgdG8gdGhlIHNlbGVjdGVkIGFyZWEuXHJcbiAgICAgICAgICogMS4gV2hlbiB0aGVyZSBpcyB0aGUgc2FtZSBjc3MgdmFsdWUgbm9kZSBpbiB0aGUgc2VsZWN0aW9uIGFyZWEsIHRoZSB0YWcgaXMgc3RyaXBwZWQuXHJcbiAgICAgICAgICogMi4gSWYgdGhlcmUgaXMgYW5vdGhlciBjc3MgdmFsdWUgb3RoZXIgdGhhbkNzcyBhdHRyaWJ1dGUgdmFsdWVzIHJlY2VpdmVkIGFzIGFyZ3VtZW50cyBvbiB0aGUgbm9kZSwgcmVtb3ZlZCBvbmx5IENzcyBhdHRyaWJ1dGUgdmFsdWVzIHJlY2VpdmVkIGFzIGFyZ3VtZW50c1xyXG4gICAgICAgICAqIDMuIElmIHlvdSBwYXNzIGFuIGVsZW1lbnQgd2hvc2Ugbm9kZSBuYW1lIGlzIFwicmVtb3Zlbm9kZVwiIGFzIGFuIGFyZ3VtZW50IHZhbHVlLCBpdCBwZXJmb3JtcyBhIHR5cGUgcmVtb3ZhbCBvcGVyYXRpb24uIGV4KSBub2RlQ2hhbmdlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3JlbW92ZW5vZGUnKSlcclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGFwcGVuZE5vZGUgLSBUaGUgZG9tIHRoYXQgd2lsbCB3cmFwIHRoZSBzZWxlY3RlZCB0ZXh0IGFyZWFcclxuICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBjaGVja0NTU1Byb3BlcnR5QXJyYXkgLSBUaGUgY3NzIGF0dHJpYnV0ZSBuYW1lIEFycmF5IHRvIGNoZWNrIChbJ2ZvbnQtc2l6ZSddLCBbJ2ZvbnQtZmFtaWx5JywgJ2JhY2tncm91bmQtY29sb3InLCAnYm9yZGVyJ10uLi5dKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG5vZGVDaGFuZ2U6IGZ1bmN0aW9uIChhcHBlbmROb2RlLCBjaGVja0NTU1Byb3BlcnR5QXJyYXkpIHtcclxuICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSB0aGlzLmdldFJhbmdlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzUmVtb3ZlRm9ybWF0ID0gL3JlbW92ZW5vZGUvaS50ZXN0KGFwcGVuZE5vZGUubm9kZU5hbWUpO1xyXG4gICAgICAgICAgICBsZXQgdGVtcENvbiwgdGVtcE9mZnNldCwgdGVtcENoaWxkLCB0ZW1wQXJyYXk7XHJcblxyXG4gICAgICAgICAgICAvKiBjaGVja2VkIHNhbWUgc3R5bGUgcHJvcGVydHkgKi9cclxuICAgICAgICAgICAgaWYgKHJhbmdlLnN0YXJ0Q29udGFpbmVyID09PSByYW5nZS5lbmRDb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBzTm9kZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUmVtb3ZlRm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWwuZ2V0Rm9ybWF0RWxlbWVudChzTm9kZSkgPT09IHNOb2RlLnBhcmVudE5vZGUpIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNoZWNrQ250ID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGVja0NTU1Byb3BlcnR5QXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoIXV0aWwuaXNGb3JtYXRFbGVtZW50KHNOb2RlKSAmJiAhdXRpbC5pc1d5c2l3eWdEaXYoc05vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc05vZGUubm9kZVR5cGUgPT09IDEgJiYgc05vZGUuc3R5bGVbY2hlY2tDU1NQcm9wZXJ0eUFycmF5W2ldXSA9PT0gYXBwZW5kTm9kZS5zdHlsZVtjaGVja0NTU1Byb3BlcnR5QXJyYXlbaV1dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tDbnQrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNOb2RlID0gc05vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja0NudCA+PSBjaGVja0NTU1Byb3BlcnR5QXJyYXkubGVuZ3RoKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qIGZpbmQgdGV4dCBub2RlICovXHJcbiAgICAgICAgICAgIC8vIHN0YXJ0Q29udGFpbmVyXHJcbiAgICAgICAgICAgIHRlbXBDb24gPSB1dGlsLmlzV3lzaXd5Z0RpdihyYW5nZS5zdGFydENvbnRhaW5lcikgPyBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5maXJzdENoaWxkIDogcmFuZ2Uuc3RhcnRDb250YWluZXI7XHJcbiAgICAgICAgICAgIHRlbXBPZmZzZXQgPSByYW5nZS5zdGFydE9mZnNldDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0ZW1wQ29uLm5vZGVUeXBlID09PSAxICYmIHRlbXBDb24uY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodGVtcENvbiAmJiAhdXRpbC5pc0JyZWFrKHRlbXBDb24pICYmIHRlbXBDb24ubm9kZVR5cGUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wQXJyYXkgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wQ2hpbGQgPSB0ZW1wQ29uLmNoaWxkTm9kZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHRlbXBDaGlsZC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wQXJyYXkucHVzaCh0ZW1wQ2hpbGRbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ZW1wQ29uID0gdGVtcEFycmF5W3RlbXBPZmZzZXRdIHx8IHRlbXBDb24ubmV4dEVsZW1lbnRTaWJsaW5nIHx8IHRlbXBDb24ubmV4dFNpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcE9mZnNldCA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHV0aWwuaXNCcmVhayh0ZW1wQ29uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVtcHR5VGV4dCA9IHV0aWwuY3JlYXRlVGV4dE5vZGUodXRpbC56ZXJvV2lkdGhTcGFjZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcENvbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbXB0eVRleHQsIHRlbXBDb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBDb24gPSBlbXB0eVRleHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0Q29uID0gdGVtcENvbjtcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnRPZmYgPSB0ZW1wT2Zmc2V0O1xyXG5cclxuICAgICAgICAgICAgLy8gZW5kQ29udGFpbmVyXHJcbiAgICAgICAgICAgIHRlbXBDb24gPSB1dGlsLmlzV3lzaXd5Z0RpdihyYW5nZS5lbmRDb250YWluZXIpID8gY29udGV4dC5lbGVtZW50Lnd5c2l3eWcubGFzdENoaWxkIDogcmFuZ2UuZW5kQ29udGFpbmVyO1xyXG4gICAgICAgICAgICB0ZW1wT2Zmc2V0ID0gcmFuZ2UuZW5kT2Zmc2V0O1xyXG5cclxuICAgICAgICAgICAgaWYgKHRlbXBDb24ubm9kZVR5cGUgPT09IDEgJiYgdGVtcENvbi5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0ZW1wQ29uICYmICF1dGlsLmlzQnJlYWsodGVtcENvbikgJiYgdGVtcENvbi5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBDaGlsZCA9IHRlbXBDb24uY2hpbGROb2RlcztcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gdGVtcENoaWxkLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBBcnJheS5wdXNoKHRlbXBDaGlsZFtpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBDb24gPSB0ZW1wQXJyYXlbdGVtcE9mZnNldCAtIDFdIHx8ICEvRklHVVJFL2kudGVzdCh0ZW1wQXJyYXlbMF0ubm9kZU5hbWUpID8gdGVtcEFycmF5WzBdIDogKHRlbXBDb24ucHJldmlvdXNFbGVtZW50U2libGluZyB8fCB0ZW1wQ29uLnByZXZpb3VzU2libGluZyB8fCBzdGFydENvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0ZW1wT2Zmc2V0ID0gdGVtcENvbi50ZXh0Q29udGVudC5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHV0aWwuaXNCcmVhayh0ZW1wQ29uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVtcHR5VGV4dCA9IHV0aWwuY3JlYXRlVGV4dE5vZGUodXRpbC56ZXJvV2lkdGhTcGFjZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcENvbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbXB0eVRleHQsIHRlbXBDb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBDb24gPSBlbXB0eVRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcE9mZnNldCA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGVuZENvbiA9IHRlbXBDb247XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZE9mZiA9IHRlbXBPZmZzZXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbW1vbkNvbiA9IHJhbmdlLmNvbW1vbkFuY2VzdG9yQ29udGFpbmVyO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdOb2RlTmFtZSA9IGFwcGVuZE5vZGUubm9kZU5hbWU7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UmFuZ2Uoc3RhcnRDb24sIHN0YXJ0T2ZmLCBlbmRDb24sIGVuZE9mZik7XHJcblxyXG4gICAgICAgICAgICBsZXQgc3RhcnQgPSB7fSwgZW5kID0ge307XHJcbiAgICAgICAgICAgIGxldCBuZXdOb2RlLCByZWdFeHA7XHJcblxyXG4gICAgICAgICAgICBpZiAoY2hlY2tDU1NQcm9wZXJ0eUFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICByZWdFeHAgPSAnKD86O3xefFxcXFxzKSg/OicgKyBjaGVja0NTU1Byb3BlcnR5QXJyYXlbMF07XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGNoZWNrQ1NTUHJvcGVydHlBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZ0V4cCArPSAnfCcgKyBjaGVja0NTU1Byb3BlcnR5QXJyYXlbaV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZWdFeHAgKz0gJylcXFxccyo6W147XSpcXFxccyooPzo7fCQpJztcclxuICAgICAgICAgICAgICAgIHJlZ0V4cCA9IG5ldyBSZWdFeHAocmVnRXhwLCAnaWcnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLyoqIHRhZyBjaGVjayBmdW5jdGlvbiovXHJcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrQ3NzID0gZnVuY3Rpb24gKHZOb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNSZW1vdmVGb3JtYXQgfHwgdk5vZGUubm9kZVR5cGUgPT09IDMgfHwgdXRpbC5pc0JyZWFrKHZOb2RlKSkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHN0eWxlID0gJyc7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVnRXhwICYmIHZOb2RlLnN0eWxlLmNzc1RleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlID0gdk5vZGUuc3R5bGUuY3NzVGV4dC5yZXBsYWNlKHJlZ0V4cCwgJycpLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUubGVuZ3RoID4gMCB8fCB2Tm9kZS5ub2RlTmFtZSAhPT0gbmV3Tm9kZU5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodk5vZGUuc3R5bGUuY3NzVGV4dC5sZW5ndGggPiAwKSB2Tm9kZS5zdHlsZS5jc3NUZXh0ID0gc3R5bGU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLyoqIG9uZSBsaW5lICovXHJcbiAgICAgICAgICAgIGlmICghdXRpbC5pc1d5c2l3eWdEaXYoY29tbW9uQ29uKSAmJiAhdXRpbC5pc1JhbmdlRm9ybWF0RWxlbWVudChjb21tb25Db24pKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdOb2RlID0gYXBwZW5kTm9kZS5jbG9uZU5vZGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UmFuZ2UgPSB0aGlzLl9ub2RlQ2hhbmdlX29uZUxpbmUodXRpbC5nZXRGb3JtYXRFbGVtZW50KGNvbW1vbkNvbiksIG5ld05vZGUsIGNoZWNrQ3NzLCBzdGFydENvbiwgc3RhcnRPZmYsIGVuZENvbiwgZW5kT2ZmLCBpc1JlbW92ZUZvcm1hdCwgcmFuZ2UuY29sbGFwc2VkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzdGFydC5jb250YWluZXIgPSBuZXdSYW5nZS5zdGFydENvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgIHN0YXJ0Lm9mZnNldCA9IG5ld1JhbmdlLnN0YXJ0T2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgZW5kLmNvbnRhaW5lciA9IG5ld1JhbmdlLmVuZENvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgIGVuZC5vZmZzZXQgPSBuZXdSYW5nZS5lbmRPZmZzZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLyoqIG11bHRpIGxpbmUgKi9cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgbGluZSBub2Rlc1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZU5vZGVzID0gdGhpcy5nZXRTZWxlY3RlZEZvcm1hdEVsZW1lbnRzKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRMZW5ndGggPSBsaW5lTm9kZXMubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzdGFydENvblxyXG4gICAgICAgICAgICAgICAgbmV3Tm9kZSA9IGFwcGVuZE5vZGUuY2xvbmVOb2RlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHN0YXJ0ID0gdGhpcy5fbm9kZUNoYW5nZV9zdGFydExpbmUobGluZU5vZGVzWzBdLCBuZXdOb2RlLCBjaGVja0Nzcywgc3RhcnRDb24sIHN0YXJ0T2ZmLCBpc1JlbW92ZUZvcm1hdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbWlkXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGVuZExlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IGFwcGVuZE5vZGUuY2xvbmVOb2RlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9ub2RlQ2hhbmdlX21pZGRsZUxpbmUobGluZU5vZGVzW2ldLCBuZXdOb2RlLCBjaGVja0NzcywgaXNSZW1vdmVGb3JtYXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGVuZENvblxyXG4gICAgICAgICAgICAgICAgaWYgKGVuZExlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gYXBwZW5kTm9kZS5jbG9uZU5vZGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IHRoaXMuX25vZGVDaGFuZ2VfZW5kTGluZShsaW5lTm9kZXNbZW5kTGVuZ3RoXSwgbmV3Tm9kZSwgY2hlY2tDc3MsIGVuZENvbiwgZW5kT2ZmLCBpc1JlbW92ZUZvcm1hdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IHN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBzZXQgcmFuZ2VcclxuICAgICAgICAgICAgdGhpcy5zZXRSYW5nZShzdGFydC5jb250YWluZXIsIHN0YXJ0Lm9mZnNldCwgZW5kLmNvbnRhaW5lciwgZW5kLm9mZnNldCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIHdyYXBzIHRleHQgbm9kZXMgb2YgbGluZSBzZWxlY3RlZCB0ZXh0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSBub2RlIG9mIHRoZSBsaW5lIHRoYXQgY29udGFpbnMgdGhlIHNlbGVjdGVkIHRleHQgbm9kZS5cclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG5ld0lubmVyTm9kZSAtIFRoZSBkb20gdGhhdCB3aWxsIHdyYXAgdGhlIHNlbGVjdGVkIHRleHQgYXJlYVxyXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHZhbGlkYXRpb24gLSBDaGVjayBpZiB0aGUgbm9kZSBzaG91bGQgYmUgc3RyaXBwZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBzdGFydENvbiAtIFRoZSBzdGFydENvbnRhaW5lciBwcm9wZXJ0eSBvZiB0aGUgc2VsZWN0aW9uIG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gc3RhcnRPZmYgLSBUaGUgc3RhcnRPZmZzZXQgcHJvcGVydHkgb2YgdGhlIHNlbGVjdGlvbiBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbmRDb24gLSBUaGUgZW5kQ29udGFpbmVyIHByb3BlcnR5IG9mIHRoZSBzZWxlY3Rpb24gb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlbmRPZmYgLSBUaGUgZW5kT2Zmc2V0IHByb3BlcnR5IG9mIHRoZSBzZWxlY3Rpb24gb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZW1vdmVGb3JtYXQgLSBJcyB0aGUgcmVtb3ZlIGZvcm1hdCBjb21tYW5kID9cclxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGNvbGxhcHNlZCAtIHJhbmdlLmNvbGxhcHNlZFxyXG4gICAgICAgICAqIEByZXR1cm5zIHt7c3RhcnRDb250YWluZXI6ICosIHN0YXJ0T2Zmc2V0OiAqLCBlbmRDb250YWluZXI6ICosIGVuZE9mZnNldDogKn19XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfbm9kZUNoYW5nZV9vbmVMaW5lOiBmdW5jdGlvbiAoZWxlbWVudCwgbmV3SW5uZXJOb2RlLCB2YWxpZGF0aW9uLCBzdGFydENvbiwgc3RhcnRPZmYsIGVuZENvbiwgZW5kT2ZmLCBpc1JlbW92ZUZvcm1hdCwgY29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3QgcE5vZGUgPSBlbGVtZW50LmNsb25lTm9kZShmYWxzZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzU2FtZU5vZGUgPSBzdGFydENvbiA9PT0gZW5kQ29uO1xyXG4gICAgICAgICAgICBsZXQgc3RhcnRDb250YWluZXIgPSBzdGFydENvbjtcclxuICAgICAgICAgICAgbGV0IHN0YXJ0T2Zmc2V0ID0gc3RhcnRPZmY7XHJcbiAgICAgICAgICAgIGxldCBlbmRDb250YWluZXIgPSBlbmRDb247XHJcbiAgICAgICAgICAgIGxldCBlbmRPZmZzZXQgPSBlbmRPZmY7XHJcbiAgICAgICAgICAgIGxldCBzdGFydFBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgbGV0IGVuZFBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgbGV0IHBDdXJyZW50LCBuZXdOb2RlLCBhcHBlbmROb2RlLCBjc3NUZXh0O1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tDc3MgKHZOb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWdFeHAgPSBuZXcgUmVnRXhwKCcoPzo7fF58XFxcXHMpKD86JyArIGNzc1RleHQgKyAnbnVsbClcXFxccyo6W147XSpcXFxccyooPzo7fCQpJywgJ2lnJyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3R5bGUgPSAnJztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmVnRXhwICYmIHZOb2RlLnN0eWxlLmNzc1RleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlID0gcmVnRXhwLnRlc3Qodk5vZGUuc3R5bGUuY3NzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFzdHlsZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKGZ1bmN0aW9uIHJlY3Vyc2lvbkZ1bmMoY3VycmVudCwgbm9kZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGROb2RlcyA9IGN1cnJlbnQuY2hpbGROb2RlcztcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gY2hpbGROb2Rlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjaGlsZCA9IGNoaWxkTm9kZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvdmVyTm9kZSA9IG5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNsb25lTm9kZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnRDb250YWluZXJcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0UGFzcyAmJiBjaGlsZCA9PT0gc3RhcnRDb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldk5vZGUgPSB1dGlsLmNyZWF0ZVRleHROb2RlKHN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlID09PSAxID8gJycgOiBzdGFydENvbnRhaW5lci5zdWJzdHJpbmdEYXRhKDAsIHN0YXJ0T2Zmc2V0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHROb2RlID0gdXRpbC5jcmVhdGVUZXh0Tm9kZShzdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PT0gMSA/ICcnIDogc3RhcnRDb250YWluZXIuc3Vic3RyaW5nRGF0YShzdGFydE9mZnNldCwgKGVuZE9mZnNldCA+IHN0YXJ0T2Zmc2V0ID8gZW5kT2Zmc2V0IC0gc3RhcnRPZmZzZXQgOiBlbmRPZmZzZXQgPT09IHN0YXJ0T2Zmc2V0ID8gMCA6IHN0YXJ0Q29udGFpbmVyLmRhdGEubGVuZ3RoIC0gc3RhcnRPZmZzZXQpKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldk5vZGUuZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKHByZXZOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IGNoaWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwQ3VycmVudCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChuZXdOb2RlICE9PSBwTm9kZSAmJiBuZXdOb2RlICE9PSBlbCAmJiBuZXdOb2RlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGlvbihuZXdOb2RlKSAmJiBuZXdOb2RlLm5vZGVUeXBlID09PSAxICYmIGNoZWNrQ3NzKG5ld05vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcEN1cnJlbnQucHVzaChuZXdOb2RlLmNsb25lTm9kZShmYWxzZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gbmV3Tm9kZS5zdHlsZS5jc3NUZXh0LnN1YnN0cigwLCBuZXdOb2RlLnN0eWxlLmNzc1RleHQuaW5kZXhPZignOicpKSArICd8JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBuZXdOb2RlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZSA9IHBDdXJyZW50LnBvcCgpIHx8IHRleHROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlID0gbmV3Tm9kZSA9IGNoaWxkTm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHBDdXJyZW50Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBwQ3VycmVudC5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUuYXBwZW5kQ2hpbGQobmV3Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlID0gbmV3Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5uZXJOb2RlLmFwcGVuZENoaWxkKGNoaWxkTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBOb2RlLmFwcGVuZENoaWxkKG5ld0lubmVyTm9kZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydENvbnRhaW5lciA9IHRleHROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydE9mZnNldCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0UGFzcyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3Tm9kZSAhPT0gdGV4dE5vZGUpIG5ld05vZGUuYXBwZW5kQ2hpbGQoc3RhcnRDb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzU2FtZU5vZGUpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZW5kQ29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlbmRQYXNzICYmIGNoaWxkID09PSBlbmRDb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWZ0ZXJOb2RlID0gdXRpbC5jcmVhdGVUZXh0Tm9kZShlbmRDb250YWluZXIubm9kZVR5cGUgPT09IDEgPyAnJyA6IGVuZENvbnRhaW5lci5zdWJzdHJpbmdEYXRhKGVuZE9mZnNldCwgKGVuZENvbnRhaW5lci5sZW5ndGggLSBlbmRPZmZzZXQpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHROb2RlID0gdXRpbC5jcmVhdGVUZXh0Tm9kZShpc1NhbWVOb2RlIHx8IGVuZENvbnRhaW5lci5ub2RlVHlwZSA9PT0gMSA/ICcnIDogZW5kQ29udGFpbmVyLnN1YnN0cmluZ0RhdGEoMCwgZW5kT2Zmc2V0KSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWZ0ZXJOb2RlLmRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IGNoaWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3NzVGV4dCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcEN1cnJlbnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChuZXdOb2RlICE9PSBwTm9kZSAmJiBuZXdOb2RlICE9PSBlbCAmJiBuZXdOb2RlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld05vZGUubm9kZVR5cGUgPT09IDEgJiYgY2hlY2tDc3MobmV3Tm9kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcEN1cnJlbnQucHVzaChuZXdOb2RlLmNsb25lTm9kZShmYWxzZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ICs9IG5ld05vZGUuc3R5bGUuY3NzVGV4dC5zdWJzdHIoMCwgbmV3Tm9kZS5zdHlsZS5jc3NUZXh0LmluZGV4T2YoJzonKSkgKyAnfCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBuZXdOb2RlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmVOb2RlID0gYXBwZW5kTm9kZSA9IG5ld05vZGUgPSBwQ3VycmVudC5wb3AoKSB8fCBhZnRlck5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocEN1cnJlbnQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBwQ3VycmVudC5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlLmFwcGVuZENoaWxkKG5ld05vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUgPSBuZXdOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOb2RlLmFwcGVuZENoaWxkKGNsb25lTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdOb2RlLnRleHRDb250ZW50ID0gYWZ0ZXJOb2RlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBjaGlsZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcEN1cnJlbnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzVGV4dCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobmV3Tm9kZSAhPT0gcE5vZGUgJiYgbmV3Tm9kZSAhPT0gZWwgJiYgbmV3Tm9kZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkYXRpb24obmV3Tm9kZSkgJiYgbmV3Tm9kZS5ub2RlVHlwZSA9PT0gMSAmJiBjaGVja0NzcyhuZXdOb2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBDdXJyZW50LnB1c2gobmV3Tm9kZS5jbG9uZU5vZGUoZmFsc2UpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3NUZXh0ICs9IG5ld05vZGUuc3R5bGUuY3NzVGV4dC5zdWJzdHIoMCwgbmV3Tm9kZS5zdHlsZS5jc3NUZXh0LmluZGV4T2YoJzonKSkgKyAnfCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gbmV3Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZE5vZGUgPSBwQ3VycmVudC5wb3AoKSB8fCB0ZXh0Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kTm9kZSA9IG5ld05vZGUgPSBjaGlsZE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwQ3VycmVudC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gcEN1cnJlbnQucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlLmFwcGVuZENoaWxkKG5ld05vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kTm9kZSA9IG5ld05vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0lubmVyTm9kZS5hcHBlbmRDaGlsZChjaGlsZE5vZGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kQ29udGFpbmVyID0gdGV4dE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZE9mZnNldCA9IHRleHROb2RlLmRhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRQYXNzID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNSZW1vdmVGb3JtYXQgJiYgY29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdJbm5lck5vZGUgPSB0ZXh0Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHROb2RlLnRleHRDb250ZW50ID0gdXRpbC56ZXJvV2lkdGhTcGFjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld05vZGUgIT09IHRleHROb2RlKSBuZXdOb2RlLmFwcGVuZENoaWxkKGVuZENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnRQYXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZC5ub2RlVHlwZSA9PT0gMSAmJiAhdXRpbC5pc0JyZWFrKGNoaWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaW9uRnVuYyhjaGlsZCwgY2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBjaGlsZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcEN1cnJlbnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzVGV4dCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobmV3Tm9kZS5wYXJlbnROb2RlICE9PSBudWxsICYmIG5ld05vZGUgIT09IGVsICYmIG5ld05vZGUgIT09IG5ld0lubmVyTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld05vZGUubm9kZVR5cGUgPT09IDEgJiYgIXV0aWwuaXNCcmVhayhjaGlsZCkgJiYgKGVuZFBhc3MgfHwgdmFsaWRhdGlvbihuZXdOb2RlKSkgJiYgY2hlY2tDc3MobmV3Tm9kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwQ3VycmVudC5wdXNoKG5ld05vZGUuY2xvbmVOb2RlKGZhbHNlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3NzVGV4dCArPSBuZXdOb2RlLnN0eWxlLmNzc1RleHQuc3Vic3RyKDAsIG5ld05vZGUuc3R5bGUuY3NzVGV4dC5pbmRleE9mKCc6JykpICsgJ3wnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IG5ld05vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGROb2RlID0gcEN1cnJlbnQucG9wKCkgfHwgY2hpbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUgPSBuZXdOb2RlID0gY2hpbGROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocEN1cnJlbnQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IHBDdXJyZW50LnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kTm9kZS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUgPSBuZXdOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGROb2RlID09PSBjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlbmRQYXNzKSBub2RlID0gbmV3SW5uZXJOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBub2RlID0gcE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5kUGFzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcE5vZGUuYXBwZW5kQ2hpbGQoY2hpbGROb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBuZXdOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5uZXJOb2RlLmFwcGVuZENoaWxkKGNoaWxkTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gbmV3Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2xvbmVOb2RlID0gY2hpbGQuY2xvbmVOb2RlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNsb25lTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlID09PSAxICYmICF1dGlsLmlzQnJlYWsoY2hpbGQpKSBjb3Zlck5vZGUgPSBjbG9uZU5vZGU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlY3Vyc2lvbkZ1bmMoY2hpbGQsIGNvdmVyTm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKGVsZW1lbnQsIHBOb2RlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc1JlbW92ZUZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgc3RhcnRDb250YWluZXIgPSB1dGlsLmNyZWF0ZVRleHROb2RlKGNvbGxhcHNlZCA/IHV0aWwuemVyb1dpZHRoU3BhY2UgOiBuZXdJbm5lck5vZGUudGV4dENvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgcE5vZGUuaW5zZXJ0QmVmb3JlKHN0YXJ0Q29udGFpbmVyLCBuZXdJbm5lck5vZGUpO1xyXG4gICAgICAgICAgICAgICAgcE5vZGUucmVtb3ZlQ2hpbGQobmV3SW5uZXJOb2RlKTtcclxuICAgICAgICAgICAgICAgIGlmIChjb2xsYXBzZWQpIHN0YXJ0T2Zmc2V0ID0gMTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0Q29udGFpbmVyID0gZW5kQ29udGFpbmVyID0gbmV3SW5uZXJOb2RlO1xyXG4gICAgICAgICAgICAgICAgc3RhcnRPZmZzZXQgPSAxO1xyXG4gICAgICAgICAgICAgICAgZW5kT2Zmc2V0ID0gMTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXRpbC5yZW1vdmVFbXB0eU5vZGUocE5vZGUpO1xyXG4gICAgICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHBOb2RlLCBlbGVtZW50KTtcclxuICAgICAgICAgICAgdXRpbC5yZW1vdmVJdGVtKGVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0Q29udGFpbmVyOiBzdGFydENvbnRhaW5lcixcclxuICAgICAgICAgICAgICAgIHN0YXJ0T2Zmc2V0OiBzdGFydE9mZnNldCxcclxuICAgICAgICAgICAgICAgIGVuZENvbnRhaW5lcjogaXNSZW1vdmVGb3JtYXQgfHwgIWVuZENvbnRhaW5lci50ZXh0Q29udGVudCA/IHN0YXJ0Q29udGFpbmVyIDogZW5kQ29udGFpbmVyLFxyXG4gICAgICAgICAgICAgICAgZW5kT2Zmc2V0OiBpc1JlbW92ZUZvcm1hdCB8fCAhZW5kQ29udGFpbmVyLnRleHRDb250ZW50ID8gc3RhcnRDb250YWluZXIudGV4dENvbnRlbnQubGVuZ3RoIDogZW5kT2Zmc2V0XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIHdyYXBzIG1pZCBsaW5lcyBzZWxlY3RlZCB0ZXh0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSBub2RlIG9mIHRoZSBsaW5lIHRoYXQgY29udGFpbnMgdGhlIHNlbGVjdGVkIHRleHQgbm9kZS5cclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG5ld0lubmVyTm9kZSAtIFRoZSBkb20gdGhhdCB3aWxsIHdyYXAgdGhlIHNlbGVjdGVkIHRleHQgYXJlYVxyXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHZhbGlkYXRpb24gLSBDaGVjayBpZiB0aGUgbm9kZSBzaG91bGQgYmUgc3RyaXBwZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBpc1JlbW92ZUZvcm1hdCAtIElzIHRoZSByZW1vdmUgZm9ybWF0IGNvbW1hbmQgP1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX25vZGVDaGFuZ2VfbWlkZGxlTGluZTogZnVuY3Rpb24gKGVsZW1lbnQsIG5ld0lubmVyTm9kZSwgdmFsaWRhdGlvbiwgaXNSZW1vdmVGb3JtYXQpIHtcclxuICAgICAgICAgICAgaWYgKGlzUmVtb3ZlRm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICBuZXdJbm5lck5vZGUgPSB1dGlsLmNyZWF0ZVRleHROb2RlKGVsZW1lbnQudGV4dENvbnRlbnQgPyBlbGVtZW50LnRleHRDb250ZW50IDogdXRpbC56ZXJvV2lkdGhTcGFjZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAoZnVuY3Rpb24gcmVjdXJzaW9uRnVuYyhjdXJyZW50LCBub2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGROb2RlcyA9IGN1cnJlbnQuY2hpbGROb2RlcztcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBjaGlsZE5vZGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjaGlsZCA9IGNoaWxkTm9kZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb3Zlck5vZGUgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGlvbihjaGlsZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjbG9uZU5vZGUgPSBjaGlsZC5jbG9uZU5vZGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChjbG9uZU5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlID09PSAxICYmICF1dGlsLmlzQnJlYWsoY2hpbGQpKSBjb3Zlck5vZGUgPSBjbG9uZU5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaW9uRnVuYyhjaGlsZCwgY292ZXJOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KShlbGVtZW50LCBuZXdJbm5lck5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKG5ld0lubmVyTm9kZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIHdyYXBzIGZpcnN0IGxpbmUgc2VsZWN0ZWQgdGV4dC5cclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgbm9kZSBvZiB0aGUgbGluZSB0aGF0IGNvbnRhaW5zIHRoZSBzZWxlY3RlZCB0ZXh0IG5vZGUuXHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBuZXdJbm5lck5vZGUgLSBUaGUgZG9tIHRoYXQgd2lsbCB3cmFwIHRoZSBzZWxlY3RlZCB0ZXh0IGFyZWFcclxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSB2YWxpZGF0aW9uIC0gQ2hlY2sgaWYgdGhlIG5vZGUgc2hvdWxkIGJlIHN0cmlwcGVkLlxyXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gc3RhcnRDb24gLSBUaGUgc3RhcnRDb250YWluZXIgcHJvcGVydHkgb2YgdGhlIHNlbGVjdGlvbiBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0T2ZmIC0gVGhlIHN0YXJ0T2Zmc2V0IHByb3BlcnR5IG9mIHRoZSBzZWxlY3Rpb24gb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZW1vdmVGb3JtYXQgLSBJcyB0aGUgcmVtb3ZlIGZvcm1hdCBjb21tYW5kID9cclxuICAgICAgICAgKiBAcmV0dXJucyB7e2NvbnRhaW5lcjogKiwgb2Zmc2V0OiAqfX1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9ub2RlQ2hhbmdlX3N0YXJ0TGluZTogZnVuY3Rpb24gKGVsZW1lbnQsIG5ld0lubmVyTm9kZSwgdmFsaWRhdGlvbiwgc3RhcnRDb24sIHN0YXJ0T2ZmLCBpc1JlbW92ZUZvcm1hdCkge1xyXG4gICAgICAgICAgICBjb25zdCBlbCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHBOb2RlID0gZWxlbWVudC5jbG9uZU5vZGUoZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHN0YXJ0Q29uO1xyXG4gICAgICAgICAgICBsZXQgb2Zmc2V0ID0gc3RhcnRPZmY7XHJcbiAgICAgICAgICAgIGxldCBwYXNzTm9kZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBsZXQgcEN1cnJlbnQsIG5ld05vZGUsIGFwcGVuZE5vZGU7XHJcblxyXG4gICAgICAgICAgICAoZnVuY3Rpb24gcmVjdXJzaW9uRnVuYyhjdXJyZW50LCBub2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZE5vZGVzID0gY3VycmVudC5jaGlsZE5vZGVzO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGNoaWxkTm9kZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkTm9kZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvdmVyTm9kZSA9IG5vZGU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXNzTm9kZSAmJiAhdXRpbC5pc0JyZWFrKGNoaWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGQubm9kZVR5cGUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY3Vyc2lvbkZ1bmMoY2hpbGQsIGNoaWxkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gY2hpbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBDdXJyZW50ID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChuZXdOb2RlLnBhcmVudE5vZGUgIT09IG51bGwgJiYgbmV3Tm9kZSAhPT0gZWwgJiYgbmV3Tm9kZSAhPT0gbmV3SW5uZXJOb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3Tm9kZS5ub2RlVHlwZSA9PT0gMSAmJiB2YWxpZGF0aW9uKG5ld05vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcEN1cnJlbnQucHVzaChuZXdOb2RlLmNsb25lTm9kZShmYWxzZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IG5ld05vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBDdXJyZW50Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZSA9IHBDdXJyZW50LnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kTm9kZSA9IG5ld05vZGUgPSBjaGlsZE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocEN1cnJlbnQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBwQ3VycmVudC5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlLmFwcGVuZENoaWxkKG5ld05vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUgPSBuZXdOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5uZXJOb2RlLmFwcGVuZENoaWxkKGNoaWxkTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gbmV3Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBuZXdJbm5lck5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0Q29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXNzTm9kZSAmJiBjaGlsZCA9PT0gY29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZOb2RlID0gdXRpbC5jcmVhdGVUZXh0Tm9kZShjb250YWluZXIubm9kZVR5cGUgPT09IDEgPyAnJyA6IGNvbnRhaW5lci5zdWJzdHJpbmdEYXRhKDAsIG9mZnNldCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0Tm9kZSA9IHV0aWwuY3JlYXRlVGV4dE5vZGUoY29udGFpbmVyLm5vZGVUeXBlID09PSAxID8gJycgOiBjb250YWluZXIuc3Vic3RyaW5nRGF0YShvZmZzZXQsIChjb250YWluZXIubGVuZ3RoIC0gb2Zmc2V0KSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZOb2RlLmRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChwcmV2Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwQ3VycmVudCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobmV3Tm9kZSAhPT0gcE5vZGUgJiYgbmV3Tm9kZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld05vZGUubm9kZVR5cGUgPT09IDEgJiYgdmFsaWRhdGlvbihuZXdOb2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBDdXJyZW50LnB1c2gobmV3Tm9kZS5jbG9uZU5vZGUoZmFsc2UpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBuZXdOb2RlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZSA9IHBDdXJyZW50LnBvcCgpIHx8IG5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUgPSBuZXdOb2RlID0gY2hpbGROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocEN1cnJlbnQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IHBDdXJyZW50LnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kTm9kZS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUgPSBuZXdOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGROb2RlICE9PSBub2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdJbm5lck5vZGUuYXBwZW5kQ2hpbGQoY2hpbGROb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBuZXdOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5ld0lubmVyTm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWwuaXNCcmVhayhjaGlsZCkpIG5ld0lubmVyTm9kZS5hcHBlbmRDaGlsZChjaGlsZC5jbG9uZU5vZGUoZmFsc2UpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBOb2RlLmFwcGVuZENoaWxkKG5ld0lubmVyTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHRleHROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXNzTm9kZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXNzTm9kZSB8fCB2YWxpZGF0aW9uKGNoaWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbG9uZU5vZGUgPSBjaGlsZC5jbG9uZU5vZGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNsb25lTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZC5ub2RlVHlwZSA9PT0gMSAmJiAhdXRpbC5pc0JyZWFrKGNoaWxkKSkgY292ZXJOb2RlID0gY2xvbmVOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjdXJzaW9uRnVuYyhjaGlsZCwgY292ZXJOb2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSkoZWxlbWVudCwgcE5vZGUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzUmVtb3ZlRm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIgPSB1dGlsLmNyZWF0ZVRleHROb2RlKG5ld0lubmVyTm9kZS50ZXh0Q29udGVudCk7XHJcbiAgICAgICAgICAgICAgICBwTm9kZS5pbnNlcnRCZWZvcmUoY29udGFpbmVyLCBuZXdJbm5lck5vZGUpO1xyXG4gICAgICAgICAgICAgICAgcE5vZGUucmVtb3ZlQ2hpbGQobmV3SW5uZXJOb2RlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFpc1JlbW92ZUZvcm1hdCAmJiBwTm9kZS5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmNoaWxkTm9kZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSBlbGVtZW50LmNoaWxkTm9kZXNbMF07XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHV0aWwuY3JlYXRlVGV4dE5vZGUodXRpbC56ZXJvV2lkdGhTcGFjZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdXRpbC5yZW1vdmVFbXB0eU5vZGUocE5vZGUpO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShwTm9kZSwgZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB1dGlsLnJlbW92ZUl0ZW0oZWxlbWVudCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXI6IGNvbnRhaW5lcixcclxuICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIHdyYXBzIGxhc3QgbGluZSBzZWxlY3RlZCB0ZXh0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSBub2RlIG9mIHRoZSBsaW5lIHRoYXQgY29udGFpbnMgdGhlIHNlbGVjdGVkIHRleHQgbm9kZS5cclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG5ld0lubmVyTm9kZSAtIFRoZSBkb20gdGhhdCB3aWxsIHdyYXAgdGhlIHNlbGVjdGVkIHRleHQgYXJlYVxyXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHZhbGlkYXRpb24gLSBDaGVjayBpZiB0aGUgbm9kZSBzaG91bGQgYmUgc3RyaXBwZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbmRDb24gLSBUaGUgZW5kQ29udGFpbmVyIHByb3BlcnR5IG9mIHRoZSBzZWxlY3Rpb24gb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlbmRPZmYgLSBUaGUgZW5kT2Zmc2V0IHByb3BlcnR5IG9mIHRoZSBzZWxlY3Rpb24gb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZW1vdmVGb3JtYXQgLSBJcyB0aGUgcmVtb3ZlIGZvcm1hdCBjb21tYW5kID9cclxuICAgICAgICAgKiBAcmV0dXJucyB7e2NvbnRhaW5lcjogKiwgb2Zmc2V0OiAqfX1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9ub2RlQ2hhbmdlX2VuZExpbmU6IGZ1bmN0aW9uIChlbGVtZW50LCBuZXdJbm5lck5vZGUsIHZhbGlkYXRpb24sIGVuZENvbiwgZW5kT2ZmLCBpc1JlbW92ZUZvcm1hdCkge1xyXG4gICAgICAgICAgICBjb25zdCBlbCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHBOb2RlID0gZWxlbWVudC5jbG9uZU5vZGUoZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGVuZENvbjtcclxuICAgICAgICAgICAgbGV0IG9mZnNldCA9IGVuZE9mZjtcclxuICAgICAgICAgICAgbGV0IHBhc3NOb2RlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGxldCBwQ3VycmVudCwgbmV3Tm9kZSwgYXBwZW5kTm9kZTtcclxuXHJcbiAgICAgICAgICAgIChmdW5jdGlvbiByZWN1cnNpb25GdW5jKGN1cnJlbnQsIG5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZXMgPSBjdXJyZW50LmNoaWxkTm9kZXM7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gY2hpbGROb2Rlcy5sZW5ndGggLTE7IDAgPD0gaTsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZE5vZGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb3Zlck5vZGUgPSBub2RlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFzc05vZGUgJiYgIXV0aWwuaXNCcmVhayhjaGlsZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpb25GdW5jKGNoaWxkLCBjaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IGNoaWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwQ3VycmVudCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobmV3Tm9kZS5wYXJlbnROb2RlICE9PSBudWxsICYmIG5ld05vZGUgIT09IGVsICYmIG5ld05vZGUgIT09IG5ld0lubmVyTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkYXRpb24obmV3Tm9kZSkgJiYgbmV3Tm9kZS5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBDdXJyZW50LnB1c2gobmV3Tm9kZS5jbG9uZU5vZGUoZmFsc2UpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBuZXdOb2RlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwQ3VycmVudC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZE5vZGUgPSBwQ3VycmVudC5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUgPSBuZXdOb2RlID0gY2hpbGROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHBDdXJyZW50Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gcEN1cnJlbnQucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kTm9kZS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlID0gbmV3Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0lubmVyTm9kZS5pbnNlcnRCZWZvcmUoY2hpbGROb2RlLCBuZXdJbm5lck5vZGUuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gbmV3Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBuZXdJbm5lck5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGVuZENvbnRhaW5lclxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcGFzc05vZGUgJiYgY2hpbGQgPT09IGNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhZnRlck5vZGUgPSB1dGlsLmNyZWF0ZVRleHROb2RlKGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gMSA/ICcnIDogY29udGFpbmVyLnN1YnN0cmluZ0RhdGEob2Zmc2V0LCAoY29udGFpbmVyLmxlbmd0aCAtIG9mZnNldCkpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dE5vZGUgPSB1dGlsLmNyZWF0ZVRleHROb2RlKGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gMSA/ICcnIDogY29udGFpbmVyLnN1YnN0cmluZ0RhdGEoMCwgb2Zmc2V0KSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWZ0ZXJOb2RlLmRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5pbnNlcnRCZWZvcmUoYWZ0ZXJOb2RlLCBub2RlLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gbm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcEN1cnJlbnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG5ld05vZGUgIT09IHBOb2RlICYmIG5ld05vZGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uKG5ld05vZGUpICYmIG5ld05vZGUubm9kZVR5cGUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwQ3VycmVudC5wdXNoKG5ld05vZGUuY2xvbmVOb2RlKGZhbHNlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gbmV3Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZE5vZGUgPSBwQ3VycmVudC5wb3AoKSB8fCBub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlID0gbmV3Tm9kZSA9IGNoaWxkTm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHBDdXJyZW50Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUgPSBwQ3VycmVudC5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZE5vZGUuYXBwZW5kQ2hpbGQobmV3Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmROb2RlID0gbmV3Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkTm9kZSAhPT0gbm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5uZXJOb2RlLmluc2VydEJlZm9yZShjaGlsZE5vZGUsIG5ld0lubmVyTm9kZS5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBuZXdOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5ld0lubmVyTm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWwuaXNCcmVhayhjaGlsZCkpIG5ld0lubmVyTm9kZS5hcHBlbmRDaGlsZChjaGlsZC5jbG9uZU5vZGUoZmFsc2UpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBOb2RlLmluc2VydEJlZm9yZShuZXdJbm5lck5vZGUsIHBOb2RlLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSB0ZXh0Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gdGV4dE5vZGUuZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3NOb2RlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuaW5zZXJ0QmVmb3JlKGNvbnRhaW5lciwgbm9kZS5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhc3NOb2RlIHx8IHZhbGlkYXRpb24oY2hpbGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsb25lTm9kZSA9IGNoaWxkLmNsb25lTm9kZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuaW5zZXJ0QmVmb3JlKGNsb25lTm9kZSwgbm9kZS5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlID09PSAxICYmICF1dGlsLmlzQnJlYWsoY2hpbGQpKSBjb3Zlck5vZGUgPSBjbG9uZU5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZWN1cnNpb25GdW5jKGNoaWxkLCBjb3Zlck5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KShlbGVtZW50LCBwTm9kZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaXNSZW1vdmVGb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHV0aWwuY3JlYXRlVGV4dE5vZGUobmV3SW5uZXJOb2RlLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgICAgIG9mZnNldCA9IGNvbnRhaW5lci50ZXh0Q29udGVudC5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBwTm9kZS5pbnNlcnRCZWZvcmUoY29udGFpbmVyLCBuZXdJbm5lck5vZGUpO1xyXG4gICAgICAgICAgICAgICAgcE5vZGUucmVtb3ZlQ2hpbGQobmV3SW5uZXJOb2RlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFpc1JlbW92ZUZvcm1hdCAmJiBwTm9kZS5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuY2hpbGROb2Rlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGVsZW1lbnQuY2hpbGROb2Rlc1swXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyID0gdXRpbC5jcmVhdGVUZXh0Tm9kZSh1dGlsLnplcm9XaWR0aFNwYWNlKTtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB1dGlsLnJlbW92ZUVtcHR5Tm9kZShwTm9kZSk7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHBOb2RlLCBlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlSXRlbShlbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogY29udGFpbmVyLFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gRXhlY3V0ZSBjb21tYW5kIG9mIGNvbW1hbmQgYnV0dG9uKEFsbCBCdXR0b25zIGV4Y2VwdCBzdWJtZW51IGFuZCBkaWFsb2cpXHJcbiAgICAgICAgICogKHJlZG8sIHVuZG8sIGJvbGQsIHVuZGVybGluZSwgaXRhbGljLCBzdHJpa2V0aHJvdWdoLCBzdWJzY3JpcHQsIHN1cGVyc2NyaXB0LCByZW1vdmVGb3JtYXQsIGluZGVudCwgb3V0ZGVudCwgZnVsbHNjcmVlbiwgc2hvd0Jsb2NrcywgY29kZXZpZXcsIHByZXZpZXcsIHByaW50KVxyXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IC0gVGhlIGVsZW1lbnQgb2YgY29tbWFuZCBidXR0b25cclxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29tbWFuZCAtIFByb3BlcnR5IG9mIGNvbW1hbmQgYnV0dG9uIChkYXRhLXZhbHVlKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNvbW1hbmRIYW5kbGVyOiBmdW5jdGlvbiAodGFyZ2V0LCBjb21tYW5kKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY29kZVZpZXcnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udHJvbGxlcnNPZmYoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUNvZGVWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC50b2dnbGVDbGFzcyh0YXJnZXQsICdvbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZnVsbFNjcmVlbic6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyc09mZigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRnVsbFNjcmVlbih0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHV0aWwudG9nZ2xlQ2xhc3ModGFyZ2V0LCAnb24nKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2luZGVudCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdvdXRkZW50JzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluZGVudChjb21tYW5kKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3JlZG8nOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndW5kbyc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjQ29tbWFuZChjb21tYW5kLCBmYWxzZSwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyZW1vdmVGb3JtYXQnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9ybWF0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwcmV2aWV3JzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3ByaW50JzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5XaW5kb3dDb250ZW50cyhjb21tYW5kKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3Nob3dCbG9ja3MnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRGlzcGxheUJsb2NrcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHV0aWwudG9nZ2xlQ2xhc3ModGFyZ2V0LCAnb24nKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3N1YnNjcmlwdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWwuaGFzQ2xhc3MoY29udGV4dC50b29sLnN1cGVyc2NyaXB0LCAnb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKCdzdXBlcnNjcmlwdCcsIGZhbHNlLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbC5yZW1vdmVDbGFzcyhjb250ZXh0LnRvb2wuc3VwZXJzY3JpcHQsICdvbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKGNvbW1hbmQsIGZhbHNlLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB1dGlsLnRvZ2dsZUNsYXNzKHRhcmdldCwgJ29uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdzdXBlcnNjcmlwdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWwuaGFzQ2xhc3MoY29udGV4dC50b29sLnN1YnNjcmlwdCwgJ29uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjQ29tbWFuZCgnc3Vic2NyaXB0JywgZmFsc2UsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1dGlsLnJlbW92ZUNsYXNzKGNvbnRleHQudG9vbC5zdWJzY3JpcHQsICdvbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKGNvbW1hbmQsIGZhbHNlLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB1dGlsLnRvZ2dsZUNsYXNzKHRhcmdldCwgJ29uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdzYXZlJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRleHQub3B0aW9uLmNhbGxCYWNrU2F2ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Lm9wdGlvbi5jYWxsQmFja1NhdmUodGhpcy5nZXRDb250ZW50cygpKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignW1NVTkVESVRPUi5jb3JlLmNvbW1hbmRIYW5kbGVyLmZhaWxdIFBsZWFzZSByZWdpc3RlciBjYWxsIGJhY2sgZnVuY3Rpb24gaW4gY3JlYXRpb24gb3B0aW9uLiAoY2FsbEJhY2tTYXZlIDogRnVuY3Rpb24pJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdCA6IC8vICdib2xkJywgJ3VuZGVybGluZScsICdpdGFsaWMnLCAnc3RyaWtlJ1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoY29tbWFuZCwgZmFsc2UsIHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC50b2dnbGVDbGFzcyh0YXJnZXQsICdvbicpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZvY3VzKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFJlbW92ZSBmb3JtYXQgb2YgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCByYW5nZSAoSUUsIEVkZ2Ugbm90IHdvcmtpbmcpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVtb3ZlRm9ybWF0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZUNoYW5nZSh1dGlsLmNyZWF0ZUVsZW1lbnQoJ1JFTU9WRU5PREUnKSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFRoaXMgbWV0aG9kIGltcGxlbWVudHMgaW5kZW50YXRpb24gdG8gc2VsZWN0ZWQgcmFuZ2UuXHJcbiAgICAgICAgICogU2V0dGVkIFwibWFyZ2luLWxlZnRcIiB0byBcIjI1cHhcIiBpbiB0aGUgdG9wIFwiUFwiIHRhZyBvZiB0aGUgcGFyYW1ldGVyIG5vZGUuXHJcbiAgICAgICAgICogQHBhcmFtIGNvbW1hbmQge1N0cmluZ30gLSBTZXBhcmF0b3IgKFwiaW5kZW50XCIgb3IgXCJvdXRkZW50XCIpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5kZW50OiBmdW5jdGlvbiAoY29tbWFuZCkge1xyXG4gICAgICAgICAgICBjb25zdCByYW5nZUxpbmVzID0gdGhpcy5nZXRTZWxlY3RlZEZvcm1hdEVsZW1lbnRzKCk7XHJcbiAgICAgICAgICAgIGxldCBwLCBtYXJnaW47XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gcmFuZ2VMaW5lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgcCA9IHJhbmdlTGluZXNbaV07XHJcbiAgICAgICAgICAgICAgICBtYXJnaW4gPSAvXFxkKy8udGVzdChwLnN0eWxlLm1hcmdpbkxlZnQpID8gcC5zdHlsZS5tYXJnaW5MZWZ0Lm1hdGNoKC9cXGQrLylbMF0gKiAxIDogMDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoJ2luZGVudCcgPT09IGNvbW1hbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXJnaW4gKz0gMjU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbiAtPSAyNTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgcC5zdHlsZS5tYXJnaW5MZWZ0ID0gKG1hcmdpbiA8IDAgPyAwIDogbWFyZ2luKSArICdweCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQWRkIG9yIHJlbW92ZSB0aGUgY2xhc3MgbmFtZSBvZiBcImJvZHlcIiBzbyB0aGF0IHRoZSBjb2RlIGJsb2NrIGlzIHZpc2libGVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b2dnbGVEaXNwbGF5QmxvY2tzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHV0aWwudG9nZ2xlQ2xhc3MoY29udGV4dC5lbGVtZW50Lnd5c2l3eWcsICdzdW4tZWRpdG9yLXNob3ctYmxvY2snKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQ2hhbmdlcyB0byBjb2RlIHZpZXcgb3Igd3lzaXd5ZyB2aWV3XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9nZ2xlQ29kZVZpZXc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3Qgd3lzaXd5Z0FjdGl2ZSA9IHRoaXMuX3ZhcmlhYmxlLnd5c2l3eWdBY3RpdmU7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpc0J1dHRvbnMgPSB0aGlzLmNvZGVWaWV3RGlzYWJsZWRCdXR0b25zO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gZGlzQnV0dG9ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZGlzQnV0dG9uc1tpXS5kaXNhYmxlZCA9IHd5c2l3eWdBY3RpdmU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghd3lzaXd5Z0FjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29kZV9odG1sID0gY29udGV4dC5lbGVtZW50LmNvZGUudmFsdWUudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuaW5uZXJIVE1MID0gY29kZV9odG1sLmxlbmd0aCA+IDAgPyB1dGlsLmNvbnZlcnRDb250ZW50c0ZvckVkaXRvcihjb2RlX2h0bWwpIDogJzxwPicgKyB1dGlsLnplcm9XaWR0aFNwYWNlICsgJzwvcD4nO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5jb2RlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICAgICAgICAgIGlmIChjb250ZXh0Lm9wdGlvbi5oZWlnaHQgPT09ICdhdXRvJykgY29udGV4dC5lbGVtZW50LmNvZGUuc3R5bGUuaGVpZ2h0ID0gJzBweCc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl92YXJpYWJsZS53eXNpd3lnQWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5jb2RlLnZhbHVlID0gdXRpbC5jb252ZXJ0SFRNTEZvckNvZGVWaWV3KGNvbnRleHQuZWxlbWVudC53eXNpd3lnLmlubmVySFRNTC50cmltKCkpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5jb2RlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRleHQub3B0aW9uLmhlaWdodCA9PT0gJ2F1dG8nKSBjb250ZXh0LmVsZW1lbnQuY29kZS5zdHlsZS5oZWlnaHQgPSBjb250ZXh0LmVsZW1lbnQuY29kZS5zY3JvbGxIZWlnaHQgPiAwID8gKGNvbnRleHQuZWxlbWVudC5jb2RlLnNjcm9sbEhlaWdodCArICdweCcpIDogJ2F1dG8nO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmFyaWFibGUud3lzaXd5Z0FjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LmNvZGUuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBDaGFuZ2VzIHRvIGZ1bGwgc2NyZWVuIG9yIGRlZmF1bHQgc2NyZWVuXHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gZnVsbCBzY3JlZW4gYnV0dG9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9nZ2xlRnVsbFNjcmVlbjogZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl92YXJpYWJsZS5pc0Z1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZhcmlhYmxlLmlzRnVsbFNjcmVlbiA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnRvcEFyZWEuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnRvcEFyZWEuc3R5bGUudG9wID0gJzAnO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnRvcEFyZWEuc3R5bGUubGVmdCA9ICcwJztcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC50b3BBcmVhLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnRvcEFyZWEuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnRvcEFyZWEuc3R5bGUuekluZGV4ID0gJzIxNDc0ODM2NDcnO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZhcmlhYmxlLl9ib2R5T3ZlcmZsb3cgPSBfZC5ib2R5LnN0eWxlLm92ZXJmbG93O1xyXG4gICAgICAgICAgICAgICAgX2QuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZhcmlhYmxlLl9lZGl0b3JBcmVhT3JpZ2luQ3NzVGV4dCA9IGNvbnRleHQuZWxlbWVudC5lZGl0b3JBcmVhLnN0eWxlLmNzc1RleHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl92YXJpYWJsZS5fd3lzaXd5Z09yaWdpbkNzc1RleHQgPSBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5zdHlsZS5jc3NUZXh0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmFyaWFibGUuX2NvZGVPcmlnaW5Dc3NUZXh0ID0gY29udGV4dC5lbGVtZW50LmNvZGUuc3R5bGUuY3NzVGV4dDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQuZWRpdG9yQXJlYS5zdHlsZS5jc3NUZXh0ID0gY29udGV4dC5lbGVtZW50LnRvb2xiYXIuc3R5bGUuY3NzVGV4dCA9IGNvbnRleHQuZWxlbWVudC53eXNpd3lnLnN0eWxlLmNzc1RleHQgPSBjb250ZXh0LmVsZW1lbnQuY29kZS5zdHlsZS5jc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQudG9vbGJhci5zdHlsZS53aWR0aCA9IGNvbnRleHQuZWxlbWVudC53eXNpd3lnLnN0eWxlLmhlaWdodCA9IGNvbnRleHQuZWxlbWVudC5jb2RlLnN0eWxlLmhlaWdodCA9ICcxMDAlJztcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC50b29sYmFyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLl92YXJpYWJsZS5pbm5lckhlaWdodF9mdWxsU2NyZWVuID0gKF93LmlubmVySGVpZ2h0IC0gY29udGV4dC5lbGVtZW50LnRvb2xiYXIub2Zmc2V0SGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5lZGl0b3JBcmVhLnN0eWxlLmhlaWdodCA9IHRoaXMuX3ZhcmlhYmxlLmlubmVySGVpZ2h0X2Z1bGxTY3JlZW4gKyAncHgnO1xyXG5cclxuICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlQ2xhc3MoZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCwgJ2ljb24tZXhwYW5zaW9uJyk7XHJcbiAgICAgICAgICAgICAgICB1dGlsLmFkZENsYXNzKGVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQsICdpY29uLXJlZHVjdGlvbicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmFyaWFibGUuaXNGdWxsU2NyZWVuID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LmNvZGUuc3R5bGUuY3NzVGV4dCA9IHRoaXMuX3ZhcmlhYmxlLl9jb2RlT3JpZ2luQ3NzVGV4dDtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLnN0eWxlLmNzc1RleHQgPSB0aGlzLl92YXJpYWJsZS5fd3lzaXd5Z09yaWdpbkNzc1RleHQ7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQudG9vbGJhci5zdHlsZS5jc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQuZWRpdG9yQXJlYS5zdHlsZS5jc3NUZXh0ID0gdGhpcy5fdmFyaWFibGUuX2VkaXRvckFyZWFPcmlnaW5Dc3NUZXh0O1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnRvcEFyZWEuc3R5bGUuY3NzVGV4dCA9IHRoaXMuX3ZhcmlhYmxlLl9vcmlnaW5Dc3NUZXh0O1xyXG4gICAgICAgICAgICAgICAgX2QuYm9keS5zdHlsZS5vdmVyZmxvdyA9IHRoaXMuX3ZhcmlhYmxlLl9ib2R5T3ZlcmZsb3c7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRleHQub3B0aW9uLnN0aWNreVRvb2xiYXIgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlQ2xhc3MoY29udGV4dC5lbGVtZW50LnRvb2xiYXIsICdzdW4tZWRpdG9yLXN0aWNreScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50Lm9uU2Nyb2xsX3dpbmRvdygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlQ2xhc3MoZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCwgJ2ljb24tcmVkdWN0aW9uJyk7XHJcbiAgICAgICAgICAgICAgICB1dGlsLmFkZENsYXNzKGVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQsICdpY29uLWV4cGFuc2lvbicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIE9wZW4gdGhlIHByZXZpZXcgd2luZG93IG9yIG9wZW4gdGhlIHByaW50IHdpbmRvd1xyXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtb2RlIC0gJ3ByZXZpZXcnIG9yICdwcmludCdcclxuICAgICAgICAgKi9cclxuICAgICAgICBvcGVuV2luZG93Q29udGVudHM6IGZ1bmN0aW9uIChtb2RlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzUHJpbnQgPSBtb2RlID09PSAncHJpbnQnO1xyXG4gICAgICAgICAgICBjb25zdCB3aW5kb3dPYmplY3QgPSBfdy5vcGVuKCcnLCAnX2JsYW5rJyk7XHJcbiAgICAgICAgICAgIHdpbmRvd09iamVjdC5taW1lVHlwZSA9ICd0ZXh0L2h0bWwnO1xyXG4gICAgICAgICAgICB3aW5kb3dPYmplY3QuZG9jdW1lbnQud3JpdGUoJycgK1xyXG4gICAgICAgICAgICAgICAgJzwhZG9jdHlwZSBodG1sPjxodG1sPicgK1xyXG4gICAgICAgICAgICAgICAgJzxoZWFkPicgK1xyXG4gICAgICAgICAgICAgICAgJzxtZXRhIGNoYXJzZXQ9XCJ1dGYtOFwiIC8+JyArXHJcbiAgICAgICAgICAgICAgICAnPG1ldGEgbmFtZT1cInZpZXdwb3J0XCIgY29udGVudD1cIndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xXCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRpdGxlPicgKyAoaXNQcmludCA/IGxhbmcudG9vbGJhci5wcmludCA6IGxhbmcudG9vbGJhci5wcmV2aWV3KSArICc8L3RpdGxlPicgK1xyXG4gICAgICAgICAgICAgICAgJzxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiB0eXBlPVwidGV4dC9jc3NcIiBocmVmPVwiJyArIHV0aWwuZ2V0SW5jbHVkZVBhdGgoWydzdW5lZGl0b3ItY29udGVudHMnLCAnc3VuZWRpdG9yJ10sICdjc3MnKSArICdcIj4nICtcclxuICAgICAgICAgICAgICAgICc8L2hlYWQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPGJvZHk+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInN1bi1lZGl0b3ItZWRpdGFibGVcIiBzdHlsZT1cIndpZHRoOicgKyBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5vZmZzZXRXaWR0aCArICdweDsgbWFyZ2luOmF1dG87XCI+JyArXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldENvbnRlbnRzKCkgKyAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAoaXNQcmludCA/ICc8c2NyaXB0Pl93LnByaW50KCk7PC9zY3JpcHQ+JyA6ICcnKSArICc8L2JvZHk+JyArXHJcbiAgICAgICAgICAgICAgICAnPC9odG1sPicpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBHZXRzIHRoZSBjdXJyZW50IGNvbnRlbnRzXHJcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH1cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRDb250ZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsZXQgY29udGVudHMgPSAnJztcclxuXHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5pbm5lclRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGNvbnRlbnRzO1xyXG5cclxuICAgICAgICAgICAgaWYgKGVkaXRvci5fdmFyaWFibGUud3lzaXd5Z0FjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgY29udGVudHMgPSBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5pbm5lckhUTUw7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50cyA9IHV0aWwuY29udmVydENvbnRlbnRzRm9yRWRpdG9yKGNvbnRleHQuZWxlbWVudC5jb2RlLnZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVuZGVySFRNTCA9IHV0aWwuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICAgICAgICAgIHJlbmRlckhUTUwuaW5uZXJIVE1MID0gY29udGVudHM7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBmaWdjYXB0aW9ucyA9IHV0aWwuZ2V0TGlzdENoaWxkcmVuKHJlbmRlckhUTUwsIGZ1bmN0aW9uIChjdXJyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gL0ZJR0NBUFRJT04vaS50ZXN0KGN1cnJlbnQubm9kZU5hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBmaWdjYXB0aW9ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZmlnY2FwdGlvbnNbaV0ub3V0ZXJIVE1MID0gZmlnY2FwdGlvbnNbaV0ub3V0ZXJIVE1MLnJlcGxhY2UoLyg/IV48ZmlnY2FwdGlvblxccyspKGNvbnRlbnRlZGl0YWJsZT1cIihbYS16XSt8XFxzKilcIilcXHMqKD89W14+XSo+KS9pLCAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZW5kZXJIVE1MLmlubmVySFRNTDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIGV2ZW50IGZ1bmN0aW9uXHJcbiAgICAgKi9cclxuICAgIGNvbnN0IGV2ZW50ID0ge1xyXG4gICAgICAgIF9zaG9ydGN1dEtleUNvZGU6IHtcclxuICAgICAgICAgICAgNjY6IFsnYm9sZCcsICdCJ10sXHJcbiAgICAgICAgICAgIDgzOiBbJ3N0cmlrZXRocm91Z2gnLCAnU1RSSUtFJ10sXHJcbiAgICAgICAgICAgIDg1OiBbJ3VuZGVybGluZScsICdVJ10sXHJcbiAgICAgICAgICAgIDczOiBbJ2l0YWxpYycsICdJJ10sXHJcbiAgICAgICAgICAgIDg5OiBbJ3JlZG8nXSxcclxuICAgICAgICAgICAgOTA6IFsndW5kbyddLFxyXG4gICAgICAgICAgICAyMTk6IFsnb3V0ZGVudCddLFxyXG4gICAgICAgICAgICAyMjE6IFsnaW5kZW50J11cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfZGlyZWN0aW9uS2V5S2V5Q29kZTogbmV3IFJlZ0V4cCgnXig/Ojh8MTN8MzJ8NDZ8MzN8MzR8MzV8MzZ8Mzd8Mzh8Mzl8NDB8OTh8MTAwfDEwMnwxMDQpJCcpLFxyXG5cclxuICAgICAgICBfY2hhbmdlQnV0dG9uQ2xhc3NUYWdDaGVjazogbmV3IFJlZ0V4cCgnXig/OkJ8VXxJfFNUUklLRXxTVUJ8U1VQKSQnKSxcclxuXHJcbiAgICAgICAgX2ZpbmRCdXR0b25FZmZlY3RUYWc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgY29tbWFuZE1hcCA9IGVkaXRvci5jb21tYW5kTWFwO1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc09uQ2hlY2sgPSB0aGlzLl9jaGFuZ2VCdXR0b25DbGFzc1RhZ0NoZWNrO1xyXG4gICAgICAgICAgICBjb25zdCBjb21tYW5kTWFwTm9kZXMgPSBbXTtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudE5vZGVzID0gW107XHJcblxyXG4gICAgICAgICAgICBsZXQgZmluZEZvcm1hdCA9IHRydWUsIGZpbmRGb250ID0gdHJ1ZSwgZmluZFNpemUgPSB0cnVlLCBmaW5kQSA9IHRydWU7XHJcbiAgICAgICAgICAgIGxldCBmaW5kQiA9IHRydWUsIGZpbmRJID0gdHJ1ZSwgZmluZFUgPSB0cnVlLCBmaW5kUyA9IHRydWU7XHJcbiAgICAgICAgICAgIGxldCBjc3NUZXh0ID0gJycsIG5vZGVOYW1lID0gJyc7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBzZWxlY3Rpb25QYXJlbnQgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uTm9kZSgpOyAhdXRpbC5pc1d5c2l3eWdEaXYoc2VsZWN0aW9uUGFyZW50KTsgc2VsZWN0aW9uUGFyZW50ID0gc2VsZWN0aW9uUGFyZW50LnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uUGFyZW50KSBicmVhaztcclxuICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rpb25QYXJlbnQubm9kZVR5cGUgIT09IDEpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgbm9kZU5hbWUgPSBzZWxlY3Rpb25QYXJlbnQubm9kZU5hbWUudG9VcHBlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnROb2Rlcy5wdXNoKG5vZGVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvKiogRm9ybWF0ICovXHJcbiAgICAgICAgICAgICAgICBpZiAoZmluZEZvcm1hdCAmJiB1dGlsLmlzRm9ybWF0RWxlbWVudChzZWxlY3Rpb25QYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZE1hcE5vZGVzLnB1c2goJ0ZPUk1BVCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHV0aWwuY2hhbmdlVHh0KGNvbW1hbmRNYXAuRk9STUFULCBub2RlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmluZEZvcm1hdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qKiBGb250ICovXHJcbiAgICAgICAgICAgICAgICBpZiAoZmluZEZvbnQgJiYgKHNlbGVjdGlvblBhcmVudC5zdHlsZS5mb250RmFtaWx5Lmxlbmd0aCA+IDAgfHwgKHNlbGVjdGlvblBhcmVudC5mYWNlICYmIHNlbGVjdGlvblBhcmVudC5mYWNlLmxlbmd0aCA+IDApKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRNYXBOb2Rlcy5wdXNoKCdGT05UJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0Rm9udCA9IChzZWxlY3Rpb25QYXJlbnQuc3R5bGUuZm9udEZhbWlseSB8fCBzZWxlY3Rpb25QYXJlbnQuZmFjZSB8fCBsYW5nLnRvb2xiYXIuZm9udCkucmVwbGFjZSgvW1wiJ10vZywnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC5jaGFuZ2VUeHQoY29tbWFuZE1hcC5GT05ULCBzZWxlY3RGb250KTtcclxuICAgICAgICAgICAgICAgICAgICBmaW5kRm9udCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qKiBBICovXHJcbiAgICAgICAgICAgICAgICBpZiAoZmluZEEgJiYgL15BJC8udGVzdChub2RlTmFtZSkgJiYgc2VsZWN0aW9uUGFyZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1pbWFnZS1saW5rJykgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRleHQubGluayB8fCBlZGl0b3IuY29udHJvbGxlckFycmF5WzBdICE9PSBjb250ZXh0LmxpbmsubGlua0J0bikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuY2FsbFBsdWdpbignbGluaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5wbHVnaW5zLmxpbmsuY2FsbF9jb250cm9sbGVyX2xpbmtCdXR0b24uY2FsbChlZGl0b3IsIHNlbGVjdGlvblBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBmaW5kQSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaW5kQSAmJiBjb250ZXh0LmxpbmsgJiYgZWRpdG9yLmNvbnRyb2xsZXJBcnJheVswXSA9PT0gY29udGV4dC5saW5rLmxpbmtCdG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IuY29udHJvbGxlcnNPZmYoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvKiogU1BBTiAqL1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbmRTaXplICYmIC9eU1BBTiQvLnRlc3Qobm9kZU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLyoqIGZvbnQgc2l6ZSAqL1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rpb25QYXJlbnQuc3R5bGUuZm9udFNpemUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kTWFwTm9kZXMucHVzaCgnU0laRScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1dGlsLmNoYW5nZVR4dChjb21tYW5kTWFwLlNJWkUsIHNlbGVjdGlvblBhcmVudC5zdHlsZS5mb250U2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRTaXplID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qKiBjb21tYW5kIG1hcCAqL1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dCA9IHNlbGVjdGlvblBhcmVudC5zdHlsZS5jc3NUZXh0O1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbmRCICYmIC9mb250XFwtd2VpZ2h0XFxzKjpcXHMqKD86XFxkK3xib2xkfGJvbGRlcikoPzo7fFxcc3wpLy50ZXN0KGNzc1RleHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZE1hcE5vZGVzLnB1c2goJ0InKTtcclxuICAgICAgICAgICAgICAgICAgICBmaW5kQiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGZpbmRJICYmIC9mb250XFwtc3R5bGVcXHMqOlxccyooPzppdGFsaWN8b2JsaXF1ZSkoPzo7fFxccykvLnRlc3QoY3NzVGV4dCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kTWFwTm9kZXMucHVzaCgnSScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbmRJID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZmluZFUgJiYgL3RleHRcXC1kZWNvcmF0aW9uKD86XFwtbGluZSk/XFxzKjpcXHMqdW5kZXJsaW5lKD86O3xcXHN8KS8udGVzdChjc3NUZXh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRNYXBOb2Rlcy5wdXNoKCdVJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmluZFUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChmaW5kUyAmJiAvdGV4dFxcLWRlY29yYXRpb24oPzpcXC1saW5lKT9cXHMqOlxccypsaW5lLXRocm91Z2goPzo7fFxcc3wpLy50ZXN0KGNzc1RleHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZE1hcE5vZGVzLnB1c2goJ1NUUklLRScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbmRTID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29tbWFuZE1hcE5vZGVzLnB1c2goKC9eU1RST05HJC8udGVzdChub2RlTmFtZSkgPyAnQicgOiAvXkVNJC8udGVzdChub2RlTmFtZSkgPyAnSScgOiBub2RlTmFtZSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiogQSBUYWcgZWRpdCBjb250cm9sbGVyIG9mZiAqL1xyXG4gICAgICAgICAgICBpZiAoZmluZEEpIGVkaXRvci5jb250cm9sbGVyc09mZigpO1xyXG5cclxuICAgICAgICAgICAgLyoqIHRvZ2dsZSBjbGFzcyBvbiAqL1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbW1hbmRNYXBOb2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbm9kZU5hbWUgPSBjb21tYW5kTWFwTm9kZXNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoY2xhc3NPbkNoZWNrLnRlc3Qobm9kZU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC5hZGRDbGFzcyhjb21tYW5kTWFwW25vZGVOYW1lXSwgJ29uJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qKiByZW1vdmUgY2xhc3MsIGRpc3BsYXkgdGV4dCAqL1xyXG4gICAgICAgICAgICBmb3IgKGxldCBrZXkgaW4gY29tbWFuZE1hcCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmRNYXBOb2Rlcy5pbmRleE9mKGtleSkgPiAtMSkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoL15GT05UL2kudGVzdChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC5jaGFuZ2VUeHQoY29tbWFuZE1hcFtrZXldLCBsYW5nLnRvb2xiYXIuZm9udCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgvXlNJWkUkL2kudGVzdChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC5jaGFuZ2VUeHQoY29tbWFuZE1hcFtrZXldLCBsYW5nLnRvb2xiYXIuZm9udFNpemUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbC5yZW1vdmVDbGFzcyhjb21tYW5kTWFwW2tleV0sICdvbicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiogc2F2ZSBjdXJyZW50IG5vZGVzICovXHJcbiAgICAgICAgICAgIGVkaXRvci5fdmFyaWFibGUuY3VycmVudE5vZGVzID0gY3VycmVudE5vZGVzLnJldmVyc2UoKTtcclxuXHJcbiAgICAgICAgICAgIC8qKiAgRGlzcGxheXMgdGhlIGN1cnJlbnQgbm9kZSBzdHJ1Y3R1cmUgdG8gcmVzaXppbmdCYXIgKi9cclxuICAgICAgICAgICAgaWYgKGNvbnRleHQub3B0aW9uLnNob3dQYXRoTGFiZWwpIGNvbnRleHQuZWxlbWVudC5uYXZpZ2F0aW9uLnRleHRDb250ZW50ID0gZWRpdG9yLl92YXJpYWJsZS5jdXJyZW50Tm9kZXMuam9pbignID4gJyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2NhbmNlbENhcHRpb25FZGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIGV2ZW50Ll9jYW5jZWxDYXB0aW9uRWRpdCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25Nb3VzZURvd25fdG9vbGJhcjogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgbGV0IHRhcmdldCA9IGUudGFyZ2V0O1xyXG5cclxuICAgICAgICAgICAgaWYgKHV0aWwuZ2V0UGFyZW50RWxlbWVudCh0YXJnZXQsICcuc3VuLWVkaXRvci1zdWJtZW51JykpIHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgY29tbWFuZCA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29tbWFuZCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGNsYXNzTmFtZSA9IHRhcmdldC5jbGFzc05hbWU7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHdoaWxlICghY29tbWFuZCAmJiAhL2VkaXRvcl90b29sLy50ZXN0KGNsYXNzTmFtZSkgJiYgIS9zdW4tZWRpdG9yLWlkLXRvb2xiYXIvLnRlc3QoY2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWNvbW1hbmQnKTtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSB0YXJnZXQuY2xhc3NOYW1lO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZCA9PT0gZWRpdG9yLl9zdWJtZW51TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbkNsaWNrX3Rvb2xiYXI6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgICAgICAgICAgbGV0IGRpc3BsYXkgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWRpc3BsYXknKTtcclxuICAgICAgICAgICAgbGV0IGNvbW1hbmQgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWNvbW1hbmQnKTtcclxuICAgICAgICAgICAgbGV0IGNsYXNzTmFtZSA9IHRhcmdldC5jbGFzc05hbWU7XHJcblxyXG4gICAgICAgICAgICB3aGlsZSAoIWNvbW1hbmQgJiYgIS9lZGl0b3JfdG9vbC8udGVzdChjbGFzc05hbWUpICYmICEvc3VuLWVkaXRvci1pZC10b29sYmFyLy50ZXN0KGNsYXNzTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgY29tbWFuZCA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29tbWFuZCcpO1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZGlzcGxheScpO1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gdGFyZ2V0LmNsYXNzTmFtZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFjb21tYW5kICYmICFkaXNwbGF5KSByZXR1cm47XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuZGlzYWJsZWQpIHJldHVybjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGVkaXRvci5mb2N1cygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLyoqIERpYWxvZywgU3VibWVudSAqL1xyXG4gICAgICAgICAgICBpZiAoZGlzcGxheSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKC9zdWJtZW51Ly50ZXN0KGRpc3BsYXkpICYmICh0YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nID09PSBudWxsIHx8IHRhcmdldCAhPT0gZWRpdG9yLnN1Ym1lbnVBY3RpdmVCdXR0b24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmNhbGxQbHVnaW4oY29tbWFuZCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc3VibWVudU9uKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoL2RpYWxvZy8udGVzdChkaXNwbGF5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5jYWxsUGx1Z2luKGNvbW1hbmQsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnBsdWdpbnMuZGlhbG9nLm9wZW4uY2FsbChlZGl0b3IsIGNvbW1hbmQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnN1Ym1lbnVPZmYoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLyoqIGRlZmF1bHQgY29tbWFuZCAqL1xyXG4gICAgICAgICAgICBpZiAoY29tbWFuZCkge1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLmNvbW1hbmRIYW5kbGVyKHRhcmdldCwgY29tbWFuZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbk1vdXNlVXBfd3lzaXd5ZzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBlZGl0b3IuX2VkaXRvclJhbmdlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZWRpdG9yLl9pc0JhbGxvb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLmdldFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmFuZ2UuY29sbGFwc2VkKSBldmVudC5faGlkZVRvb2xiYXIoKTtcclxuICAgICAgICAgICAgICAgIGVsc2UgZXZlbnQuX3Nob3dUb29sYmFyQmFsbG9vbihyYW5nZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbkNsaWNrX3d5c2l3eWc6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBlLnRhcmdldDtcclxuXHJcbiAgICAgICAgICAgIGlmICgvXklNRyQvaS50ZXN0KHRhcmdldEVsZW1lbnQubm9kZU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IuY2FsbFBsdWdpbignaW1hZ2UnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IGVkaXRvci5wbHVnaW5zLnJlc2l6aW5nLmNhbGxfY29udHJvbGxlcl9yZXNpemUuY2FsbChlZGl0b3IsIHRhcmdldEVsZW1lbnQsICdpbWFnZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5wbHVnaW5zLmltYWdlLm9uTW9kaWZ5TW9kZS5jYWxsKGVkaXRvciwgdGFyZ2V0RWxlbWVudCwgc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF1dGlsLmdldFBhcmVudEVsZW1lbnQodGFyZ2V0RWxlbWVudCwgJy5zdW4tZWRpdG9yLWlkLWltYWdlLWNvbnRhaW5lcicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5wbHVnaW5zLmltYWdlLm9wZW5Nb2RpZnkuY2FsbChlZGl0b3IsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IucGx1Z2lucy5pbWFnZS51cGRhdGVfaW1hZ2UuY2FsbChlZGl0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuY29udHJvbGxlcnNPZmYoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgvc3VuLWVkaXRvci1pZC1pZnJhbWUtaW5uZXItcmVzaXppbmctY292ZXIvaS50ZXN0KHRhcmdldEVsZW1lbnQuY2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLmNhbGxQbHVnaW4oJ3ZpZGVvJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlmcmFtZSA9IHV0aWwuZ2V0Q2hpbGRFbGVtZW50KHRhcmdldEVsZW1lbnQucGFyZW50Tm9kZSwgJ2lmcmFtZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNpemUgPSBlZGl0b3IucGx1Z2lucy5yZXNpemluZy5jYWxsX2NvbnRyb2xsZXJfcmVzaXplLmNhbGwoZWRpdG9yLCBpZnJhbWUsICd2aWRlbycpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5wbHVnaW5zLnZpZGVvLm9uTW9kaWZ5TW9kZS5jYWxsKGVkaXRvciwgaWZyYW1lLCBzaXplKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXZlbnQuX2ZpbmRCdXR0b25FZmZlY3RUYWcoKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGZpZ2NhcHRpb24gPSB1dGlsLmdldFBhcmVudEVsZW1lbnQodGFyZ2V0RWxlbWVudCwgJ0ZJR0NBUFRJT04nKTtcclxuICAgICAgICAgICAgaWYgKGZpZ2NhcHRpb24gJiYgZmlnY2FwdGlvbi5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnRlZGl0YWJsZScpICE9PSAndHVyZScpIHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGZpZ2NhcHRpb24uc2V0QXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGZpZ2NhcHRpb24uZm9jdXMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLl9pc0lubGluZSAmJiAhZWRpdG9yLl9pbmxpbmVUb29sYmFyQXR0ci5pc1Nob3cpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5fc2hvd1Rvb2xiYXJJbmxpbmUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGlkZVRvb2xiYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50Ll9oaWRlVG9vbGJhcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVUb29sYmFyKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBfZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVUb29sYmFyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRkID0gdXRpbC5nZXRQYXJlbnRFbGVtZW50KHRhcmdldEVsZW1lbnQsIHV0aWwuaXNDZWxsKTtcclxuICAgICAgICAgICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuY29udHJvbGxlckFycmF5Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuY2FsbFBsdWdpbigndGFibGUnLCBlZGl0b3IucGx1Z2lucy50YWJsZS5jYWxsX2NvbnRyb2xsZXJfdGFibGVFZGl0LmJpbmQoZWRpdG9yLCB0ZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHVzZXJGdW5jdGlvbi5vbkNsaWNrKSB1c2VyRnVuY3Rpb24ub25DbGljayhlKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfc2hvd1Rvb2xiYXJCYWxsb29uOiBmdW5jdGlvbiAocmFuZ2VPYmopIHtcclxuICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSByYW5nZU9iaiB8fCBlZGl0b3IuZ2V0UmFuZ2UoKTtcclxuICAgICAgICAgICAgY29uc3QgcGFkZGluZyA9IDIwO1xyXG4gICAgICAgICAgICBjb25zdCB0b29sYmFyID0gY29udGV4dC5lbGVtZW50LnRvb2xiYXI7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IF93LmdldFNlbGVjdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGlzRGlyVG9wO1xyXG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uLmZvY3VzTm9kZSA9PT0gc2VsZWN0aW9uLmFuY2hvck5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGlzRGlyVG9wID0gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0IDwgc2VsZWN0aW9uLmFuY2hvck9mZnNldDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZXMgPSB1dGlsLmdldExpc3RDaGlsZE5vZGVzKHJhbmdlLmNvbW1vbkFuY2VzdG9yQ29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgIGlzRGlyVG9wID0gdXRpbC5nZXRBcnJheUluZGV4KGNoaWxkTm9kZXMsIHNlbGVjdGlvbi5mb2N1c05vZGUpIDwgdXRpbC5nZXRBcnJheUluZGV4KGNoaWxkTm9kZXMsIHNlbGVjdGlvbi5hbmNob3JOb2RlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IHJlY3RzID0gcmFuZ2UuZ2V0Q2xpZW50UmVjdHMoKTtcclxuICAgICAgICAgICAgcmVjdHMgPSByZWN0c1tpc0RpclRvcCA/IDAgOiByZWN0cy5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRvb2xiYXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0b29sYmFyV2lkdGggPSB0b29sYmFyLm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICBjb25zdCB0b29sYmFySGVpZ2h0ID0gdG9vbGJhci5vZmZzZXRIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICBsZXQgbCA9IChpc0RpclRvcCA/IHJlY3RzLmxlZnQgOiByZWN0cy5yaWdodCkgLSBjb250ZXh0LmVsZW1lbnQudG9wQXJlYS5vZmZzZXRMZWZ0ICsgKF93LnNjcm9sbFggfHwgX2QuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQpIC0gdG9vbGJhcldpZHRoIC8gMjtcclxuICAgICAgICAgICAgbGV0IHQgPSAoaXNEaXJUb3AgPyByZWN0cy50b3AgLSB0b29sYmFySGVpZ2h0IC0gMTEgOiByZWN0cy5ib3R0b20gKyAxMSkgLSBjb250ZXh0LmVsZW1lbnQudG9wQXJlYS5vZmZzZXRUb3AgKyAoX3cuc2Nyb2xsWSB8fCBfZC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG92ZXJSaWdodCA9IGwgKyB0b29sYmFyV2lkdGggLSBjb250ZXh0LmVsZW1lbnQudG9wQXJlYS5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRvb2xiYXIuc3R5bGUubGVmdCA9IChsIDwgMCA/IHBhZGRpbmcgOiBvdmVyUmlnaHQgPCAwID8gbCA6IGwgLSBvdmVyUmlnaHQgLSBwYWRkaW5nKSArICdweCc7XHJcbiAgICAgICAgICAgIHRvb2xiYXIuc3R5bGUudG9wID0gKHQpICsgJ3B4JztcclxuXHJcbiAgICAgICAgICAgIGlmIChpc0RpclRvcCkge1xyXG4gICAgICAgICAgICAgICAgdXRpbC5yZW1vdmVDbGFzcyhjb250ZXh0LmVsZW1lbnQuX2Fycm93LCAnYXJyb3ctdXAnKTtcclxuICAgICAgICAgICAgICAgIHV0aWwuYWRkQ2xhc3MoY29udGV4dC5lbGVtZW50Ll9hcnJvdywgJ2Fycm93LWRvd24nKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5fYXJyb3cuc3R5bGUudG9wID0gKHRvb2xiYXJIZWlnaHQpICsgJ3B4JztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlQ2xhc3MoY29udGV4dC5lbGVtZW50Ll9hcnJvdywgJ2Fycm93LWRvd24nKTtcclxuICAgICAgICAgICAgICAgIHV0aWwuYWRkQ2xhc3MoY29udGV4dC5lbGVtZW50Ll9hcnJvdywgJ2Fycm93LXVwJyk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQuX2Fycm93LnN0eWxlLnRvcCA9ICctMTFweCc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGFycm93X3dpZHRoID0gY29udGV4dC5lbGVtZW50Ll9hcnJvdy5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgY29uc3QgYXJyb3dfbGVmdCA9ICh0b29sYmFyV2lkdGggLyAyICsgKGwgPCAwID8gbCAtIGFycm93X3dpZHRoIDogb3ZlclJpZ2h0IDwgMCA/IDAgOiBvdmVyUmlnaHQgKyBhcnJvd193aWR0aCkpO1xyXG4gICAgICAgICAgICBjb25zdCBhcnJvd19wb2ludF93aWR0aCA9IGFycm93X3dpZHRoIC8gMjtcclxuICAgICAgICAgICAgY29udGV4dC5lbGVtZW50Ll9hcnJvdy5zdHlsZS5sZWZ0ID0gKGFycm93X2xlZnQgPCBhcnJvd19wb2ludF93aWR0aCA/IGFycm93X3BvaW50X3dpZHRoIDogYXJyb3dfbGVmdCArIGFycm93X3BvaW50X3dpZHRoID49IHRvb2xiYXJXaWR0aCA/IGFycm93X2xlZnQgLSBhcnJvd19wb2ludF93aWR0aCA6IGFycm93X2xlZnQpICsgJ3B4JztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfc2hvd1Rvb2xiYXJJbmxpbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgdG9vbGJhciA9IGNvbnRleHQuZWxlbWVudC50b29sYmFyO1xyXG4gICAgICAgICAgICB0b29sYmFyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgICBlZGl0b3IuX2lubGluZVRvb2xiYXJBdHRyLndpZHRoID0gdG9vbGJhci5zdHlsZS53aWR0aCA9IGNvbnRleHQub3B0aW9uLnRvb2xiYXJXaWR0aDtcclxuICAgICAgICAgICAgZWRpdG9yLl9pbmxpbmVUb29sYmFyQXR0ci50b3AgPSB0b29sYmFyLnN0eWxlLnRvcCA9ICgtMSAtIHRvb2xiYXIub2Zmc2V0SGVpZ2h0KSArICdweCc7XHJcbiAgICAgICAgICAgIGV2ZW50Lm9uU2Nyb2xsX3dpbmRvdygpO1xyXG4gICAgICAgICAgICBlZGl0b3IuX2lubGluZVRvb2xiYXJBdHRyLmlzU2hvdyA9IHRydWU7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2hpZGVUb29sYmFyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC50b29sYmFyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIGVkaXRvci5faW5saW5lVG9vbGJhckF0dHIuaXNTaG93ID0gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25LZXlEb3duX3d5c2l3eWc6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleUNvZGUgPSBlLmtleUNvZGU7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoaWZ0ID0gZS5zaGlmdEtleTtcclxuICAgICAgICAgICAgY29uc3QgY3RybCA9IGUuY3RybEtleSB8fCBlLm1ldGFLZXk7XHJcbiAgICAgICAgICAgIGNvbnN0IGFsdCA9IGUuYWx0S2V5O1xyXG5cclxuICAgICAgICAgICAgaWYgKGVkaXRvci5faXNCYWxsb29uKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5faGlkZVRvb2xiYXIoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gc2hvcnRjdXRDb21tYW5kKGtleUNvZGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IGV2ZW50Ll9zaG9ydGN1dEtleUNvZGVba2V5Q29kZV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIWtleSkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIGVkaXRvci5jb21tYW5kSGFuZGxlcih1dGlsLmdldEZvcm1hdEVsZW1lbnQoZWRpdG9yLmdldFNlbGVjdGlvbk5vZGUoKSksIGtleVswXSk7XHJcbiAgICAgICAgICAgICAgICB1dGlsLnRvZ2dsZUNsYXNzKGVkaXRvci5jb21tYW5kTWFwW2tleVsxXV0sICdvbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiogU2hvcnRjdXRzICovXHJcbiAgICAgICAgICAgIGlmIChjdHJsICYmICEvXig/OjE2fDE3fDE4KSQvLnRlc3Qoa2V5Q29kZSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKCFzaGlmdCAmJiBrZXlDb2RlID09PSA4MykgJiYgc2hvcnRjdXRDb21tYW5kKGtleUNvZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLyoqIGRlZmF1bHQga2V5IGFjdGlvbiAqL1xyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25Ob2RlID0gZWRpdG9yLmdldFNlbGVjdGlvbk5vZGUoKTtcclxuICAgICAgICAgICAgc3dpdGNoIChrZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDg6IC8qKmJhY2tzcGFjZSBrZXkqL1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1dGlsLmlzRm9ybWF0RWxlbWVudChzZWxlY3Rpb25Ob2RlKSAmJiB1dGlsLmlzV3lzaXd5Z0RpdihzZWxlY3Rpb25Ob2RlLnBhcmVudE5vZGUpICYmIHNlbGVjdGlvbk5vZGUucHJldmlvdXNTaWJsaW5nID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uTm9kZS5pbm5lckhUTUwgPSB1dGlsLnplcm9XaWR0aFNwYWNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA5OlxyXG4gICAgICAgICAgICAgICAgICAgIC8qKnRhYiBrZXkqL1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY3RybCB8fCBhbHQpIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IuY29udHJvbGxlcnNPZmYoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gc2VsZWN0aW9uTm9kZSB8fCBlZGl0b3IuZ2V0U2VsZWN0aW9uTm9kZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICghdXRpbC5pc0NlbGwoY3VycmVudE5vZGUpICYmICF1dGlsLmlzV3lzaXd5Z0RpdihjdXJyZW50Tm9kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlICYmIHV0aWwuaXNDZWxsKGN1cnJlbnROb2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWJsZSA9IHV0aWwuZ2V0UGFyZW50RWxlbWVudChjdXJyZW50Tm9kZSwgJ3RhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gdXRpbC5nZXRMaXN0Q2hpbGRyZW4odGFibGUsIHV0aWwuaXNDZWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlkeCA9IHNoaWZ0ID8gdXRpbC5wcmV2SWR4KGNlbGxzLCBjdXJyZW50Tm9kZSkgOiB1dGlsLm5leHRJZHgoY2VsbHMsIGN1cnJlbnROb2RlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHggPT09IGNlbGxzLmxlbmd0aCAmJiAhc2hpZnQpIGlkeCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHggPT09IC0xICYmIHNoaWZ0KSBpZHggPSBjZWxscy5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbW92ZUNlbGwgPSBjZWxsc1tpZHhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1vdmVDZWxsKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0UmFuZ2UobW92ZUNlbGwsIDAsIG1vdmVDZWxsLCAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLyoqIGZvcm1hdCBUYWcgKi9cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGVkaXRvci5nZXRTZWxlY3RlZEZvcm1hdEVsZW1lbnRzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2hpZnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFiVGV4dCA9IHV0aWwuY3JlYXRlVGV4dE5vZGUobmV3IEFycmF5KGVkaXRvci5fdmFyaWFibGUudGFiU2l6ZSArIDEpLmpvaW4oJ1xcdTAwQTAnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5pbnNlcnROb2RlKHRhYlRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldFJhbmdlKHRhYlRleHQsIGVkaXRvci5fdmFyaWFibGUudGFiU2l6ZSwgdGFiVGV4dCwgZWRpdG9yLl92YXJpYWJsZS50YWJTaXplKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBsaW5lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzW2ldLmluc2VydEJlZm9yZSh0YWJUZXh0LmNsb25lTm9kZShmYWxzZSksIGxpbmVzW2ldLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGxpbmVzLmxlbmd0aCwgY2hpbGQ7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBsaW5lc1tpXS5maXJzdENoaWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC9eXFxzezEsNH0kLy50ZXN0KGNoaWxkLnRleHRDb250ZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwucmVtb3ZlSXRlbShjaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKC9eXFxzezEsNH0vLnRlc3QoY2hpbGQudGV4dENvbnRlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQudGV4dENvbnRlbnQgPSBjaGlsZC50ZXh0Q29udGVudC5yZXBsYWNlKC9eXFxzezEsNH0vLCAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXNlckZ1bmN0aW9uLm9uS2V5RG93bikgdXNlckZ1bmN0aW9uLm9uS2V5RG93bihlKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbktleVVwX3d5c2l3eWc6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGVkaXRvci5fZWRpdG9yUmFuZ2UoKTtcclxuICAgICAgICAgICAgZWRpdG9yLmNvbnRyb2xsZXJzT2ZmKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbk5vZGUgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uTm9kZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGVkaXRvci5faXNCYWxsb29uICYmICFlZGl0b3IuZ2V0UmFuZ2UoKS5jb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50Ll9zaG93VG9vbGJhckJhbGxvb24oKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLyoqIHdoZW4gZm9ybWF0IHRhZyBkZWxldGVkICovXHJcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDggJiYgdXRpbC5pc1d5c2l3eWdEaXYoc2VsZWN0aW9uTm9kZSkgJiYgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcudGV4dENvbnRlbnQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IG9Gb3JtYXRUYWcgPSB1dGlsLmNyZWF0ZUVsZW1lbnQodXRpbC5pc0Zvcm1hdEVsZW1lbnQoZWRpdG9yLl92YXJpYWJsZS5jdXJyZW50Tm9kZXNbMF0pID8gZWRpdG9yLl92YXJpYWJsZS5jdXJyZW50Tm9kZXNbMF0gOiAnUCcpO1xyXG4gICAgICAgICAgICAgICAgb0Zvcm1hdFRhZy5pbm5lckhUTUwgPSB1dGlsLnplcm9XaWR0aFNwYWNlO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbk5vZGUuYXBwZW5kQ2hpbGQob0Zvcm1hdFRhZyk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0UmFuZ2Uob0Zvcm1hdFRhZywgMCwgb0Zvcm1hdFRhZywgMCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgodXRpbC5pc1d5c2l3eWdEaXYoc2VsZWN0aW9uTm9kZS5wYXJlbnRFbGVtZW50KSB8fCB1dGlsLmlzUmFuZ2VGb3JtYXRFbGVtZW50KHNlbGVjdGlvbk5vZGUucGFyZW50RWxlbWVudCkpICYmIHNlbGVjdGlvbk5vZGUubm9kZVR5cGUgPT09IDMpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnZm9ybWF0QmxvY2snLCBmYWxzZSwgdXRpbC5pc1d5c2l3eWdEaXYoc2VsZWN0aW9uTm9kZS5wYXJlbnRFbGVtZW50KSA/ICdQJyA6ICdESVYnKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50Ll9maW5kQnV0dG9uRWZmZWN0VGFnKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChldmVudC5fZGlyZWN0aW9uS2V5S2V5Q29kZS50ZXN0KGUua2V5Q29kZSkpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50Ll9maW5kQnV0dG9uRWZmZWN0VGFnKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh1c2VyRnVuY3Rpb24ub25LZXlVcCkgdXNlckZ1bmN0aW9uLm9uS2V5VXAoZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25TY3JvbGxfd3lzaXd5ZzogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgZWRpdG9yLmNvbnRyb2xsZXJzT2ZmKCk7XHJcbiAgICAgICAgICAgIGlmICh1c2VyRnVuY3Rpb24ub25TY3JvbGwpIHVzZXJGdW5jdGlvbi5vblNjcm9sbChlKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbkRyb3Bfd3lzaXd5ZzogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgY29uc3QgZmlsZXMgPSBlLmRhdGFUcmFuc2Zlci5maWxlcztcclxuXHJcbiAgICAgICAgICAgIGlmIChmaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBlZGl0b3IuZm9jdXMoKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgZWRpdG9yLmNhbGxQbHVnaW4oJ2ltYWdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuaW1hZ2UuaW1nSW5wdXRGaWxlLmZpbGVzID0gZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnBsdWdpbnMuaW1hZ2Uub25SZW5kZXJfaW1nSW5wdXQuY2FsbChlZGl0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuaW1hZ2UuaW1nSW5wdXRGaWxlLmZpbGVzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXNlckZ1bmN0aW9uLm9uRHJvcCkgdXNlckZ1bmN0aW9uLm9uRHJvcChlKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbk1vdXNlRG93bl9yZXNpemluZ0JhcjogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgIGVkaXRvci5fdmFyaWFibGUucmVzaXplQ2xpZW50WSA9IGUuY2xpZW50WTtcclxuICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnJlc2l6ZUJhY2tncm91bmQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjbG9zdXJlRnVuYygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5yZXNpemVCYWNrZ3JvdW5kLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgICAgICBfZC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBldmVudC5fcmVzaXplX2VkaXRvcik7XHJcbiAgICAgICAgICAgICAgICBfZC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgY2xvc3VyZUZ1bmMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBldmVudC5fcmVzaXplX2VkaXRvcik7XHJcbiAgICAgICAgICAgIF9kLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBjbG9zdXJlRnVuYyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3Jlc2l6ZV9lZGl0b3I6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc2l6ZUludGVydmFsID0gY29udGV4dC5lbGVtZW50LmVkaXRvckFyZWEub2Zmc2V0SGVpZ2h0ICsgKGUuY2xpZW50WSAtIGVkaXRvci5fdmFyaWFibGUucmVzaXplQ2xpZW50WSk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLnN0eWxlLmhlaWdodCA9IGNvbnRleHQuZWxlbWVudC5jb2RlLnN0eWxlLmhlaWdodCA9IChyZXNpemVJbnRlcnZhbCA8IGVkaXRvci5fdmFyaWFibGUubWluUmVzaXppbmdTaXplID8gZWRpdG9yLl92YXJpYWJsZS5taW5SZXNpemluZ1NpemUgOiByZXNpemVJbnRlcnZhbCkgKyAncHgnO1xyXG4gICAgICAgICAgICBlZGl0b3IuX3ZhcmlhYmxlLnJlc2l6ZUNsaWVudFkgPSBlLmNsaWVudFk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25SZXNpemVfd2luZG93OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0LmVsZW1lbnQudG9vbGJhci5vZmZzZXRXaWR0aCA9PT0gMCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYgKGVkaXRvci5fdmFyaWFibGUuaXNGdWxsU2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IuX3ZhcmlhYmxlLmlubmVySGVpZ2h0X2Z1bGxTY3JlZW4gKz0gKF93LmlubmVySGVpZ2h0IC0gY29udGV4dC5lbGVtZW50LnRvb2xiYXIub2Zmc2V0SGVpZ2h0KSAtIGVkaXRvci5fdmFyaWFibGUuaW5uZXJIZWlnaHRfZnVsbFNjcmVlbjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5lZGl0b3JBcmVhLnN0eWxlLmhlaWdodCA9IGVkaXRvci5fdmFyaWFibGUuaW5uZXJIZWlnaHRfZnVsbFNjcmVlbiArICdweCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZWRpdG9yLl92YXJpYWJsZS5fc3RpY2t5KSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQudG9vbGJhci5zdHlsZS53aWR0aCA9IChjb250ZXh0LmVsZW1lbnQudG9wQXJlYS5vZmZzZXRXaWR0aCAtIDIpICsgJ3B4JztcclxuICAgICAgICAgICAgICAgIGV2ZW50Lm9uU2Nyb2xsX3dpbmRvdygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlZGl0b3IuY29udHJvbGxlcnNPZmYoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvblNjcm9sbF93aW5kb3c6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGVkaXRvci5fdmFyaWFibGUuaXNGdWxsU2NyZWVuIHx8IGNvbnRleHQuZWxlbWVudC50b29sYmFyLm9mZnNldFdpZHRoID09PSAwKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gY29udGV4dC5lbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBlZGl0b3JIZWlnaHQgPSBlbGVtZW50LmVkaXRvckFyZWEub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgICAgICBjb25zdCBlZGl0b3JUb3AgPSBlbGVtZW50LnRvcEFyZWEub2Zmc2V0VG9wIC0gKGVkaXRvci5faXNJbmxpbmUgPyBlbGVtZW50LnRvb2xiYXIub2Zmc2V0SGVpZ2h0IDogMCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHkgPSAodGhpcy5zY3JvbGxZIHx8IF9kLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApICsgY29udGV4dC5vcHRpb24uc3RpY2t5VG9vbGJhcjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh5IDwgZWRpdG9yVG9wKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5fb2ZmU3RpY2t5VG9vbGJhcihlbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh5ICsgZWRpdG9yLl92YXJpYWJsZS5taW5SZXNpemluZ1NpemUgPj0gZWRpdG9ySGVpZ2h0ICsgZWRpdG9yVG9wKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWVkaXRvci5fdmFyaWFibGUuX3N0aWNreSkgZXZlbnQuX29uU3RpY2t5VG9vbGJhcihlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQudG9vbGJhci5zdHlsZS50b3AgPSAoZWRpdG9ySGVpZ2h0ICsgZWRpdG9yVG9wICsgY29udGV4dC5vcHRpb24uc3RpY2t5VG9vbGJhciAteSAtIGVkaXRvci5fdmFyaWFibGUubWluUmVzaXppbmdTaXplKSArICdweCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoeSA+PSBlZGl0b3JUb3ApIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50Ll9vblN0aWNreVRvb2xiYXIoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfb25TdGlja3lUb29sYmFyOiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoIWVkaXRvci5faXNJbmxpbmUpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3N0aWNreUR1bW15LnN0eWxlLmhlaWdodCA9IGVsZW1lbnQudG9vbGJhci5vZmZzZXRIZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5fc3RpY2t5RHVtbXkuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGVsZW1lbnQudG9vbGJhci5zdHlsZS50b3AgPSBjb250ZXh0Lm9wdGlvbi5zdGlja3lUb29sYmFyICsgJ3B4JztcclxuICAgICAgICAgICAgZWxlbWVudC50b29sYmFyLnN0eWxlLndpZHRoID0gZWRpdG9yLl9pc0lubGluZSA/IGVkaXRvci5faW5saW5lVG9vbGJhckF0dHIud2lkdGggOiBlbGVtZW50LnRvb2xiYXIub2Zmc2V0V2lkdGggKyAncHgnO1xyXG4gICAgICAgICAgICB1dGlsLmFkZENsYXNzKGVsZW1lbnQudG9vbGJhciwgJ3N1bi1lZGl0b3Itc3RpY2t5Jyk7XHJcbiAgICAgICAgICAgIGVkaXRvci5fdmFyaWFibGUuX3N0aWNreSA9IHRydWU7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX29mZlN0aWNreVRvb2xiYXI6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuX3N0aWNreUR1bW15LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIGVsZW1lbnQudG9vbGJhci5zdHlsZS50b3AgPSBlZGl0b3IuX2lzSW5saW5lID8gZWRpdG9yLl9pbmxpbmVUb29sYmFyQXR0ci50b3AgOiAnJztcclxuICAgICAgICAgICAgZWxlbWVudC50b29sYmFyLnN0eWxlLndpZHRoID0gZWRpdG9yLl9pc0lubGluZSA/IGVkaXRvci5faW5saW5lVG9vbGJhckF0dHIud2lkdGggOiAnJztcclxuICAgICAgICAgICAgZWxlbWVudC5lZGl0b3JBcmVhLnN0eWxlLm1hcmdpblRvcCA9ICcnO1xyXG4gICAgICAgICAgICB1dGlsLnJlbW92ZUNsYXNzKGVsZW1lbnQudG9vbGJhciwgJ3N1bi1lZGl0b3Itc3RpY2t5Jyk7XHJcbiAgICAgICAgICAgIGVkaXRvci5fdmFyaWFibGUuX3N0aWNreSA9IGZhbHNlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9jb2RlVmlld0F1dG9TY3JvbGw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LmNvZGUuc3R5bGUuaGVpZ2h0ID0gY29udGV4dC5lbGVtZW50LmNvZGUuc2Nyb2xsSGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvblBhc3RlX3d5c2l3eWc6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmICghZS5jbGlwYm9hcmREYXRhLmdldERhdGEpIHJldHVybiB0cnVlO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2xlYW5EYXRhID0gdXRpbC5jbGVhbkhUTUwoZS5jbGlwYm9hcmREYXRhLmdldERhdGEoJ3RleHQvaHRtbCcpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChjbGVhbkRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnaW5zZXJ0SFRNTCcsIGZhbHNlLCBjbGVhbkRhdGEpO1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqIGFkZCBldmVudCBsaXN0ZW5lcnMgKi9cclxuICAgIC8qKiB0b29sYmFyIGV2ZW50ICovXHJcbiAgICBjb250ZXh0LmVsZW1lbnQudG9vbGJhci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBldmVudC5vbk1vdXNlRG93bl90b29sYmFyLCBmYWxzZSk7XHJcbiAgICBjb250ZXh0LmVsZW1lbnQudG9vbGJhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50Lm9uQ2xpY2tfdG9vbGJhciwgZmFsc2UpO1xyXG4gICAgLyoqIGVkaXRvciBhcmVhICovXHJcbiAgICBjb250ZXh0LmVsZW1lbnQucmVsYXRpdmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlZGl0b3IuZm9jdXMuYmluZChlZGl0b3IpLCBmYWxzZSk7XHJcbiAgICBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZXZlbnQub25Nb3VzZVVwX3d5c2l3eWcsIGZhbHNlKTtcclxuICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQub25DbGlja193eXNpd3lnLCBmYWxzZSk7XHJcbiAgICBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBldmVudC5vblNjcm9sbF93eXNpd3lnLCBmYWxzZSk7XHJcbiAgICBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZlbnQub25LZXlEb3duX3d5c2l3eWcsIGZhbHNlKTtcclxuICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZXZlbnQub25LZXlVcF93eXNpd3lnLCBmYWxzZSk7XHJcbiAgICBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgZXZlbnQub25Ecm9wX3d5c2l3eWcsIGZhbHNlKTtcclxuICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgZXZlbnQub25QYXN0ZV93eXNpd3lnLCBmYWxzZSk7XHJcbiAgICBcclxuICAgIC8qKiBjb2RlIHZpZXcgYXJlYSBhdXRvIGxpbmUgKi9cclxuICAgIGlmIChjb250ZXh0Lm9wdGlvbi5oZWlnaHQgPT09ICdhdXRvJykgY29udGV4dC5lbGVtZW50LmNvZGUuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBldmVudC5fY29kZVZpZXdBdXRvU2Nyb2xsLCBmYWxzZSk7XHJcblxyXG4gICAgLyoqIHJlc2l6aW5nQmFyICovXHJcbiAgICBpZiAoY29udGV4dC5lbGVtZW50LnJlc2l6aW5nQmFyKSB7XHJcbiAgICAgICAgaWYgKC9cXGQrLy50ZXN0KGNvbnRleHQub3B0aW9uLmhlaWdodCkpIHtcclxuICAgICAgICAgICAgY29udGV4dC5lbGVtZW50LnJlc2l6aW5nQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGV2ZW50Lm9uTW91c2VEb3duX3Jlc2l6aW5nQmFyLCBmYWxzZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdXRpbC5hZGRDbGFzcyhjb250ZXh0LmVsZW1lbnQucmVzaXppbmdCYXIsICdub25lLXJlc2l6ZScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiogaW5saW5lIGVkaXRvciAqL1xyXG4gICAgaWYgKGVkaXRvci5faXNJbmxpbmUpIHtcclxuICAgICAgICBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIGV2ZW50Ll9zaG93VG9vbGJhcklubGluZSwgZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlZGl0b3IuX2lzSW5saW5lIHx8IGVkaXRvci5faXNCYWxsb29uKSB7XHJcbiAgICAgICAgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGV2ZW50Ll9oaWRlVG9vbGJhciwgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKiogd2luZG93IGV2ZW50ICovXHJcbiAgICBfdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBldmVudC5vblJlc2l6ZV93aW5kb3csIGZhbHNlKTtcclxuICAgIGlmIChjb250ZXh0Lm9wdGlvbi5zdGlja3lUb29sYmFyID4gLTEpIF93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGV2ZW50Lm9uU2Nyb2xsX3dpbmRvdywgZmFsc2UpO1xyXG5cclxuICAgIC8qKiBhZGQgcGx1Z2luIHRvIHBsdWdpbnMgb2JqZWN0ICovXHJcbiAgICBpZiAocGx1Z2lucykge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHBsdWdpbnMpLm1hcChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgbGV0IHBsdWdpbiA9IHBsdWdpbnNba2V5XTtcclxuICAgICAgICAgICAgZWRpdG9yLnBsdWdpbnNbcGx1Z2luLm5hbWVdID0gdXRpbC5jb3B5T2JqKHBsdWdpbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIFVzZXIgZnVuY3Rpb24gKi9cclxuICAgIGNvbnN0IHVzZXJGdW5jdGlvbiA9IHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gRXZlbnQgZnVuY3Rpb25zXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IC0gRXZlbnQgT2JqZWN0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgb25TY3JvbGw6IG51bGwsXHJcbiAgICAgICAgb25DbGljazogbnVsbCxcclxuICAgICAgICBvbktleURvd246IG51bGwsXHJcbiAgICAgICAgb25LZXlVcDogbnVsbCxcclxuICAgICAgICBvbkRyb3A6IG51bGwsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBDYWxsZWQgd2hlbiB0aGUgaW1hZ2UgaXMgdXBsb2FkZWQgb3IgdGhlIHVwbG9hZGVkIGltYWdlIGlzIGRlbGV0ZWRcclxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhcmdldEltZ0VsZW1lbnQgLSBDdXJyZW50IGltZyBlbGVtZW50XHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IC0gVXBsb2FkZWQgaW5kZXhcclxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzRGVsZXRlIC0gV2hldGhlciBvciBub3QgaXQgd2FzIGNhbGxlZCBhZnRlciB0aGUgZGVsZXRlIG9wZXJhdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZUluZm8gLSBJbWFnZSBpbmZvIG9iamVjdFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG9uSW1hZ2VVcGxvYWQ6IG51bGwsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBDYWxsZWQgd2hlbiB0aGUgaW1hZ2UgaXMgdXBsb2FkIGZhaWxlZFxyXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBlcnJvck1lc3NhZ2UgLSBFcnJvciBtZXNzYWdlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHJlc3VsdCAtIFJlc3VsdCBpbmZvIE9iamVjdFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG9uSW1hZ2VVcGxvYWRFcnJvcjogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIE9wZW4gYSBub3RpY2UgYXJlYVxyXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIC0gTm90aWNlIG1lc3NhZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBub3RpY2VPcGVuOiBmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgICAgICAgICBlZGl0b3IuYWRkTW9kdWxlKFtub3RpY2VdKTtcclxuICAgICAgICAgICAgbm90aWNlLm9wZW4uY2FsbChlZGl0b3IsIG1lc3NhZ2UpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBDbG9zZSBhIG5vdGljZSBhcmVhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbm90aWNlQ2xvc2U6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZWRpdG9yLmFkZE1vZHVsZShbbm90aWNlXSk7XHJcbiAgICAgICAgICAgIG5vdGljZS5jbG9zZS5jYWxsKGVkaXRvcik7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIENvcHlpbmcgdGhlIGNvbnRlbnRzIG9mIHRoZSBlZGl0b3IgdG8gdGhlIG9yaWdpbmFsIHRleHRhcmVhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2F2ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQub3JpZ2luRWxlbWVudC52YWx1ZSA9IGVkaXRvci5nZXRDb250ZW50cygpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBHZXRzIHRoZSBzdW5lZGl0b3IncyBjb250ZXh0IG9iamVjdC4gQ29udGFpbnMgc2V0dGluZ3MsIHBsdWdpbnMsIGFuZCBjYWNoZWQgZWxlbWVudCBvYmplY3RzXHJcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH1cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRDb250ZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBHZXRzIHRoZSBjb250ZW50cyBvZiB0aGUgc3VuZWRpdG9yXHJcbiAgICAgICAgICogQHJldHVybnMge1N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRDb250ZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZWRpdG9yLmdldENvbnRlbnRzKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEdldHMgdXBsb2FkZWQgaW1hZ2VzIGluZm9ybWF0aW9uc1xyXG4gICAgICAgICAqIEByZXR1cm5zIHtBcnJheX1cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRJbWFnZXNJbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlZGl0b3IuX3ZhcmlhYmxlLl9pbWFnZXNJbmZvO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBJbnNlcnRzIGFuIEhUTUwgZWxlbWVudCBvciBIVE1MIHN0cmluZyBvciBwbGFpbiBzdHJpbmcgYXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fFN0cmluZ30gaHRtbCAtIEhUTUwgRWxlbWVudCBvciBIVE1MIHN0cmluZyBvciBwbGFpbiBzdHJpbmdcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbnNlcnRIVE1MOiBmdW5jdGlvbiAoaHRtbCkge1xyXG4gICAgICAgICAgICBpZiAoIWh0bWwubm9kZVR5cGUgfHwgaHRtbC5ub2RlVHlwZSAhPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB1dGlsLmNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJyk7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBodG1sO1xyXG4gICAgICAgICAgICAgICAgaHRtbCA9IHRlbXBsYXRlLmZpcnN0Q2hpbGQgfHwgdGVtcGxhdGUuY29udGVudC5maXJzdENoaWxkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlZGl0b3IuaW5zZXJ0Tm9kZShodG1sKTtcclxuICAgICAgICAgICAgZWRpdG9yLmZvY3VzKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIENoYW5nZSB0aGUgY29udGVudHMgb2YgdGhlIHN1bmVkaXRvclxyXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb250ZW50cyAtIENvbnRlbnRzIHRvIElucHV0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0Q29udGVudHM6IGZ1bmN0aW9uIChjb250ZW50cykge1xyXG4gICAgICAgICAgICBpZiAoZWRpdG9yLl92YXJpYWJsZS53eXNpd3lnQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQud3lzaXd5Zy5pbm5lckhUTUwgPSB1dGlsLmNvbnZlcnRDb250ZW50c0ZvckVkaXRvcihjb250ZW50cyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQuY29kZS52YWx1ZSA9IGNvbnRlbnRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZCBjb250ZW50cyB0byB0aGUgc3VuZWRpdG9yXHJcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbnRlbnRzIC0gQ29udGVudHMgdG8gSW5wdXRcclxuICAgICAgICAgKi9cclxuICAgICAgICBhcHBlbmRDb250ZW50czogZnVuY3Rpb24gKGNvbnRlbnRzKSB7XHJcbiAgICAgICAgICAgIGlmIChlZGl0b3IuX3ZhcmlhYmxlLnd5c2l3eWdBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLmlubmVySFRNTCArPSB1dGlsLmNvbnZlcnRDb250ZW50c0ZvckVkaXRvcihjb250ZW50cyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQuY29kZS52YWx1ZSArPSBjb250ZW50cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBEaXNhYmxlIHRoZSBzdW5lZGl0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBkaXNhYmxlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb250ZXh0LnRvb2wuY292ZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLnNldEF0dHJpYnV0ZSgnY29udGVudGVkaXRhYmxlJywgZmFsc2UpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQuY29kZS5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEVuYWJsZWQgdGhlIHN1bmVkaXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGVuYWJsZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29udGV4dC50b29sLmNvdmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC53eXNpd3lnLnNldEF0dHJpYnV0ZSgnY29udGVudGVkaXRhYmxlJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZWxlbWVudC5jb2RlLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU2hvdyB0aGUgc3VuZWRpdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2hvdzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zdCB0b3BBcmVhU3R5bGUgPSBjb250ZXh0LmVsZW1lbnQudG9wQXJlYS5zdHlsZTtcclxuICAgICAgICAgICAgaWYgKHRvcEFyZWFTdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHRvcEFyZWFTdHlsZS5kaXNwbGF5ID0gY29udGV4dC5vcHRpb24uZGlzcGxheTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gSGlkZSB0aGUgc3VuZWRpdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaGlkZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb250ZXh0LmVsZW1lbnQudG9wQXJlYS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBEZXN0cm95IHRoZSBzdW5lZGl0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBkZXN0cm95OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8qKiByZW1vdmUgd2luZG93IGV2ZW50IGxpc3RlbmVycyAqL1xyXG4gICAgICAgICAgICBfdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBldmVudC5vblJlc2l6ZV93aW5kb3cpO1xyXG4gICAgICAgICAgICBfdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBldmVudC5vblNjcm9sbF93aW5kb3cpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLyoqIHJlbW92ZSBlbGVtZW50ICovXHJcbiAgICAgICAgICAgIHV0aWwucmVtb3ZlSXRlbShjb250ZXh0LmVsZW1lbnQudG9wQXJlYSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm9uU2Nyb2xsID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5vbkNsaWNrID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5vbktleURvd24gPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLm9uS2V5VXAgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLm9uRHJvcCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMub25JbWFnZVVwbG9hZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMub25JbWFnZVVwbG9hZEVycm9yID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5ub3RpY2VPcGVuID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5ub3RpY2VDbG9zZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudHMgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmdldEltYWdlc0luZm8gPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmluc2VydEhUTUwgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLnNldENvbnRlbnRzID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5hcHBlbmRDb250ZW50cyA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmVuYWJsZWQgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLnNob3cgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmhpZGUgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3kgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgY29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgICAgIHBsdWdpbnMgPSBudWxsO1xyXG4gICAgICAgICAgICBsYW5nID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiB1c2VyRnVuY3Rpb247XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjb3JlOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUlBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFDQTtBQVdBOzs7Ozs7Ozs7OztBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQUNBO0FBbUJBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUFXQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUFXQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBdkRBO0FBQ0E7QUF5REE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBYUE7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3bERBO0FBZ21EQTs7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFXQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlEQTtBQUNBO0FBZ0VBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsa0JBO0FBcWtCQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBdkxBO0FBMExBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/lib/core.js\n");

/***/ }),

/***/ "./src/lib/util.js":
/*!*************************!*\
  !*** ./src/lib/util.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/*\r\n * wysiwyg web editor\r\n *\r\n * suneditor.js\r\n * Copyright 2017 JiHong Lee.\r\n * MIT license.\r\n */\n\n/**\r\n * @description utility function\r\n */\n\nconst util = {\n  _d: document,\n  _w: window,\n\n  /**\r\n   * @description Unicode Character 'ZERO WIDTH SPACE'\r\n   */\n  zeroWidthSpace: '\\u200B',\n\n  /**\r\n   * @description Gets XMLHttpRequest object\r\n   * @returns {Object}\r\n   */\n  getXMLHttpRequest: function () {\n    /** IE */\n    if (this._w.ActiveXObject) {\n      try {\n        return new ActiveXObject('Msxml2.XMLHTTP');\n      } catch (e) {\n        try {\n          return new ActiveXObject('Microsoft.XMLHTTP');\n        } catch (e1) {\n          return null;\n        }\n      }\n    }\n    /** netscape */\n    else if (this._w.XMLHttpRequest) {\n        return new XMLHttpRequest();\n      }\n      /** fail */\n      else {\n          return null;\n        }\n  },\n\n  /**\r\n   * @description Copies object\r\n   * @param {Object} obj - Object to be copy\r\n   * @returns {Object}\r\n   */\n  copyObj: function (obj) {\n    const copy = {};\n\n    for (let attr in obj) {\n      copy[attr] = obj[attr];\n    }\n\n    return copy;\n  },\n\n  /**\r\n   * @description Create Element node\r\n   * @param {String} elementName - Element name\r\n   * @returns {Element}\r\n   */\n  createElement: function (elementName) {\n    return this._d.createElement(elementName);\n  },\n\n  /**\r\n   * @description Create text node\r\n   * @param {String} text - text contents\r\n   * @returns {Node}\r\n   */\n  createTextNode: function (text) {\n    return this._d.createTextNode(text || '');\n  },\n\n  /**\r\n   * @description Get the the tag path of the arguments value\r\n   * If not found, return the first found value\r\n   * @param {Array} nameArray - File name array\r\n   * @param {String} extension - js, css\r\n   * @returns {String}\r\n   */\n  getIncludePath: function (nameArray, extension) {\n    let path = '';\n    const pathList = [];\n    const tagName = extension === 'js' ? 'script' : 'link';\n    const src = extension === 'js' ? 'src' : 'href';\n    let fileName = '(?:';\n\n    for (let i = 0, len = nameArray.length; i < len; i++) {\n      fileName += nameArray[i] + (i < len - 1 ? '|' : ')');\n    }\n\n    const regExp = new RegExp('(^|.*[\\\\\\\\\\/])' + fileName + '(\\\\.[^\\\\\\\\/]+)?\\.' + extension + '(?:\\\\?.*|;.*)?$', 'i');\n    const extRegExp = new RegExp('.+\\\\.' + extension + '(?:\\\\?.*|;.*)?$', 'i');\n\n    for (let c = this._d.getElementsByTagName(tagName), i = 0; i < c.length; i++) {\n      if (extRegExp.test(c[i][src])) {\n        pathList.push(c[i]);\n      }\n    }\n\n    for (let i = 0; i < pathList.length; i++) {\n      let editorTag = pathList[i][src].match(regExp);\n\n      if (editorTag) {\n        path = editorTag[0];\n        break;\n      }\n    }\n\n    if (path === '') path = pathList.length > 0 ? pathList[0][src] : '';\n    -1 === path.indexOf(':/') && '//' !== path.slice(0, 2) && (path = 0 === path.indexOf('/') ? location.href.match(/^.*?:\\/\\/[^\\/]*/)[0] + path : location.href.match(/^[^\\?]*\\/(?:)/)[0] + path);\n    if (!path) throw '[SUNEDITOR.util.getIncludePath.fail] The SUNEDITOR installation path could not be automatically detected. (name: +' + name + ', extension: ' + extension + ')';\n    return path;\n  },\n\n  /**\r\n   * @description Converts contents into a format that can be placed in an editor\r\n   * @param {String} contents - contents\r\n   * @returns {String}\r\n   */\n  convertContentsForEditor: function (contents) {\n    let tag,\n        baseHtml,\n        innerHTML = '';\n    contents = contents.trim();\n    tag = this._d.createRange().createContextualFragment(contents).childNodes;\n\n    for (let i = 0, len = tag.length; i < len; i++) {\n      baseHtml = tag[i].outerHTML || tag[i].textContent;\n\n      if (tag[i].nodeType === 3) {\n        const textArray = baseHtml.split(/\\n/g);\n        let text = '';\n\n        for (let t = 0, tLen = textArray.length; t < tLen; t++) {\n          text = textArray[t].trim();\n          if (text.length > 0) innerHTML += '<P>' + text + '</p>';\n        }\n      } else {\n        innerHTML += baseHtml;\n      }\n    }\n\n    const ec = {\n      '&': '&amp;',\n      '\\u00A0': '&nbsp;',\n      '\\'': '&quot;',\n      '<': '&lt;',\n      '>': '&gt;'\n    };\n    contents = contents.replace(/&|\\u00A0|'|<|>/g, function (m) {\n      return typeof ec[m] === 'string' ? ec[m] : m;\n    });\n    if (innerHTML.length === 0) innerHTML = '<p>' + (contents.length > 0 ? contents : this.zeroWidthSpace) + '</p>';\n    return innerHTML;\n  },\n\n  /**\r\n   * @description Converts HTML string into a format that can be placed in an editor of code view mode\r\n   * @param {String} html - HTML string\r\n   * @returns {String}\r\n   */\n  convertHTMLForCodeView: function (html) {\n    return html.replace(/\\s*<(?:li|td)\\s*(?:[a-z\\-]+)?\\s*(?:=\"?[^>]*\"?)?\\s*>/gi, this._insertIndent).replace(/<\\/?(?:blockquote|hr|ol|ul|table|tbody|thead|th|tr)\\s*(?:[a-z\\-]+)?\\s*(?:=\"?[^>]*\"?)?\\s*>(?=[^\\n])/gi, this._insertLineBreak).replace(/<\\/(?:p|div|h[1-6]|li|td|pre)>(?=[^\\n])/gi, this._insertLineBreak);\n  },\n\n  /**\r\n   * @description Add a line break to the open tag\r\n   * @param {String} matchTag - matched tag string\r\n   * @returns {String}\r\n   */\n  _insertIndent: function (matchTag) {\n    return '  ' + matchTag.trim();\n  },\n\n  /**\r\n   * @description Add a line breaks to the tags\r\n   * @param {String} matchTag - matched tag string\r\n   * @returns {String}\r\n   */\n  _insertLineBreak: function (matchTag) {\n    return matchTag + '\\n';\n  },\n\n  /**\r\n   * @description It is judged whether it is the edit region top div element.\r\n   * @param {Element} element - The element to check\r\n   * @returns {Boolean}\r\n   */\n  isWysiwygDiv: function (element) {\n    if (element && element.nodeType === 1 && this.hasClass(element, 'sun-editor-id-wysiwyg')) return true;\n    return false;\n  },\n\n  /**\r\n   * @description It is judged whether it is the format element (P, DIV, H1-6, LI, CODE)\r\n   * @param {Element} element - The element to check\r\n   * @returns {Boolean}\r\n   */\n  isFormatElement: function (element) {\n    if (element && element.nodeType === 1 && /^(?:P|DIV|H[1-6]|LI|CODE)$/i.test(element.nodeName) && !/sun-editor-id-comp/.test(element.className)) return true;\n    return false;\n  },\n\n  /**\r\n   * @description It is judged whether it is the range format element. (BLOCKQUOTE, TABLE, THEAD, TBODY, TH, TR, TD, OL, UL, PRE)\r\n   * * Range format element is wrap the format element  (P, DIV, H1-6, LI, CODE)\r\n   * @param {Element} element - The element to check\r\n   * @returns {Boolean}\r\n   */\n  isRangeFormatElement: function (element) {\n    if (element && element.nodeType === 1 && /^(?:BLOCKQUOTE|TABLE|THEAD|TBODY|TH|TR|TD|OL|UL|PRE|FIGCAPTION)$/i.test(element.nodeName)) return true;\n    return false;\n  },\n\n  /**\r\n   * @description Get format element of the argument value (P, DIV, H[1-6], LI)\r\n   * @param {Element} element - Reference element if null or no value, it is relative to the current focus node.\r\n   * @returns {Element}\r\n   */\n  getFormatElement: function (element) {\n    if (!element) return null;\n\n    while (!this.isFormatElement(element) && !this.isWysiwygDiv(element.parentNode)) {\n      element = element.parentNode;\n    }\n\n    if (this.isWysiwygDiv(element) || this.isRangeFormatElement(element)) {\n      const firstFormatElement = this.getListChildren(element, function (current) {\n        return this.isFormatElement(current);\n      }.bind(this))[0];\n      return firstFormatElement;\n    }\n\n    return element;\n  },\n\n  /**\r\n   * @description Get range format element of the argument value (blockquote, TABLE, TR, TD, OL, UL, PRE)\r\n   * @param {Element} element - Reference element if null or no value, it is relative to the current focus node.\r\n   * @returns {Element|null}\r\n   */\n  getRangeFormatElement: function (element) {\n    if (!element) return null;\n\n    while (!this.isRangeFormatElement(element) && !this.isWysiwygDiv(element)) {\n      element = element.parentNode;\n    }\n\n    return this.isWysiwygDiv(element) ? null : element;\n  },\n\n  /**\r\n   * @description Get the index of the argument value in the element array\r\n   * @param {array} array - element array\r\n   * @param {Element} element - Element to find index\r\n   * @returns {Number}\r\n   */\n  getArrayIndex: function (array, element) {\n    let idx = -1;\n\n    for (let i = 0, len = array.length; i < len; i++) {\n      if (array[i] === element) {\n        idx = i;\n        break;\n      }\n    }\n\n    return idx;\n  },\n\n  /**\r\n   * @description Get the next index of the argument value in the element array\r\n   * @param {array} array - element array\r\n   * @param {Element} item - Element to find index\r\n   * @returns {Number}\r\n   */\n  nextIdx: function (array, item) {\n    let idx = this.getArrayIndex(array, item);\n    if (idx === -1) return -1;\n    return idx + 1;\n  },\n\n  /**\r\n   * @description Get the previous index of the argument value in the element array\r\n   * @param {array} array - element array\r\n   * @param {Element} item - Element to find index\r\n   * @returns {Number}\r\n   */\n  prevIdx: function (array, item) {\n    let idx = this.getArrayIndex(array, item);\n    if (idx === -1) return -1;\n    return idx - 1;\n  },\n\n  /**\r\n   * @description Check the node is a table cell\r\n   * @param {Element} node - Nodes to check\r\n   * @returns {Boolean}\r\n   */\n  isCell: function (node) {\n    return node && /^(?:TD|TH)$/i.test(node.nodeName);\n  },\n\n  /**\r\n   * @description Check the node is a break node (BR)\r\n   * @param {Element} node - Nodes to check\r\n   * @returns {Boolean}\r\n   */\n  isBreak: function (node) {\n    return node && /^BR$/i.test(node.nodeName);\n  },\n\n  /**\r\n   * @description Get all child nodes of the argument value element (Without text node)\r\n   * @param {Element} element - element to get child node\r\n   * @param {(function|null)} validation - Conditional function\r\n   * @returns {Array}\r\n   */\n  getListChildren: function (element, validation) {\n    const children = [];\n    if (!element || !element.children) return children;\n\n    validation = validation || function () {\n      return true;\n    };\n\n    (function recursionFunc(current) {\n      if (element !== current && validation(current)) {\n        children.push(current);\n      }\n\n      for (let i = 0, len = current.children.length; i < len; i++) {\n        recursionFunc(current.children[i]);\n      }\n    })(element);\n\n    return children;\n  },\n\n  /**\r\n   * @description Get all child nodes of the argument value element (Include text nodes)\r\n   * @param {Element} element - element to get child node\r\n   * @param {(function|null)} validation - Conditional function\r\n   * @returns {Array}\r\n   */\n  getListChildNodes: function (element, validation) {\n    const children = [];\n    if (!element || !element.childNodes) return children;\n\n    validation = validation || function () {\n      return true;\n    };\n\n    (function recursionFunc(current) {\n      if (element !== current && validation(current)) {\n        children.push(current);\n      }\n\n      for (let i = 0, len = current.childNodes.length; i < len; i++) {\n        recursionFunc(current.childNodes[i]);\n      }\n    })(element);\n\n    return children;\n  },\n\n  /**\r\n   * @description Get the parent element of the argument value.\r\n   * A tag that satisfies the query condition is imported.\r\n   * Returns null if not found.\r\n   * @param {Node} element - Reference element\r\n   * @param {String|Function} query - Query String (tagName, .className, #ID, :name) or validation function.\r\n   * Not use it like jquery.\r\n   * Only one condition can be entered at a time.\r\n   * @returns {Element|null}\r\n   */\n  getParentElement: function (element, query) {\n    let check;\n\n    if (typeof query === 'function') {\n      check = query;\n    } else {\n      let attr;\n\n      if (/\\./.test(query)) {\n        attr = 'className';\n        query = query.split('.')[1];\n      } else if (/#/.test(query)) {\n        attr = 'id';\n        query = '^' + query.split('#')[1] + '$';\n      } else if (/:/.test(query)) {\n        attr = 'name';\n        query = '^' + query.split(':')[1] + '$';\n      } else {\n        attr = 'tagName';\n        query = '^' + query + '$';\n      }\n\n      const regExp = new RegExp(query, 'i');\n\n      check = function (el) {\n        return regExp.test(el[attr]);\n      };\n    }\n\n    while (element && (element.nodeType === 3 || !check(element))) {\n      if (this.isWysiwygDiv(element)) {\n        return null;\n      }\n\n      element = element.parentNode;\n    }\n\n    return element;\n  },\n\n  /**\r\n   * @description Get the child element of the argument value.\r\n   * A tag that satisfies the query condition is imported.\r\n   * Returns null if not found.\r\n   * @param {Node} element - Reference element\r\n   * @param {String|Function} query - Query String (tagName, .className, #ID, :name) or validation function.\r\n   * Not use it like jquery.\r\n   * Only one condition can be entered at a time.\r\n   * @returns {Element|null}\r\n   */\n  getChildElement: function (element, query) {\n    let check;\n\n    if (typeof query === 'function') {\n      check = query;\n    } else {\n      let attr;\n\n      if (/\\./.test(query)) {\n        attr = 'className';\n        query = query.split('.')[1];\n      } else if (/#/.test(query)) {\n        attr = 'id';\n        query = '^' + query.split('#')[1] + '$';\n      } else if (/:/.test(query)) {\n        attr = 'name';\n        query = '^' + query.split(':')[1] + '$';\n      } else {\n        attr = 'tagName';\n        query = '^' + query + '$';\n      }\n\n      const regExp = new RegExp(query, 'i');\n\n      check = function (el) {\n        return regExp.test(el[attr]);\n      };\n    }\n\n    const childList = this.getListChildren(element, function (current) {\n      return check(current);\n    });\n    return childList[0];\n  },\n\n  /**\r\n   * @description Returns the position of the left and top of argument. {left:0, top:0}\r\n   * @param {Element} element - Element node\r\n   * @returns {Object}\r\n   */\n  getOffset: function (element) {\n    let tableOffsetLeft = 0;\n    let tableOffsetTop = 0;\n    let tableElement = element.nodeType === 3 ? element.parentElement : element;\n\n    while (!this.isWysiwygDiv(tableElement.parentNode)) {\n      if (/^(A|TD|TH|FIGURE|FIGCAPTION|IMG|IFRAME)$/i.test(tableElement.nodeName) || /relative/i.test(tableElement.style.position)) {\n        tableOffsetLeft += tableElement.offsetLeft;\n        tableOffsetTop += tableElement.offsetTop;\n      }\n\n      tableElement = tableElement.parentNode;\n    }\n\n    return {\n      left: tableOffsetLeft,\n      top: tableOffsetTop - tableElement.parentNode.scrollTop\n    };\n  },\n\n  /**\r\n   * @description Set the text content value of the argument value element\r\n   * @param {Element} element - Element to replace text content\r\n   * @param {String} txt - Text to be applied\r\n   */\n  changeTxt: function (element, txt) {\n    if (!element || !txt) return;\n    element.textContent = txt;\n  },\n\n  /**\r\n   * @description Determine whether any of the matched elements are assigned the given class\r\n   * @param {Element} element - Elements to search class name\r\n   * @param {String} className - Class name to search for\r\n   * @returns {Boolean}\r\n   */\n  hasClass: function (element, className) {\n    if (!element) return;\n    return element.classList.contains(className.trim());\n  },\n\n  /**\r\n   * @description Append the className value of the argument value element\r\n   * @param {Element} element - Elements to add class name\r\n   * @param {String} className - Class name to be add\r\n   */\n  addClass: function (element, className) {\n    if (!element) return;\n    const check = new RegExp('(\\\\s|^)' + className + '(\\\\s|$)');\n    if (check.test(element.className)) return;\n    element.className += ' ' + className;\n  },\n\n  /**\r\n   * @description Delete the className value of the argument value element\r\n   * @param {Element} element - Elements to remove class name\r\n   * @param {String} className - Class name to be remove\r\n   */\n  removeClass: function (element, className) {\n    if (!element) return;\n    const check = new RegExp('(\\\\s|^)' + className + '(\\\\s|$)');\n    element.className = element.className.replace(check, ' ').trim();\n  },\n\n  /**\r\n   * @description Argument value If there is no class name, insert it and delete the class name if it exists\r\n   * @param {Element} element - Elements to replace class name\r\n   * @param {String} className - Class name to be change\r\n   */\n  toggleClass: function (element, className) {\n    if (!element) return;\n    const check = new RegExp('(\\\\s|^)' + className + '(\\\\s|$)');\n\n    if (check.test(element.className)) {\n      element.className = element.className.replace(check, ' ').trim();\n    } else {\n      element.className += ' ' + className;\n    }\n  },\n\n  /**\r\n   * @description Delete argumenu value element\r\n   * @param {Element} item - Element to be remove\r\n   */\n  removeItem: function (item) {\n    try {\n      item.remove();\n    } catch (e) {\n      item.parentNode.removeChild(item);\n    }\n  },\n\n  /**\r\n   * @description Delete a empty child node of argument element\r\n   * @param {Element} element - Element node\r\n   */\n  removeEmptyNode: function (element) {\n    (function recursionFunc(current) {\n      if (current.textContent.trim().length === 0 && !/^BR$/i.test(current.nodeName) && (!current.firstChild || !/^BR$/i.test(current.firstChild.nodeName))) {\n        current.parentNode && current.parentNode.removeChild(current);\n      } else {\n        for (let i = 0, len = current.children.length; i < len; i++) {\n          if (!current.children[i]) continue;\n          recursionFunc(current.children[i]);\n        }\n      }\n    })(element);\n  },\n\n  /**\r\n   * @description Gets the clean HTML code for editor\r\n   * @param {String} html - HTML string\r\n   */\n  cleanHTML: function (html) {\n    const tagsAllowed = new RegExp('^(P|DIV|PRE|H1|H2|H3|H4|H5|H6|B|U|I|STRIKE|SUB|SUP|OL|UL|TABLE|BR|HR|A|IMG|IFRAME)$', 'i');\n\n    const domTree = this._d.createRange().createContextualFragment(html).children;\n\n    let cleanHTML = '';\n\n    for (let i = 0, len = domTree.length; i < len; i++) {\n      if (tagsAllowed.test(domTree[i].nodeName)) {\n        cleanHTML += domTree[i].outerHTML.replace(/<!--(.*?)-->/g, '').replace(/<[a-zA-Z]+\\:[a-zA-Z]+.*>(\\n|.)*<\\/[a-zA-Z]+\\:[a-zA-Z]+>/g, '').replace(/\\s(?:style|class|dir|xmlns|data-[a-z\\-]+)\\s*(?:[a-z\\-]+)?\\s*(?:=\"?[^>]*\"?)?\\s*/ig, '').replace(/<\\/?(?:span|font)\\s*(?:[a-z\\-]+)?\\s*(?:=\"?[^>]*\"?)?\\s*>/ig, '').replace(/<\\/?[a-z]+:[a-z]+\\s*(?:[a-z\\-]+)?\\s*(?:=\"?[^>]*\"?)?\\s*>/ig, '');\n      }\n    }\n\n    return cleanHTML || html;\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (util);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbGliL3V0aWwuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbGliL3V0aWwuanM/ZjFlZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiB3eXNpd3lnIHdlYiBlZGl0b3JcclxuICpcclxuICogc3VuZWRpdG9yLmpzXHJcbiAqIENvcHlyaWdodCAyMDE3IEppSG9uZyBMZWUuXHJcbiAqIE1JVCBsaWNlbnNlLlxyXG4gKi9cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuLyoqXHJcbiAqIEBkZXNjcmlwdGlvbiB1dGlsaXR5IGZ1bmN0aW9uXHJcbiAqL1xyXG5jb25zdCB1dGlsID0ge1xyXG4gICAgX2Q6IGRvY3VtZW50LFxyXG4gICAgX3c6IHdpbmRvdyxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBVbmljb2RlIENoYXJhY3RlciAnWkVSTyBXSURUSCBTUEFDRSdcclxuICAgICAqL1xyXG4gICAgemVyb1dpZHRoU3BhY2U6ICdcXHUyMDBCJyxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBHZXRzIFhNTEh0dHBSZXF1ZXN0IG9iamVjdFxyXG4gICAgICogQHJldHVybnMge09iamVjdH1cclxuICAgICAqL1xyXG4gICAgZ2V0WE1MSHR0cFJlcXVlc3Q6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKiogSUUgKi9cclxuICAgICAgICBpZiAodGhpcy5fdy5BY3RpdmVYT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoJ01zeG1sMi5YTUxIVFRQJyk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KCdNaWNyb3NvZnQuWE1MSFRUUCcpO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZTEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvKiogbmV0c2NhcGUgKi9cclxuICAgICAgICBlbHNlIGlmICh0aGlzLl93LlhNTEh0dHBSZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqIGZhaWwgKi9cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBDb3BpZXMgb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIC0gT2JqZWN0IHRvIGJlIGNvcHlcclxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9XHJcbiAgICAgKi9cclxuICAgIGNvcHlPYmo6IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICBjb25zdCBjb3B5ID0ge307XHJcblxyXG4gICAgICAgIGZvciAobGV0IGF0dHIgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgIGNvcHlbYXR0cl0gPSBvYmpbYXR0cl07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY29weTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gQ3JlYXRlIEVsZW1lbnQgbm9kZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGVsZW1lbnROYW1lIC0gRWxlbWVudCBuYW1lXHJcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH1cclxuICAgICAqL1xyXG4gICAgY3JlYXRlRWxlbWVudDogZnVuY3Rpb24gKGVsZW1lbnROYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2QuY3JlYXRlRWxlbWVudChlbGVtZW50TmFtZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIENyZWF0ZSB0ZXh0IG5vZGVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0IC0gdGV4dCBjb250ZW50c1xyXG4gICAgICogQHJldHVybnMge05vZGV9XHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZVRleHROb2RlOiBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kLmNyZWF0ZVRleHROb2RlKHRleHQgfHwgJycpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBHZXQgdGhlIHRoZSB0YWcgcGF0aCBvZiB0aGUgYXJndW1lbnRzIHZhbHVlXHJcbiAgICAgKiBJZiBub3QgZm91bmQsIHJldHVybiB0aGUgZmlyc3QgZm91bmQgdmFsdWVcclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IG5hbWVBcnJheSAtIEZpbGUgbmFtZSBhcnJheVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGV4dGVuc2lvbiAtIGpzLCBjc3NcclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGdldEluY2x1ZGVQYXRoOiBmdW5jdGlvbiAobmFtZUFycmF5LCBleHRlbnNpb24pIHtcclxuICAgICAgICBsZXQgcGF0aCA9ICcnO1xyXG4gICAgICAgIGNvbnN0IHBhdGhMaXN0ID0gW107XHJcbiAgICAgICAgY29uc3QgdGFnTmFtZSA9IGV4dGVuc2lvbiA9PT0gJ2pzJyA/ICdzY3JpcHQnIDogJ2xpbmsnO1xyXG4gICAgICAgIGNvbnN0IHNyYyA9IGV4dGVuc2lvbiA9PT0gJ2pzJyA/ICdzcmMnIDogJ2hyZWYnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBmaWxlTmFtZSA9ICcoPzonO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBuYW1lQXJyYXkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgZmlsZU5hbWUgKz0gbmFtZUFycmF5W2ldICsgKGkgPCBsZW4gLSAxID8gJ3wnIDogJyknKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAoJyhefC4qW1xcXFxcXFxcXFwvXSknICsgZmlsZU5hbWUgKyAnKFxcXFwuW15cXFxcXFxcXC9dKyk/XFwuJyArIGV4dGVuc2lvbiArICcoPzpcXFxcPy4qfDsuKik/JCcsICdpJyk7XHJcbiAgICAgICAgY29uc3QgZXh0UmVnRXhwID0gbmV3IFJlZ0V4cCgnLitcXFxcLicgKyBleHRlbnNpb24gKyAnKD86XFxcXD8uKnw7LiopPyQnLCAnaScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICBmb3IgKGxldCBjID0gdGhpcy5fZC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKSwgaSA9IDA7IGkgPCBjLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChleHRSZWdFeHAudGVzdChjW2ldW3NyY10pKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoTGlzdC5wdXNoKGNbaV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdGhMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBlZGl0b3JUYWcgPSBwYXRoTGlzdFtpXVtzcmNdLm1hdGNoKHJlZ0V4cCk7XHJcbiAgICAgICAgICAgIGlmIChlZGl0b3JUYWcpIHtcclxuICAgICAgICAgICAgICAgIHBhdGggPSBlZGl0b3JUYWdbMF07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHBhdGggPT09ICcnKSBwYXRoID0gcGF0aExpc3QubGVuZ3RoID4gMCA/IHBhdGhMaXN0WzBdW3NyY10gOiAnJztcclxuXHJcbiAgICAgICAgLTEgPT09IHBhdGguaW5kZXhPZignOi8nKSAmJiAnLy8nICE9PSBwYXRoLnNsaWNlKDAsIDIpICYmIChwYXRoID0gMCA9PT0gcGF0aC5pbmRleE9mKCcvJykgPyBsb2NhdGlvbi5ocmVmLm1hdGNoKC9eLio/OlxcL1xcL1teXFwvXSovKVswXSArIHBhdGggOiBsb2NhdGlvbi5ocmVmLm1hdGNoKC9eW15cXD9dKlxcLyg/OikvKVswXSArIHBhdGgpO1xyXG5cclxuICAgICAgICBpZiAoIXBhdGgpIHRocm93ICdbU1VORURJVE9SLnV0aWwuZ2V0SW5jbHVkZVBhdGguZmFpbF0gVGhlIFNVTkVESVRPUiBpbnN0YWxsYXRpb24gcGF0aCBjb3VsZCBub3QgYmUgYXV0b21hdGljYWxseSBkZXRlY3RlZC4gKG5hbWU6ICsnICsgbmFtZSArICcsIGV4dGVuc2lvbjogJyArIGV4dGVuc2lvbiArICcpJztcclxuXHJcbiAgICAgICAgcmV0dXJuIHBhdGg7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIENvbnZlcnRzIGNvbnRlbnRzIGludG8gYSBmb3JtYXQgdGhhdCBjYW4gYmUgcGxhY2VkIGluIGFuIGVkaXRvclxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbnRlbnRzIC0gY29udGVudHNcclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGNvbnZlcnRDb250ZW50c0ZvckVkaXRvcjogZnVuY3Rpb24gKGNvbnRlbnRzKSB7XHJcbiAgICAgICAgbGV0IHRhZywgYmFzZUh0bWwsIGlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGNvbnRlbnRzID0gY29udGVudHMudHJpbSgpO1xyXG5cclxuICAgICAgICB0YWcgPSB0aGlzLl9kLmNyZWF0ZVJhbmdlKCkuY3JlYXRlQ29udGV4dHVhbEZyYWdtZW50KGNvbnRlbnRzKS5jaGlsZE5vZGVzO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gdGFnLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGJhc2VIdG1sID0gdGFnW2ldLm91dGVySFRNTCB8fCB0YWdbaV0udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgICAgICAgICBpZiAodGFnW2ldLm5vZGVUeXBlID09PSAzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0QXJyYXkgPSBiYXNlSHRtbC5zcGxpdCgvXFxuL2cpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRleHQgPSAnJztcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHQgPSAwLCB0TGVuID0gdGV4dEFycmF5Lmxlbmd0aDsgdCA8IHRMZW47IHQrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0QXJyYXlbdF0udHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDApIGlubmVySFRNTCArPSAnPFA+JyArIHRleHQgKyAnPC9wPic7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpbm5lckhUTUwgKz0gYmFzZUh0bWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGVjID0geycmJzogJyZhbXA7JywgJ1xcdTAwQTAnOiAnJm5ic3A7JywgJ1xcJyc6ICcmcXVvdDsnLCAnPCc6ICcmbHQ7JywgJz4nOiAnJmd0Oyd9O1xyXG4gICAgICAgIGNvbnRlbnRzID0gY29udGVudHMucmVwbGFjZSgvJnxcXHUwMEEwfCd8PHw+L2csIGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodHlwZW9mIGVjW21dID09PSAnc3RyaW5nJykgPyBlY1ttXSA6IG07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChpbm5lckhUTUwubGVuZ3RoID09PSAwKSBpbm5lckhUTUwgPSAnPHA+JyArIChjb250ZW50cy5sZW5ndGggPiAwID8gY29udGVudHMgOiB0aGlzLnplcm9XaWR0aFNwYWNlKSArICc8L3A+JztcclxuXHJcbiAgICAgICAgcmV0dXJuIGlubmVySFRNTDtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gQ29udmVydHMgSFRNTCBzdHJpbmcgaW50byBhIGZvcm1hdCB0aGF0IGNhbiBiZSBwbGFjZWQgaW4gYW4gZWRpdG9yIG9mIGNvZGUgdmlldyBtb2RlXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaHRtbCAtIEhUTUwgc3RyaW5nXHJcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBjb252ZXJ0SFRNTEZvckNvZGVWaWV3OiBmdW5jdGlvbiAoaHRtbCkge1xyXG4gICAgICAgIHJldHVybiBodG1sLnJlcGxhY2UoL1xccyo8KD86bGl8dGQpXFxzKig/OlthLXpcXC1dKyk/XFxzKig/Oj1cIj9bXj5dKlwiPyk/XFxzKj4vZ2ksIHRoaXMuX2luc2VydEluZGVudClcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvPFxcLz8oPzpibG9ja3F1b3RlfGhyfG9sfHVsfHRhYmxlfHRib2R5fHRoZWFkfHRofHRyKVxccyooPzpbYS16XFwtXSspP1xccyooPzo9XCI/W14+XSpcIj8pP1xccyo+KD89W15cXG5dKS9naSwgdGhpcy5faW5zZXJ0TGluZUJyZWFrKVxyXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC88XFwvKD86cHxkaXZ8aFsxLTZdfGxpfHRkfHByZSk+KD89W15cXG5dKS9naSwgdGhpcy5faW5zZXJ0TGluZUJyZWFrKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gQWRkIGEgbGluZSBicmVhayB0byB0aGUgb3BlbiB0YWdcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtYXRjaFRhZyAtIG1hdGNoZWQgdGFnIHN0cmluZ1xyXG4gICAgICogQHJldHVybnMge1N0cmluZ31cclxuICAgICAqL1xyXG4gICAgX2luc2VydEluZGVudDogZnVuY3Rpb24gKG1hdGNoVGFnKSB7XHJcbiAgICAgICAgcmV0dXJuICcgICcgKyBtYXRjaFRhZy50cmltKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIEFkZCBhIGxpbmUgYnJlYWtzIHRvIHRoZSB0YWdzXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWF0Y2hUYWcgLSBtYXRjaGVkIHRhZyBzdHJpbmdcclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIF9pbnNlcnRMaW5lQnJlYWs6IGZ1bmN0aW9uIChtYXRjaFRhZykge1xyXG4gICAgICAgIHJldHVybiBtYXRjaFRhZyArICdcXG4nO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBJdCBpcyBqdWRnZWQgd2hldGhlciBpdCBpcyB0aGUgZWRpdCByZWdpb24gdG9wIGRpdiBlbGVtZW50LlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gVGhlIGVsZW1lbnQgdG8gY2hlY2tcclxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAgICovXHJcbiAgICBpc1d5c2l3eWdEaXY6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSAmJiB0aGlzLmhhc0NsYXNzKGVsZW1lbnQsICdzdW4tZWRpdG9yLWlkLXd5c2l3eWcnKSkgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBJdCBpcyBqdWRnZWQgd2hldGhlciBpdCBpcyB0aGUgZm9ybWF0IGVsZW1lbnQgKFAsIERJViwgSDEtNiwgTEksIENPREUpXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgZWxlbWVudCB0byBjaGVja1xyXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGlzRm9ybWF0RWxlbWVudDogZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIC9eKD86UHxESVZ8SFsxLTZdfExJfENPREUpJC9pLnRlc3QoZWxlbWVudC5ub2RlTmFtZSkgJiYgIS9zdW4tZWRpdG9yLWlkLWNvbXAvLnRlc3QoZWxlbWVudC5jbGFzc05hbWUpKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIEl0IGlzIGp1ZGdlZCB3aGV0aGVyIGl0IGlzIHRoZSByYW5nZSBmb3JtYXQgZWxlbWVudC4gKEJMT0NLUVVPVEUsIFRBQkxFLCBUSEVBRCwgVEJPRFksIFRILCBUUiwgVEQsIE9MLCBVTCwgUFJFKVxyXG4gICAgICogKiBSYW5nZSBmb3JtYXQgZWxlbWVudCBpcyB3cmFwIHRoZSBmb3JtYXQgZWxlbWVudCAgKFAsIERJViwgSDEtNiwgTEksIENPREUpXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgZWxlbWVudCB0byBjaGVja1xyXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGlzUmFuZ2VGb3JtYXRFbGVtZW50OiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEgJiYgL14oPzpCTE9DS1FVT1RFfFRBQkxFfFRIRUFEfFRCT0RZfFRIfFRSfFREfE9MfFVMfFBSRXxGSUdDQVBUSU9OKSQvaS50ZXN0KGVsZW1lbnQubm9kZU5hbWUpKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIEdldCBmb3JtYXQgZWxlbWVudCBvZiB0aGUgYXJndW1lbnQgdmFsdWUgKFAsIERJViwgSFsxLTZdLCBMSSlcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFJlZmVyZW5jZSBlbGVtZW50IGlmIG51bGwgb3Igbm8gdmFsdWUsIGl0IGlzIHJlbGF0aXZlIHRvIHRoZSBjdXJyZW50IGZvY3VzIG5vZGUuXHJcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH1cclxuICAgICAqL1xyXG4gICAgZ2V0Rm9ybWF0RWxlbWVudDogZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoIWVsZW1lbnQpIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICB3aGlsZSAoIXRoaXMuaXNGb3JtYXRFbGVtZW50KGVsZW1lbnQpICYmICF0aGlzLmlzV3lzaXd5Z0RpdihlbGVtZW50LnBhcmVudE5vZGUpKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5pc1d5c2l3eWdEaXYoZWxlbWVudCkgfHwgdGhpcy5pc1JhbmdlRm9ybWF0RWxlbWVudChlbGVtZW50KSkge1xyXG4gICAgICAgICAgICBjb25zdCBmaXJzdEZvcm1hdEVsZW1lbnQgPSB0aGlzLmdldExpc3RDaGlsZHJlbihlbGVtZW50LCBmdW5jdGlvbiAoY3VycmVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNGb3JtYXRFbGVtZW50KGN1cnJlbnQpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpWzBdO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZpcnN0Rm9ybWF0RWxlbWVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBHZXQgcmFuZ2UgZm9ybWF0IGVsZW1lbnQgb2YgdGhlIGFyZ3VtZW50IHZhbHVlIChibG9ja3F1b3RlLCBUQUJMRSwgVFIsIFRELCBPTCwgVUwsIFBSRSlcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFJlZmVyZW5jZSBlbGVtZW50IGlmIG51bGwgb3Igbm8gdmFsdWUsIGl0IGlzIHJlbGF0aXZlIHRvIHRoZSBjdXJyZW50IGZvY3VzIG5vZGUuXHJcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudHxudWxsfVxyXG4gICAgICovXHJcbiAgICBnZXRSYW5nZUZvcm1hdEVsZW1lbnQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFlbGVtZW50KSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgd2hpbGUgKCF0aGlzLmlzUmFuZ2VGb3JtYXRFbGVtZW50KGVsZW1lbnQpICYmICF0aGlzLmlzV3lzaXd5Z0RpdihlbGVtZW50KSkge1xyXG4gICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNXeXNpd3lnRGl2KGVsZW1lbnQpID8gbnVsbCA6IGVsZW1lbnQ7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIEdldCB0aGUgaW5kZXggb2YgdGhlIGFyZ3VtZW50IHZhbHVlIGluIHRoZSBlbGVtZW50IGFycmF5XHJcbiAgICAgKiBAcGFyYW0ge2FycmF5fSBhcnJheSAtIGVsZW1lbnQgYXJyYXlcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIEVsZW1lbnQgdG8gZmluZCBpbmRleFxyXG4gICAgICogQHJldHVybnMge051bWJlcn1cclxuICAgICAqL1xyXG4gICAgZ2V0QXJyYXlJbmRleDogZnVuY3Rpb24gKGFycmF5LCBlbGVtZW50KSB7XHJcbiAgICAgICAgbGV0IGlkeCA9IC0xO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBhcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoYXJyYXlbaV0gPT09IGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlkeCA9IGk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGlkeDtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gR2V0IHRoZSBuZXh0IGluZGV4IG9mIHRoZSBhcmd1bWVudCB2YWx1ZSBpbiB0aGUgZWxlbWVudCBhcnJheVxyXG4gICAgICogQHBhcmFtIHthcnJheX0gYXJyYXkgLSBlbGVtZW50IGFycmF5XHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGl0ZW0gLSBFbGVtZW50IHRvIGZpbmQgaW5kZXhcclxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XHJcbiAgICAgKi9cclxuICAgIG5leHRJZHg6IGZ1bmN0aW9uIChhcnJheSwgaXRlbSkge1xyXG4gICAgICAgIGxldCBpZHggPSB0aGlzLmdldEFycmF5SW5kZXgoYXJyYXksIGl0ZW0pO1xyXG4gICAgICAgIGlmIChpZHggPT09IC0xKSByZXR1cm4gLTE7XHJcbiAgICAgICAgcmV0dXJuIGlkeCArIDE7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIEdldCB0aGUgcHJldmlvdXMgaW5kZXggb2YgdGhlIGFyZ3VtZW50IHZhbHVlIGluIHRoZSBlbGVtZW50IGFycmF5XHJcbiAgICAgKiBAcGFyYW0ge2FycmF5fSBhcnJheSAtIGVsZW1lbnQgYXJyYXlcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gaXRlbSAtIEVsZW1lbnQgdG8gZmluZCBpbmRleFxyXG4gICAgICogQHJldHVybnMge051bWJlcn1cclxuICAgICAqL1xyXG4gICAgcHJldklkeDogZnVuY3Rpb24gKGFycmF5LCBpdGVtKSB7XHJcbiAgICAgICAgbGV0IGlkeCA9IHRoaXMuZ2V0QXJyYXlJbmRleChhcnJheSwgaXRlbSk7XHJcbiAgICAgICAgaWYgKGlkeCA9PT0gLTEpIHJldHVybiAtMTtcclxuICAgICAgICByZXR1cm4gaWR4IC0gMTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gQ2hlY2sgdGhlIG5vZGUgaXMgYSB0YWJsZSBjZWxsXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG5vZGUgLSBOb2RlcyB0byBjaGVja1xyXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGlzQ2VsbDogZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICByZXR1cm4gbm9kZSAmJiAvXig/OlREfFRIKSQvaS50ZXN0KG5vZGUubm9kZU5hbWUpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBDaGVjayB0aGUgbm9kZSBpcyBhIGJyZWFrIG5vZGUgKEJSKVxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBub2RlIC0gTm9kZXMgdG8gY2hlY2tcclxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAgICovXHJcbiAgICBpc0JyZWFrOiBmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgIHJldHVybiBub2RlICYmIC9eQlIkL2kudGVzdChub2RlLm5vZGVOYW1lKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gR2V0IGFsbCBjaGlsZCBub2RlcyBvZiB0aGUgYXJndW1lbnQgdmFsdWUgZWxlbWVudCAoV2l0aG91dCB0ZXh0IG5vZGUpXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBlbGVtZW50IHRvIGdldCBjaGlsZCBub2RlXHJcbiAgICAgKiBAcGFyYW0geyhmdW5jdGlvbnxudWxsKX0gdmFsaWRhdGlvbiAtIENvbmRpdGlvbmFsIGZ1bmN0aW9uXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XHJcbiAgICAgKi9cclxuICAgIGdldExpc3RDaGlsZHJlbjogZnVuY3Rpb24gKGVsZW1lbnQsIHZhbGlkYXRpb24pIHtcclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIGlmICghZWxlbWVudCB8fCAhZWxlbWVudC5jaGlsZHJlbikgcmV0dXJuIGNoaWxkcmVuO1xyXG5cclxuICAgICAgICB2YWxpZGF0aW9uID0gdmFsaWRhdGlvbiB8fCBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9O1xyXG5cclxuICAgICAgICAoZnVuY3Rpb24gcmVjdXJzaW9uRnVuYyhjdXJyZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50ICE9PSBjdXJyZW50ICYmIHZhbGlkYXRpb24oY3VycmVudCkpIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goY3VycmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBjdXJyZW50LmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICByZWN1cnNpb25GdW5jKGN1cnJlbnQuY2hpbGRyZW5baV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkoZWxlbWVudCk7XHJcblxyXG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gR2V0IGFsbCBjaGlsZCBub2RlcyBvZiB0aGUgYXJndW1lbnQgdmFsdWUgZWxlbWVudCAoSW5jbHVkZSB0ZXh0IG5vZGVzKVxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gZWxlbWVudCB0byBnZXQgY2hpbGQgbm9kZVxyXG4gICAgICogQHBhcmFtIHsoZnVuY3Rpb258bnVsbCl9IHZhbGlkYXRpb24gLSBDb25kaXRpb25hbCBmdW5jdGlvblxyXG4gICAgICogQHJldHVybnMge0FycmF5fVxyXG4gICAgICovXHJcbiAgICBnZXRMaXN0Q2hpbGROb2RlczogZnVuY3Rpb24gKGVsZW1lbnQsIHZhbGlkYXRpb24pIHtcclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIGlmICghZWxlbWVudCB8fCAhZWxlbWVudC5jaGlsZE5vZGVzKSByZXR1cm4gY2hpbGRyZW47XHJcblxyXG4gICAgICAgIHZhbGlkYXRpb24gPSB2YWxpZGF0aW9uIHx8IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH07XHJcblxyXG4gICAgICAgIChmdW5jdGlvbiByZWN1cnNpb25GdW5jKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQgIT09IGN1cnJlbnQgJiYgdmFsaWRhdGlvbihjdXJyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChjdXJyZW50KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGN1cnJlbnQuY2hpbGROb2Rlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgcmVjdXJzaW9uRnVuYyhjdXJyZW50LmNoaWxkTm9kZXNbaV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkoZWxlbWVudCk7XHJcblxyXG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gR2V0IHRoZSBwYXJlbnQgZWxlbWVudCBvZiB0aGUgYXJndW1lbnQgdmFsdWUuXHJcbiAgICAgKiBBIHRhZyB0aGF0IHNhdGlzZmllcyB0aGUgcXVlcnkgY29uZGl0aW9uIGlzIGltcG9ydGVkLlxyXG4gICAgICogUmV0dXJucyBudWxsIGlmIG5vdCBmb3VuZC5cclxuICAgICAqIEBwYXJhbSB7Tm9kZX0gZWxlbWVudCAtIFJlZmVyZW5jZSBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gcXVlcnkgLSBRdWVyeSBTdHJpbmcgKHRhZ05hbWUsIC5jbGFzc05hbWUsICNJRCwgOm5hbWUpIG9yIHZhbGlkYXRpb24gZnVuY3Rpb24uXHJcbiAgICAgKiBOb3QgdXNlIGl0IGxpa2UganF1ZXJ5LlxyXG4gICAgICogT25seSBvbmUgY29uZGl0aW9uIGNhbiBiZSBlbnRlcmVkIGF0IGEgdGltZS5cclxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fG51bGx9XHJcbiAgICAgKi9cclxuICAgIGdldFBhcmVudEVsZW1lbnQ6IGZ1bmN0aW9uIChlbGVtZW50LCBxdWVyeSkge1xyXG4gICAgICAgIGxldCBjaGVjaztcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiBxdWVyeSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICBjaGVjayA9IHF1ZXJ5O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCBhdHRyO1xyXG4gICAgICAgICAgICBpZiAoL1xcLi8udGVzdChxdWVyeSkpIHtcclxuICAgICAgICAgICAgICAgIGF0dHIgPSAnY2xhc3NOYW1lJztcclxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuc3BsaXQoJy4nKVsxXTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgvIy8udGVzdChxdWVyeSkpIHtcclxuICAgICAgICAgICAgICAgIGF0dHIgPSAnaWQnO1xyXG4gICAgICAgICAgICAgICAgcXVlcnkgPSAnXicgKyBxdWVyeS5zcGxpdCgnIycpWzFdICsgJyQnO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKC86Ly50ZXN0KHF1ZXJ5KSkge1xyXG4gICAgICAgICAgICAgICAgYXR0ciA9ICduYW1lJztcclxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gJ14nICsgcXVlcnkuc3BsaXQoJzonKVsxXSArICckJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGF0dHIgPSAndGFnTmFtZSc7XHJcbiAgICAgICAgICAgICAgICBxdWVyeSA9ICdeJyArIHF1ZXJ5ICsgJyQnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZWdFeHAgPSBuZXcgUmVnRXhwKHF1ZXJ5LCAnaScpO1xyXG4gICAgICAgICAgICBjaGVjayA9IGZ1bmN0aW9uIChlbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlZ0V4cC50ZXN0KGVsW2F0dHJdKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdoaWxlIChlbGVtZW50ICYmIChlbGVtZW50Lm5vZGVUeXBlID09PSAzIHx8ICFjaGVjayhlbGVtZW50KSkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNXeXNpd3lnRGl2KGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIEdldCB0aGUgY2hpbGQgZWxlbWVudCBvZiB0aGUgYXJndW1lbnQgdmFsdWUuXHJcbiAgICAgKiBBIHRhZyB0aGF0IHNhdGlzZmllcyB0aGUgcXVlcnkgY29uZGl0aW9uIGlzIGltcG9ydGVkLlxyXG4gICAgICogUmV0dXJucyBudWxsIGlmIG5vdCBmb3VuZC5cclxuICAgICAqIEBwYXJhbSB7Tm9kZX0gZWxlbWVudCAtIFJlZmVyZW5jZSBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gcXVlcnkgLSBRdWVyeSBTdHJpbmcgKHRhZ05hbWUsIC5jbGFzc05hbWUsICNJRCwgOm5hbWUpIG9yIHZhbGlkYXRpb24gZnVuY3Rpb24uXHJcbiAgICAgKiBOb3QgdXNlIGl0IGxpa2UganF1ZXJ5LlxyXG4gICAgICogT25seSBvbmUgY29uZGl0aW9uIGNhbiBiZSBlbnRlcmVkIGF0IGEgdGltZS5cclxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fG51bGx9XHJcbiAgICAgKi9cclxuICAgIGdldENoaWxkRWxlbWVudDogZnVuY3Rpb24gKGVsZW1lbnQsIHF1ZXJ5KSB7XHJcbiAgICAgICAgbGV0IGNoZWNrO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNoZWNrID0gcXVlcnk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IGF0dHI7XHJcbiAgICAgICAgICAgIGlmICgvXFwuLy50ZXN0KHF1ZXJ5KSkge1xyXG4gICAgICAgICAgICAgICAgYXR0ciA9ICdjbGFzc05hbWUnO1xyXG4gICAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5zcGxpdCgnLicpWzFdO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKC8jLy50ZXN0KHF1ZXJ5KSkge1xyXG4gICAgICAgICAgICAgICAgYXR0ciA9ICdpZCc7XHJcbiAgICAgICAgICAgICAgICBxdWVyeSA9ICdeJyArIHF1ZXJ5LnNwbGl0KCcjJylbMV0gKyAnJCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoLzovLnRlc3QocXVlcnkpKSB7XHJcbiAgICAgICAgICAgICAgICBhdHRyID0gJ25hbWUnO1xyXG4gICAgICAgICAgICAgICAgcXVlcnkgPSAnXicgKyBxdWVyeS5zcGxpdCgnOicpWzFdICsgJyQnO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYXR0ciA9ICd0YWdOYW1lJztcclxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gJ14nICsgcXVlcnkgKyAnJCc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAocXVlcnksICdpJyk7XHJcbiAgICAgICAgICAgIGNoZWNrID0gZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVnRXhwLnRlc3QoZWxbYXR0cl0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY2hpbGRMaXN0ID0gdGhpcy5nZXRMaXN0Q2hpbGRyZW4oZWxlbWVudCwgZnVuY3Rpb24gKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoZWNrKGN1cnJlbnQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gY2hpbGRMaXN0WzBdO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBSZXR1cm5zIHRoZSBwb3NpdGlvbiBvZiB0aGUgbGVmdCBhbmQgdG9wIG9mIGFyZ3VtZW50LiB7bGVmdDowLCB0b3A6MH1cclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIEVsZW1lbnQgbm9kZVxyXG4gICAgICogQHJldHVybnMge09iamVjdH1cclxuICAgICAqL1xyXG4gICAgZ2V0T2Zmc2V0OiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIGxldCB0YWJsZU9mZnNldExlZnQgPSAwO1xyXG4gICAgICAgIGxldCB0YWJsZU9mZnNldFRvcCA9IDA7XHJcbiAgICAgICAgbGV0IHRhYmxlRWxlbWVudCA9IGVsZW1lbnQubm9kZVR5cGUgPT09IDMgPyBlbGVtZW50LnBhcmVudEVsZW1lbnQgOiBlbGVtZW50O1xyXG5cclxuICAgICAgICB3aGlsZSAoIXRoaXMuaXNXeXNpd3lnRGl2KHRhYmxlRWxlbWVudC5wYXJlbnROb2RlKSkge1xyXG4gICAgICAgICAgICBpZiAoL14oQXxURHxUSHxGSUdVUkV8RklHQ0FQVElPTnxJTUd8SUZSQU1FKSQvaS50ZXN0KHRhYmxlRWxlbWVudC5ub2RlTmFtZSkgfHwgL3JlbGF0aXZlL2kudGVzdCh0YWJsZUVsZW1lbnQuc3R5bGUucG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICB0YWJsZU9mZnNldExlZnQgKz0gdGFibGVFbGVtZW50Lm9mZnNldExlZnQ7XHJcbiAgICAgICAgICAgICAgICB0YWJsZU9mZnNldFRvcCArPSB0YWJsZUVsZW1lbnQub2Zmc2V0VG9wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRhYmxlRWxlbWVudCA9IHRhYmxlRWxlbWVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbGVmdDogdGFibGVPZmZzZXRMZWZ0LFxyXG4gICAgICAgICAgICB0b3A6IHRhYmxlT2Zmc2V0VG9wIC0gdGFibGVFbGVtZW50LnBhcmVudE5vZGUuc2Nyb2xsVG9wXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gU2V0IHRoZSB0ZXh0IGNvbnRlbnQgdmFsdWUgb2YgdGhlIGFyZ3VtZW50IHZhbHVlIGVsZW1lbnRcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIEVsZW1lbnQgdG8gcmVwbGFjZSB0ZXh0IGNvbnRlbnRcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0eHQgLSBUZXh0IHRvIGJlIGFwcGxpZWRcclxuICAgICAqL1xyXG4gICAgY2hhbmdlVHh0OiBmdW5jdGlvbiAoZWxlbWVudCwgdHh0KSB7XHJcbiAgICAgICAgaWYgKCFlbGVtZW50IHx8ICF0eHQpIHJldHVybjtcclxuICAgICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gdHh0O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBEZXRlcm1pbmUgd2hldGhlciBhbnkgb2YgdGhlIG1hdGNoZWQgZWxlbWVudHMgYXJlIGFzc2lnbmVkIHRoZSBnaXZlbiBjbGFzc1xyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gRWxlbWVudHMgdG8gc2VhcmNoIGNsYXNzIG5hbWVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc05hbWUgLSBDbGFzcyBuYW1lIHRvIHNlYXJjaCBmb3JcclxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAgICovXHJcbiAgICBoYXNDbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGlmICghZWxlbWVudCkgcmV0dXJuO1xyXG5cclxuICAgICAgICByZXR1cm4gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lLnRyaW0oKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIEFwcGVuZCB0aGUgY2xhc3NOYW1lIHZhbHVlIG9mIHRoZSBhcmd1bWVudCB2YWx1ZSBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBFbGVtZW50cyB0byBhZGQgY2xhc3MgbmFtZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNsYXNzTmFtZSAtIENsYXNzIG5hbWUgdG8gYmUgYWRkXHJcbiAgICAgKi9cclxuICAgIGFkZENsYXNzOiBmdW5jdGlvbiAoZWxlbWVudCwgY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgaWYgKCFlbGVtZW50KSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IGNoZWNrID0gbmV3IFJlZ0V4cCgnKFxcXFxzfF4pJyArIGNsYXNzTmFtZSArICcoXFxcXHN8JCknKTtcclxuICAgICAgICBpZiAoY2hlY2sudGVzdChlbGVtZW50LmNsYXNzTmFtZSkpIHJldHVybjtcclxuXHJcbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgKz0gJyAnICsgY2xhc3NOYW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBEZWxldGUgdGhlIGNsYXNzTmFtZSB2YWx1ZSBvZiB0aGUgYXJndW1lbnQgdmFsdWUgZWxlbWVudFxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gRWxlbWVudHMgdG8gcmVtb3ZlIGNsYXNzIG5hbWVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc05hbWUgLSBDbGFzcyBuYW1lIHRvIGJlIHJlbW92ZVxyXG4gICAgICovXHJcbiAgICByZW1vdmVDbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGlmICghZWxlbWVudCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBjaGVjayA9IG5ldyBSZWdFeHAoJyhcXFxcc3xeKScgKyBjbGFzc05hbWUgKyAnKFxcXFxzfCQpJyk7XHJcbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKGNoZWNrLCAnICcpLnRyaW0oKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gQXJndW1lbnQgdmFsdWUgSWYgdGhlcmUgaXMgbm8gY2xhc3MgbmFtZSwgaW5zZXJ0IGl0IGFuZCBkZWxldGUgdGhlIGNsYXNzIG5hbWUgaWYgaXQgZXhpc3RzXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBFbGVtZW50cyB0byByZXBsYWNlIGNsYXNzIG5hbWVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc05hbWUgLSBDbGFzcyBuYW1lIHRvIGJlIGNoYW5nZVxyXG4gICAgICovXHJcbiAgICB0b2dnbGVDbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGlmICghZWxlbWVudCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBjaGVjayA9IG5ldyBSZWdFeHAoJyhcXFxcc3xeKScgKyBjbGFzc05hbWUgKyAnKFxcXFxzfCQpJyk7XHJcbiAgICAgICAgaWYgKGNoZWNrLnRlc3QoZWxlbWVudC5jbGFzc05hbWUpKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZShjaGVjaywgJyAnKS50cmltKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSArPSAnICcgKyBjbGFzc05hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBEZWxldGUgYXJndW1lbnUgdmFsdWUgZWxlbWVudFxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBpdGVtIC0gRWxlbWVudCB0byBiZSByZW1vdmVcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlSXRlbTogZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaXRlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gRGVsZXRlIGEgZW1wdHkgY2hpbGQgbm9kZSBvZiBhcmd1bWVudCBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBFbGVtZW50IG5vZGVcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlRW1wdHlOb2RlOiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIChmdW5jdGlvbiByZWN1cnNpb25GdW5jKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQudGV4dENvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCAmJiAhL15CUiQvaS50ZXN0KGN1cnJlbnQubm9kZU5hbWUpICYmICghY3VycmVudC5maXJzdENoaWxkIHx8ICEvXkJSJC9pLnRlc3QoY3VycmVudC5maXJzdENoaWxkLm5vZGVOYW1lKSkpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQucGFyZW50Tm9kZSAmJiBjdXJyZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY3VycmVudCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gY3VycmVudC5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudC5jaGlsZHJlbltpXSkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVjdXJzaW9uRnVuYyhjdXJyZW50LmNoaWxkcmVuW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pKGVsZW1lbnQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBHZXRzIHRoZSBjbGVhbiBIVE1MIGNvZGUgZm9yIGVkaXRvclxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGh0bWwgLSBIVE1MIHN0cmluZ1xyXG4gICAgICovXHJcbiAgICBjbGVhbkhUTUw6IGZ1bmN0aW9uIChodG1sKSB7XHJcbiAgICAgICAgY29uc3QgdGFnc0FsbG93ZWQgPSBuZXcgUmVnRXhwKCdeKFB8RElWfFBSRXxIMXxIMnxIM3xINHxINXxINnxCfFV8SXxTVFJJS0V8U1VCfFNVUHxPTHxVTHxUQUJMRXxCUnxIUnxBfElNR3xJRlJBTUUpJCcsICdpJyk7XHJcbiAgICAgICAgY29uc3QgZG9tVHJlZSA9IHRoaXMuX2QuY3JlYXRlUmFuZ2UoKS5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQoaHRtbCkuY2hpbGRyZW47XHJcbiAgICAgICAgbGV0IGNsZWFuSFRNTCA9ICcnO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gZG9tVHJlZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGFnc0FsbG93ZWQudGVzdChkb21UcmVlW2ldLm5vZGVOYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYW5IVE1MICs9IGRvbVRyZWVbaV0ub3V0ZXJIVE1MLnJlcGxhY2UoLzwhLS0oLio/KS0tPi9nLCAnJykucmVwbGFjZSgvPFthLXpBLVpdK1xcOlthLXpBLVpdKy4qPihcXG58LikqPFxcL1thLXpBLVpdK1xcOlthLXpBLVpdKz4vZywgJycpLnJlcGxhY2UoL1xccyg/OnN0eWxlfGNsYXNzfGRpcnx4bWxuc3xkYXRhLVthLXpcXC1dKylcXHMqKD86W2EtelxcLV0rKT9cXHMqKD86PVwiP1tePl0qXCI/KT9cXHMqL2lnLCAnJykucmVwbGFjZSgvPFxcLz8oPzpzcGFufGZvbnQpXFxzKig/OlthLXpcXC1dKyk/XFxzKig/Oj1cIj9bXj5dKlwiPyk/XFxzKj4vaWcsICcnKS5yZXBsYWNlKC88XFwvP1thLXpdKzpbYS16XStcXHMqKD86W2EtelxcLV0rKT9cXHMqKD86PVwiP1tePl0qXCI/KT9cXHMqPi9pZywgJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY2xlYW5IVE1MIHx8IGh0bWw7XHJcbiAgICB9XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB1dGlsOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTs7Ozs7OztBQU9BO0FBRUE7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFhQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBR0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRrQkE7QUF5a0JBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/lib/util.js\n");

/***/ }),

/***/ "./src/plugins/modules/notice.js":
/*!***************************************!*\
  !*** ./src/plugins/modules/notice.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _lib_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/util */ \"./src/lib/util.js\");\n/*\r\n * wysiwyg web editor\r\n *\r\n * suneditor.js\r\n * Copyright 2017 JiHong Lee.\r\n * MIT license.\r\n */\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'notice',\n  add: function (core) {\n    const context = core.context;\n    context.notice = {};\n    /** dialog */\n\n    let notice_div = _lib_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('DIV');\n    let notice_span = _lib_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('SPAN');\n    let notice_button = _lib_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createElement('BUTTON');\n    notice_div.className = 'sun-editor-id-notice';\n    notice_button.className = 'close';\n    notice_button.setAttribute('aria-label', 'Close');\n    notice_button.setAttribute('title', core.lang.dialogBox.close);\n    notice_button.innerHTML = '<div aria-hidden=\"true\" data-command=\"close\" class=\"icon-cancel\"></div>';\n    notice_div.appendChild(notice_span);\n    notice_div.appendChild(notice_button);\n    context.notice.modal = notice_div;\n    context.notice.message = notice_span;\n    /** add event listeners */\n\n    notice_button.addEventListener('click', this.onClick_cancel.bind(core));\n    /** append html */\n\n    context.element.editorArea.insertBefore(notice_div, context.element.wysiwyg);\n    /** empty memory */\n\n    notice_div = null;\n  },\n  onClick_cancel: function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.plugins.notice.close.call(this);\n  },\n  open: function (text) {\n    this.context.notice.message.textContent = text;\n    this.context.notice.modal.style.display = 'block';\n  },\n  close: function () {\n    this.context.notice.modal.style.display = 'none';\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGx1Z2lucy9tb2R1bGVzL25vdGljZS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9wbHVnaW5zL21vZHVsZXMvbm90aWNlLmpzPzNjMDUiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogd3lzaXd5ZyB3ZWIgZWRpdG9yXHJcbiAqXHJcbiAqIHN1bmVkaXRvci5qc1xyXG4gKiBDb3B5cmlnaHQgMjAxNyBKaUhvbmcgTGVlLlxyXG4gKiBNSVQgbGljZW5zZS5cclxuICovXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCB1dGlsIGZyb20gJy4uLy4uL2xpYi91dGlsJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICAgIG5hbWU6ICdub3RpY2UnLFxyXG4gICAgYWRkOiBmdW5jdGlvbiAoY29yZSkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBjb3JlLmNvbnRleHQ7XHJcbiAgICAgICAgY29udGV4dC5ub3RpY2UgPSB7fTtcclxuXHJcbiAgICAgICAgLyoqIGRpYWxvZyAqL1xyXG4gICAgICAgIGxldCBub3RpY2VfZGl2ID0gdXRpbC5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICBsZXQgbm90aWNlX3NwYW4gPSB1dGlsLmNyZWF0ZUVsZW1lbnQoJ1NQQU4nKTtcclxuICAgICAgICBsZXQgbm90aWNlX2J1dHRvbiA9IHV0aWwuY3JlYXRlRWxlbWVudCgnQlVUVE9OJyk7XHJcblxyXG4gICAgICAgIG5vdGljZV9kaXYuY2xhc3NOYW1lID0gJ3N1bi1lZGl0b3ItaWQtbm90aWNlJztcclxuICAgICAgICBub3RpY2VfYnV0dG9uLmNsYXNzTmFtZSA9ICdjbG9zZSc7XHJcbiAgICAgICAgbm90aWNlX2J1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQ2xvc2UnKTtcclxuICAgICAgICBub3RpY2VfYnV0dG9uLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBjb3JlLmxhbmcuZGlhbG9nQm94LmNsb3NlKTtcclxuICAgICAgICBub3RpY2VfYnV0dG9uLmlubmVySFRNTCA9ICc8ZGl2IGFyaWEtaGlkZGVuPVwidHJ1ZVwiIGRhdGEtY29tbWFuZD1cImNsb3NlXCIgY2xhc3M9XCJpY29uLWNhbmNlbFwiPjwvZGl2Pic7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbm90aWNlX2Rpdi5hcHBlbmRDaGlsZChub3RpY2Vfc3Bhbik7XHJcbiAgICAgICAgbm90aWNlX2Rpdi5hcHBlbmRDaGlsZChub3RpY2VfYnV0dG9uKTtcclxuXHJcbiAgICAgICAgY29udGV4dC5ub3RpY2UubW9kYWwgPSBub3RpY2VfZGl2O1xyXG4gICAgICAgIGNvbnRleHQubm90aWNlLm1lc3NhZ2UgPSBub3RpY2Vfc3BhbjtcclxuXHJcbiAgICAgICAgLyoqIGFkZCBldmVudCBsaXN0ZW5lcnMgKi9cclxuICAgICAgICBub3RpY2VfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbkNsaWNrX2NhbmNlbC5iaW5kKGNvcmUpKTtcclxuICAgICAgICBcclxuICAgICAgICAvKiogYXBwZW5kIGh0bWwgKi9cclxuICAgICAgICBjb250ZXh0LmVsZW1lbnQuZWRpdG9yQXJlYS5pbnNlcnRCZWZvcmUobm90aWNlX2RpdiwgY29udGV4dC5lbGVtZW50Lnd5c2l3eWcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiBlbXB0eSBtZW1vcnkgKi9cclxuICAgICAgICBub3RpY2VfZGl2ID0gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgb25DbGlja19jYW5jZWw6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5wbHVnaW5zLm5vdGljZS5jbG9zZS5jYWxsKHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBvcGVuOiBmdW5jdGlvbiAodGV4dCkgIHtcclxuICAgICAgICB0aGlzLmNvbnRleHQubm90aWNlLm1lc3NhZ2UudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5ub3RpY2UubW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsb3NlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0Lm5vdGljZS5tb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgfVxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUE5Q0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/plugins/modules/notice.js\n");

/***/ }),

/***/ "./src/suneditor.js":
/*!**************************!*\
  !*** ./src/suneditor.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _lib_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./lib/util */ \"./src/lib/util.js\");\n/* harmony import */ var _lib_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/core */ \"./src/lib/core.js\");\n/* harmony import */ var _lib_constructor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/constructor */ \"./src/lib/constructor.js\");\n/* harmony import */ var _lib_context__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lib/context */ \"./src/lib/context.js\");\n/* harmony import */ var _lang_en__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lang/en */ \"./src/lang/en.js\");\n/* harmony import */ var _lang_en__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_lang_en__WEBPACK_IMPORTED_MODULE_4__);\n/*\r\n * wysiwyg web editor\r\n *\r\n * suneditor.js\r\n * Copyright 2017 JiHong Lee.\r\n * MIT license.\r\n */\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  /**\r\n   * @description Returns the create function with preset options.\r\n   * If the options overlap, the options of the 'create' function take precedence.\r\n   * @param {Json} options - Initialization options\r\n   * @returns {function}\r\n   */\n  init: function (init_options) {\n    const self = this;\n    return {\n      create: function (idOrElement, options) {\n        return self.create(idOrElement, options, init_options);\n      }\n    };\n  },\n\n  /**\r\n   * @description Create the suneditor\r\n   * @param {String|Element} idOrElement - textarea Id or textarea element\r\n   * @param {Json} options - user options\r\n   * @returns {{save: save, getContext: getContext, getContent: getContent, setContent: setContent, appendContent: appendContent, disabled: disabled, enabled: enabled, show: show, hide: hide, destroy: destroy}}\r\n   */\n  create: function (idOrElement, options, _init_options) {\n    if (typeof options !== 'object') options = {};\n\n    if (_init_options) {\n      // options = Object.assign(util.copyObj(_init_options), options);\n      options = [_lib_util__WEBPACK_IMPORTED_MODULE_0__[\"default\"].copyObj(_init_options), options].reduce(function (init, option) {\n        Object.keys(option).forEach(function (key) {\n          init[key] = option[key];\n        });\n        return init;\n      }, {});\n    }\n\n    const element = typeof idOrElement === 'string' ? document.getElementById(idOrElement) : idOrElement;\n\n    if (!element) {\n      if (typeof idOrElement === 'string') {\n        throw Error('[SUNEDITOR.create.fail] The element for that id was not found (ID:\"' + idOrElement + '\")');\n      }\n\n      throw Error('[SUNEDITOR.create.fail] suneditor requires textarea\\'s element or id value');\n    }\n\n    const cons = _lib_constructor__WEBPACK_IMPORTED_MODULE_2__[\"default\"].init(element, options, options.lang || _lang_en__WEBPACK_IMPORTED_MODULE_4___default.a, options.plugins);\n\n    if (cons.constructed._top.id && document.getElementById(cons.constructed._top.id)) {\n      throw Error('[SUNEDITOR.create.fail] The ID of the suneditor you are trying to create already exists (ID:\"' + cons.constructed._top.id + '\")');\n    }\n\n    element.style.display = 'none';\n    cons.constructed._top.style.display = 'block';\n    /** Create to sibling node */\n\n    if (typeof element.nextElementSibling === 'object') {\n      element.parentNode.insertBefore(cons.constructed._top, element.nextElementSibling);\n    } else {\n      element.parentNode.appendChild(cons.constructed._top);\n    }\n\n    return Object(_lib_core__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(Object(_lib_context__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(element, cons.constructed, cons.options), cons.plugins, cons.options.lang);\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc3VuZWRpdG9yLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL3N1bmVkaXRvci5qcz9iNTliIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIHd5c2l3eWcgd2ViIGVkaXRvclxyXG4gKlxyXG4gKiBzdW5lZGl0b3IuanNcclxuICogQ29weXJpZ2h0IDIwMTcgSmlIb25nIExlZS5cclxuICogTUlUIGxpY2Vuc2UuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5pbXBvcnQgdXRpbCBmcm9tICcuL2xpYi91dGlsJztcclxuaW1wb3J0IGNvcmUgZnJvbSAnLi9saWIvY29yZSc7XHJcbmltcG9ydCBfQ29uc3RydWN0b3IgZnJvbSAnLi9saWIvY29uc3RydWN0b3InO1xyXG5pbXBvcnQgX0NvbnRleHQgZnJvbSAnLi9saWIvY29udGV4dCc7XHJcbmltcG9ydCBfZGVmYXVsdExhbmcgZnJvbSAnLi9sYW5nL2VuJztcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCB7XHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiBSZXR1cm5zIHRoZSBjcmVhdGUgZnVuY3Rpb24gd2l0aCBwcmVzZXQgb3B0aW9ucy5cclxuICAgICAqIElmIHRoZSBvcHRpb25zIG92ZXJsYXAsIHRoZSBvcHRpb25zIG9mIHRoZSAnY3JlYXRlJyBmdW5jdGlvbiB0YWtlIHByZWNlZGVuY2UuXHJcbiAgICAgKiBAcGFyYW0ge0pzb259IG9wdGlvbnMgLSBJbml0aWFsaXphdGlvbiBvcHRpb25zXHJcbiAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259XHJcbiAgICAgKi9cclxuICAgIGluaXQ6IGZ1bmN0aW9uIChpbml0X29wdGlvbnMpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY3JlYXRlOiBmdW5jdGlvbiAoaWRPckVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmNyZWF0ZShpZE9yRWxlbWVudCwgb3B0aW9ucywgaW5pdF9vcHRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIENyZWF0ZSB0aGUgc3VuZWRpdG9yXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ3xFbGVtZW50fSBpZE9yRWxlbWVudCAtIHRleHRhcmVhIElkIG9yIHRleHRhcmVhIGVsZW1lbnRcclxuICAgICAqIEBwYXJhbSB7SnNvbn0gb3B0aW9ucyAtIHVzZXIgb3B0aW9uc1xyXG4gICAgICogQHJldHVybnMge3tzYXZlOiBzYXZlLCBnZXRDb250ZXh0OiBnZXRDb250ZXh0LCBnZXRDb250ZW50OiBnZXRDb250ZW50LCBzZXRDb250ZW50OiBzZXRDb250ZW50LCBhcHBlbmRDb250ZW50OiBhcHBlbmRDb250ZW50LCBkaXNhYmxlZDogZGlzYWJsZWQsIGVuYWJsZWQ6IGVuYWJsZWQsIHNob3c6IHNob3csIGhpZGU6IGhpZGUsIGRlc3Ryb3k6IGRlc3Ryb3l9fVxyXG4gICAgICovXHJcbiAgICBjcmVhdGU6IGZ1bmN0aW9uIChpZE9yRWxlbWVudCwgb3B0aW9ucywgX2luaXRfb3B0aW9ucykge1xyXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyAhPT0gJ29iamVjdCcpIG9wdGlvbnMgPSB7fTtcclxuICAgICAgICBpZiAoX2luaXRfb3B0aW9ucykge1xyXG4gICAgICAgICAgICAvLyBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih1dGlsLmNvcHlPYmooX2luaXRfb3B0aW9ucyksIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICBvcHRpb25zID0gIFt1dGlsLmNvcHlPYmooX2luaXRfb3B0aW9ucyksIG9wdGlvbnNdLnJlZHVjZShmdW5jdGlvbiAoaW5pdCwgb3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhvcHRpb24pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRba2V5XSA9IG9wdGlvbltrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5pdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge30pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBlbGVtZW50ID0gdHlwZW9mIGlkT3JFbGVtZW50ID09PSAnc3RyaW5nJyA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkT3JFbGVtZW50KSA6IGlkT3JFbGVtZW50O1xyXG5cclxuICAgICAgICBpZiAoIWVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpZE9yRWxlbWVudCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdbU1VORURJVE9SLmNyZWF0ZS5mYWlsXSBUaGUgZWxlbWVudCBmb3IgdGhhdCBpZCB3YXMgbm90IGZvdW5kIChJRDpcIicgKyBpZE9yRWxlbWVudCArICdcIiknKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ1tTVU5FRElUT1IuY3JlYXRlLmZhaWxdIHN1bmVkaXRvciByZXF1aXJlcyB0ZXh0YXJlYVxcJ3MgZWxlbWVudCBvciBpZCB2YWx1ZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY29ucyA9IF9Db25zdHJ1Y3Rvci5pbml0KGVsZW1lbnQsIG9wdGlvbnMsIChvcHRpb25zLmxhbmcgfHwgIF9kZWZhdWx0TGFuZyksIG9wdGlvbnMucGx1Z2lucyk7XHJcblxyXG4gICAgICAgIGlmIChjb25zLmNvbnN0cnVjdGVkLl90b3AuaWQgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ucy5jb25zdHJ1Y3RlZC5fdG9wLmlkKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcignW1NVTkVESVRPUi5jcmVhdGUuZmFpbF0gVGhlIElEIG9mIHRoZSBzdW5lZGl0b3IgeW91IGFyZSB0cnlpbmcgdG8gY3JlYXRlIGFscmVhZHkgZXhpc3RzIChJRDpcIicgKyBjb25zLmNvbnN0cnVjdGVkLl90b3AuaWQgKyAnXCIpJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgY29ucy5jb25zdHJ1Y3RlZC5fdG9wLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICAgICAgICAvKiogQ3JlYXRlIHRvIHNpYmxpbmcgbm9kZSAqL1xyXG4gICAgICAgIGlmICh0eXBlb2YgZWxlbWVudC5uZXh0RWxlbWVudFNpYmxpbmcgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY29ucy5jb25zdHJ1Y3RlZC5fdG9wLCBlbGVtZW50Lm5leHRFbGVtZW50U2libGluZyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGNvbnMuY29uc3RydWN0ZWQuX3RvcCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY29yZShfQ29udGV4dChlbGVtZW50LCBjb25zLmNvbnN0cnVjdGVkLCBjb25zLm9wdGlvbnMpLCBjb25zLnBsdWdpbnMsIGNvbnMub3B0aW9ucy5sYW5nKTtcclxuICAgIH1cclxufTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlEQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/suneditor.js\n");

/***/ }),

/***/ "./test/dev/custom_plugin_submenu.js":
/*!*******************************************!*\
  !*** ./test/dev/custom_plugin_submenu.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n // ex) A submenu plugin that appends the contents of the input element to the editor\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  // plugin name (Required)\n  name: 'custom_plugin_submenu',\n  // add function - It is called only once when the plugin is first run.\n  // This function generates HTML to append and register the event.\n  // arguments - (core : core object, targetElement : clicked button element)\n  add: function (core, targetElement) {\n    // Registering a namespace for caching as a plugin name in the context object\n    const context = core.context;\n    context.custom = {\n      textElement: null\n    }; // Generate submenu HTML\n\n    let listDiv = eval(this.setSubmenu(core.lang)); // Input tag caching\n\n    context.custom.textElement = listDiv.getElementsByTagName('INPUT')[0]; // In addition to the button, elements that should operate within the submenu, such as focus,\n    // must call stopPropagation in the mousedown event to prevent the toolbar from executing events.\n\n    context.custom.textElement.addEventListener('mousedown', function (e) {\n      e.stopPropagation();\n    }); // You must bind \"core\" object when registering an event.\n\n    /** add event listeners */\n\n    listDiv.getElementsByTagName('BUTTON')[0].addEventListener('click', this.onClick.bind(core));\n    context.custom.textElement.addEventListener('mousedown', function () {});\n    /** append html */\n\n    targetElement.parentNode.appendChild(listDiv);\n  },\n  setSubmenu: function () {\n    const listDiv = document.createElement('DIV');\n    listDiv.className = 'sun-editor-submenu layer_editor layer_align';\n    listDiv.style.display = 'none';\n    listDiv.innerHTML = '' + '<div class=\"inner_layer\">' + '   <ul class=\"list_editor\">' + '       <li><input type=\"text\" placeholder=\"insert text\" style=\"width: 100%; border: 1px solid #CCC;\" /></li>' + '       <li><button type=\"button\" class=\"btn_editor\" title=\"Append text\">Append text</button></li>' + '   </ul>' + '</div>';\n    return listDiv;\n  },\n  onClick: function () {\n    // Get Input value\n    const value = document.createTextNode(this.context.custom.textElement.value); // insert\n\n    this.insertNode(value); // focus\n\n    this.focus();\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi90ZXN0L2Rldi9jdXN0b21fcGx1Z2luX3N1Ym1lbnUuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi90ZXN0L2Rldi9jdXN0b21fcGx1Z2luX3N1Ym1lbnUuanM/NjAwZSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG4vLyBleCkgQSBzdWJtZW51IHBsdWdpbiB0aGF0IGFwcGVuZHMgdGhlIGNvbnRlbnRzIG9mIHRoZSBpbnB1dCBlbGVtZW50IHRvIHRoZSBlZGl0b3JcclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gICAgLy8gcGx1Z2luIG5hbWUgKFJlcXVpcmVkKVxyXG4gICAgbmFtZTogJ2N1c3RvbV9wbHVnaW5fc3VibWVudScsXHJcblxyXG4gICAgLy8gYWRkIGZ1bmN0aW9uIC0gSXQgaXMgY2FsbGVkIG9ubHkgb25jZSB3aGVuIHRoZSBwbHVnaW4gaXMgZmlyc3QgcnVuLlxyXG4gICAgLy8gVGhpcyBmdW5jdGlvbiBnZW5lcmF0ZXMgSFRNTCB0byBhcHBlbmQgYW5kIHJlZ2lzdGVyIHRoZSBldmVudC5cclxuICAgIC8vIGFyZ3VtZW50cyAtIChjb3JlIDogY29yZSBvYmplY3QsIHRhcmdldEVsZW1lbnQgOiBjbGlja2VkIGJ1dHRvbiBlbGVtZW50KVxyXG4gICAgYWRkOiBmdW5jdGlvbiAoY29yZSwgdGFyZ2V0RWxlbWVudCkge1xyXG5cclxuICAgICAgICAvLyBSZWdpc3RlcmluZyBhIG5hbWVzcGFjZSBmb3IgY2FjaGluZyBhcyBhIHBsdWdpbiBuYW1lIGluIHRoZSBjb250ZXh0IG9iamVjdFxyXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBjb3JlLmNvbnRleHQ7XHJcbiAgICAgICAgY29udGV4dC5jdXN0b20gPSB7XHJcbiAgICAgICAgICAgIHRleHRFbGVtZW50OiBudWxsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gR2VuZXJhdGUgc3VibWVudSBIVE1MXHJcbiAgICAgICAgbGV0IGxpc3REaXYgPSBldmFsKHRoaXMuc2V0U3VibWVudShjb3JlLmxhbmcpKTtcclxuXHJcbiAgICAgICAgLy8gSW5wdXQgdGFnIGNhY2hpbmdcclxuICAgICAgICBjb250ZXh0LmN1c3RvbS50ZXh0RWxlbWVudCA9IGxpc3REaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ0lOUFVUJylbMF07XHJcblxyXG4gICAgICAgIC8vIEluIGFkZGl0aW9uIHRvIHRoZSBidXR0b24sIGVsZW1lbnRzIHRoYXQgc2hvdWxkIG9wZXJhdGUgd2l0aGluIHRoZSBzdWJtZW51LCBzdWNoIGFzIGZvY3VzLFxyXG4gICAgICAgIC8vIG11c3QgY2FsbCBzdG9wUHJvcGFnYXRpb24gaW4gdGhlIG1vdXNlZG93biBldmVudCB0byBwcmV2ZW50IHRoZSB0b29sYmFyIGZyb20gZXhlY3V0aW5nIGV2ZW50cy5cclxuICAgICAgICBjb250ZXh0LmN1c3RvbS50ZXh0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBZb3UgbXVzdCBiaW5kIFwiY29yZVwiIG9iamVjdCB3aGVuIHJlZ2lzdGVyaW5nIGFuIGV2ZW50LlxyXG4gICAgICAgIC8qKiBhZGQgZXZlbnQgbGlzdGVuZXJzICovXHJcbiAgICAgICAgbGlzdERpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgnQlVUVE9OJylbMF0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uQ2xpY2suYmluZChjb3JlKSk7XHJcbiAgICAgICAgY29udGV4dC5jdXN0b20udGV4dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLyoqIGFwcGVuZCBodG1sICovXHJcbiAgICAgICAgdGFyZ2V0RWxlbWVudC5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGxpc3REaXYpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRTdWJtZW51OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgbGlzdERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG5cclxuICAgICAgICBsaXN0RGl2LmNsYXNzTmFtZSA9ICdzdW4tZWRpdG9yLXN1Ym1lbnUgbGF5ZXJfZWRpdG9yIGxheWVyX2FsaWduJztcclxuICAgICAgICBsaXN0RGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgbGlzdERpdi5pbm5lckhUTUwgPSAnJyArXHJcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaW5uZXJfbGF5ZXJcIj4nICtcclxuICAgICAgICAgICAgJyAgIDx1bCBjbGFzcz1cImxpc3RfZWRpdG9yXCI+JyArXHJcbiAgICAgICAgICAgICcgICAgICAgPGxpPjxpbnB1dCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiaW5zZXJ0IHRleHRcIiBzdHlsZT1cIndpZHRoOiAxMDAlOyBib3JkZXI6IDFweCBzb2xpZCAjQ0NDO1wiIC8+PC9saT4nICtcclxuICAgICAgICAgICAgJyAgICAgICA8bGk+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG5fZWRpdG9yXCIgdGl0bGU9XCJBcHBlbmQgdGV4dFwiPkFwcGVuZCB0ZXh0PC9idXR0b24+PC9saT4nICtcclxuICAgICAgICAgICAgJyAgIDwvdWw+JyArXHJcbiAgICAgICAgICAgICc8L2Rpdj4nO1xyXG5cclxuICAgICAgICByZXR1cm4gbGlzdERpdjtcclxuICAgIH0sXHJcblxyXG4gICAgb25DbGljazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIEdldCBJbnB1dCB2YWx1ZVxyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5jb250ZXh0LmN1c3RvbS50ZXh0RWxlbWVudC52YWx1ZSk7XHJcblxyXG4gICAgICAgIC8vIGluc2VydFxyXG4gICAgICAgIHRoaXMuaW5zZXJ0Tm9kZSh2YWx1ZSk7XHJcblxyXG4gICAgICAgIC8vIGZvY3VzXHJcbiAgICAgICAgdGhpcy5mb2N1cygpO1xyXG4gICAgfVxyXG59OyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQVFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBL0RBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./test/dev/custom_plugin_submenu.js\n");

/***/ })

/******/ });